---
title: "NTC测温，热力学公式，非查表法。三行代码搞定"
date: 2019-08-19 17:32:15
---

<p><span style="color:#6a9955">--- 模块功能：NTC功能</span><br/><span style="color:#6a9955">-- ADC测量精度(10bit，电压测量范围为0到1.85V，分辨率为1850/1024，测量精度误差为20MV)</span><br/><span style="color:#6a9955">-- @author DZQ</span><br/><span style="color:#6a9955">-- @module ntc</span><br/><span style="color:#6a9955">-- @license MIT</span><br/><span style="color:#6a9955">-- @copyright openLuat</span><br/><span style="color:#6a9955">-- @release 2018.03.14</span><br/><br/><span style="color:#dcdcaa">module</span>(<span style="color:#569cd6">...</span>,package.<span style="color:#9cdcfe">seeall</span>)<br/><br/><span style="color:#6a9955">--[[NTC：负温度系数热敏电阻，在温度越高时电阻值越低,应用电路NTC电阻与GND相连,标准25°下的阻值与VCC相连分压</span><br/><span style="color:#6a9955">NTC电阻温度计算公式：Rt = Rp*EXP(Bx*(1/T1-1/T2))</span><br/><span style="color:#6a9955">T1，T2 ：单位都是开尔文温度</span><br/><span style="color:#6a9955">Rt ：是热敏电阻在T1温度下的阻值</span><br/><span style="color:#6a9955">Rp ： 是热敏电阻在T2常温下的标准阻值</span><br/><span style="color:#6a9955">EXP：e的n次方</span><br/><span style="color:#6a9955">Bx ：热敏电阻的重要参数</span><br/><span style="color:#6a9955">T2是已知的即：标准温度下的标准阻值（Rp）的开尔文温度值（273.15+25.0）</span><br/><span style="color:#6a9955">T1就是欲求的温度（开尔文标）：T1 = 1/（ln（Rt/R）/B+1/T2）</span><br/><span style="color:#6a9955">]]</span><br/><span style="color:#6a9955">--[[</span><br/><span style="color:#6a9955">功能：获得温度</span><br/><span style="color:#6a9955">参数：Vadc:获取的ADC值，Rp：NTC自身的阻值（25°C）,Bx:热敏电阻的重要参数</span><br/><span style="color:#6a9955">返回值：温度值</span><br/><span style="color:#6a9955">例子(10KΩ B:3380)：getTemp(522,10000,3380)]]</span><br/><span style="color:#c586c0">function</span> <span style="color:#dcdcaa">getTemp</span><span style="color:#d4d4d4">(</span><span style="color:#9cdcfe">Vadc</span><span style="color:#d4d4d4">,</span><span style="color:#9cdcfe">Rp</span><span style="color:#d4d4d4">,</span><span style="color:#9cdcfe">Bx</span><span style="color:#d4d4d4">)</span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> Rt = (Vadc*Rp)/(</span><span style="color:#b5cea8">1024</span><span style="color:#d4d4d4">-Vadc)</span><span style="color:#6a9955">--计算电阻值</span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> temp=(</span><span style="color:#b5cea8">1</span><span style="color:#d4d4d4">/(</span><span style="color:#dcdcaa">math.log</span><span style="color:#d4d4d4">(Rt/Rp)/Bx+(</span><span style="color:#b5cea8">1</span><span style="color:#d4d4d4">/</span><span style="color:#b5cea8">298.15</span><span style="color:#d4d4d4">)))-</span><span style="color:#b5cea8">273.15</span><br/> <span style="color:#c586c0">return</span><span style="color:#d4d4d4"> temp - temp %</span><span style="color:#b5cea8">0.01</span><span style="color:#6a9955">--精确到小数点后2位</span><br/><span style="color:#c586c0">end</span><br/><br/><br/></p>