---
title: "17-GPRS(Air202)串口"
date: 2018-11-16 15:17:32
---


                            <p><br></p><p><span style="color: rgb(0, 51, 153); font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 24px;">https://www.cnblogs.com/yangfengwu/p/9968716.html</span><br></p><p><br></p><p><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116131947813-1415257617.png"></p><p><img src="http://oldask.openluat.com/image/show/attachments-2018-11-pz90jTnG5bfd4fabb2e9a.png" class="img-responsive" style="width: 205.5px;"></p><p><br></p><p><span style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 24px;">现在看一下官方给的demo</span><br></p><p><br></p><p><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116132358055-268363375.png"><img src="http://oldask.openluat.com/image/show/attachments-2018-11-vkgnMIS45bfd4fe602857.png" class="img-responsive" style="width: 565.5px;"><span style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;">&nbsp;</span><span style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 18pt;">其实只要有两个就好说了</span></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">module(...,package.seeall)</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--[[</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">函数名：print</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">功能&nbsp; ：打印接口，此文件中的所有打印都会加上test前缀</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">参数&nbsp; ：无</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">返回值：无</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">]]</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local function print(...)</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; _G.print("test",...)</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">end</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--串口配置</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local UART_ID = 1 --uart1</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local uartReadData = "";</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local uartReadDataCnt = 0;</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--定时器空闲中断检测(串口空闲接收数据)</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local UartTimerCnt = 0;</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local function UartTimer()</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; if&nbsp; uartReadDataCnt ~= 0 then</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; UartTimerCnt = UartTimerCnt+1;</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; if&nbsp; UartTimerCnt &gt;= 20 then</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UartTimerCnt=0;</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uartReadDataCnt = 0;</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uart.write(UART_ID,uartReadData);</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uartReadData = "";</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; end</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; end</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">end</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">sys.timer_loop_start(UartTimer,10)</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--读取串口接收到的数据</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local uartdata = ""</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local function read()</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; uartdata = ""</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; while true do</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; uartdata = uart.read(UART_ID,"*l",0)</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; if not uartdata or string.len(uartdata) == 0 then break end</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; uartReadData = uartReadData..uartdata;</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; uartReadDataCnt = uartReadDataCnt +1</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; UartTimerCnt = 0;</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; end</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">end</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--注册串口的数据接收函数，串口收到数据后，会以中断方式，调用read接口读取数据</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">sys.reguart(UART_ID,read)</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--配置并且打开串口</span></font></p><p><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">uart.setup(UART_ID,115200,8,uart.PAR_NONE,uart.STOP_1)</span></font></p><p><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116133226470-216854604.png"><img src="http://oldask.openluat.com/image/show/attachments-2018-11-WKJLYgiS5bfd50154909d.png" class="img-responsive" style="width: 464.5px;"><span style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 24px;">现在下载测试，就是发送给串口1什么就回什么</span><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p><span style="font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 18pt;"></span><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116133525216-811594740.png"><img src="http://oldask.openluat.com/image/show/attachments-2018-11-MD9UsVdb5bfd50236f072.png" class="img-responsive" style="width: 130px;"><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116133550649-342845156.png"><img src="http://oldask.openluat.com/image/show/attachments-2018-11-t1bj9PcF5bfd5028d5384.png" class="img-responsive" style="width: 352.5px;"></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;"><span style="font-size: 18pt;">可以了，现在发指令控制GPIO5&nbsp;</span></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;"><span style="font-size: 18pt;">指令就用</span></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;"><span style="font-size: 18pt;">{data:switch,bit:1,status:0} &nbsp; 控制GPIO5输出低电平</span></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;"><span style="font-size: 18pt;">{data:switch,bit:1,status:1} &nbsp; 控制GPIO5输出高电平</span></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;"><span style="font-size: 24px;">有可能会问，搞这么复杂的指令干嘛。。。。为了后期统一，而且现在物联网通信json格式用的很多，所以。。。。</span></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">module(...,package.seeall)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--[[</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">函数名：print</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">功能&nbsp; ：打印接口，此文件中的所有打印都会加上test前缀</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">参数&nbsp; ：无</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">返回值：无</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">]]</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local function print(...)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; _G.print("test",...)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--串口配置</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local UART_ID = 1 --uart1</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local uartReadData = "";</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local uartReadDataCnt = 0;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">pio.pin.setdir(pio.OUTPUT,pio.P0_5)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">pio.pin.setval(0,pio.P0_5)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--定时器空闲中断检测(串口空闲接收数据)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local UartTimerCnt = 0;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local function UartTimer()</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; if&nbsp; uartReadDataCnt ~= 0 then</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; UartTimerCnt = UartTimerCnt+1;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; if&nbsp; UartTimerCnt &gt;= 20 then--有200ms不进去中断接受数据了，就认为收完了一条数据</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; UartTimerCnt=0;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uartReadDataCnt = 0;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp;&nbsp;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if&nbsp; uartReadData=="{data:switch,bit:1,status:0}" then</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pio.pin.setval(0,pio.P0_5)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uart.write(UART_ID,uartReadData);--返回数据</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; elseif&nbsp; uartReadData=="{data:switch,bit:1,status:1}" then</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; pio.pin.setval(1,pio.P0_5)&nbsp; &nbsp; &nbsp;&nbsp;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uart.write(UART_ID,uartReadData);--返回数据</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; uartReadData = "";</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">sys.timer_loop_start(UartTimer,10)--10MS的循环定时器</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--读取串口接收到的数据</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local uartdata = ""</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">local function read()</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; uartdata = ""</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; while true do</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; uartdata = uart.read(UART_ID,"*l",0)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; if not uartdata or string.len(uartdata) == 0 then break end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; uartReadData = uartReadData..uartdata;--接收数据</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; uartReadDataCnt = uartReadDataCnt +1</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; &nbsp; &nbsp; UartTimerCnt = 0;</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">&nbsp; &nbsp; end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">end</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--注册串口的数据接收函数，串口收到数据后，会以中断方式，调用read接口读取数据</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">sys.reguart(UART_ID,read)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">--配置并且打开串口</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;">uart.setup(UART_ID,115200,8,uart.PAR_NONE,uart.STOP_1)</span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto;"><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116134116019-911542960.png"><img src="http://oldask.openluat.com/image/show/attachments-2018-11-zpJFA5kV5bfd5041aeec8.png" class="img-responsive" style="width: 414.5px;"><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116134318496-789635055.png"><img src="http://oldask.openluat.com/image/show/attachments-2018-11-5kkvDAeM5bfd504a7b496.png" class="img-responsive" style="width: 591.5px;"><img src="https://img2018.cnblogs.com/blog/819239/201811/819239-20181116134350403-574224359.png"><img src="http://oldask.openluat.com/image/show/attachments-2018-11-x5J9hvmM5bfd5052dbbba.png" class="img-responsive" style="width: 583.5px;"><font face="Verdana, Geneva, Arial, Helvetica, sans-serif"><span style="font-size: 24px;"><br></span></font></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;">资料源码链接</p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;">链接：<a href="https://pan.baidu.com/s/1-SRfsKGQ7rZVvFmp1ObHWw" target="_blank" style="color: rgb(0, 51, 153); padding-bottom: 2px; border-bottom: 1px dashed rgb(0, 51, 153);">https://pan.baidu.com/s/1-SRfsKGQ7rZVvFmp1ObHWw</a>&nbsp;密码：p9qs</p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;">基础教程源码链接如果失效,请在淘宝介绍中下载,由于链接还是失效,请联系卖家,谢谢</p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;"><a href="https://item.taobao.com/item.htm?spm=a1z10.1-c-s.w4004-18540610442.6.36a74814ZSaRsu&amp;id=569295486025" target="_blank" style="color: rgb(0, 51, 153); padding-bottom: 2px; border-bottom: 1px dashed rgb(0, 51, 153);">https://item.taobao.com/item.htm?spm=a1z10.1-c-s.w4004-18540610442.6.36a74814ZSaRsu&amp;id=569295486025</a></p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;">&nbsp;</p><p style="margin-top: 10px; margin-right: auto; margin-left: auto; font-family: Verdana, Geneva, Arial, Helvetica, sans-serif; font-size: 16px;"><a href="https://www.cnblogs.com/yangfengwu/p/9969179.html" target="_blank" style="color: rgb(0, 51, 153); padding-bottom: 2px; border-bottom: 1px dashed rgb(0, 51, 153);"><span style="font-size: 18pt;">https://www.cnblogs.com/yangfengwu/p/9969179.html</span></a></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p><p><br></p>
