---
title: "用于air640（esp8266）lua固件的编译"
date: 2018-11-28 15:23:49
---

<p>air640使用的是esp8266，但是现在还未像air202之类的GPRS模块一样进行lua的适配，由于nodemcu的助力，越来越多的开发者使用lua进行esp8266的开发，虽然官网可以方便的进行云端编译，但是由于开发过程中的特殊需要总是免不了自己进行固件编译，其中开发环境的搭建让很多人头痛，nodemcu提供了一套docker的编译环境，用起来还是很方便的，简单的几个命令就能实现固件编译。</p><p>一，docker的安装</p><p>我用的是win10，所以直接在官网下载安装包安装即可（<a href="https://store.docker.com/editions/community/docker-ce-desktop-windows" target="_blank">传送门</a>），其他系统的自己百度就行安装过程都是傻瓜化的，其中win10安装过程中可能出现由于没有开启hyper-v导致的错误，去控制面板/程序功能/开启就可以。遇到问题百度即可不多赘述。</p><p>二，docker镜像同步</p><p>在cmd或者powershell中执行<br></p><pre>docker pull marcelstoer/nodemcu-build</pre><p>等待同步完</p><p>三，nodemcu代码同步</p><p>如果电脑中安装了git可以直接执行</p><pre>git clone --recurse-submodules https://github.com/nodemcu/nodemcu-firmware.git</pre><p>没安装的可以去GitHub上打包下载zip解压</p><p>源码存放的位置随意</p><p>四，测试编译</p><p>找到自己下载源码的位置，在源码根目录新建一个make.vbs输入如下内容</p><pre>docker run --rm -ti -v %cd%:/opt/nodemcu-firmware marcelstoer/nodemcu-build build</pre><p>双击运行即可编译出测试固件，固件位置为源码根目录的bin文件</p><p>五，其他</p><p>这只是编译测试固件，实际使用中往往是配置特定固件，需要定制只需要按照<a href="https://nodemcu.readthedocs.io/en/latest/en/build/#build-options" target="_blank">文档</a>修改，编译过程不变</p>
