<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>网卡模式下获取Air720的运行状态 | Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="背景 需要获取联网状态,设备识别号(IMEI),ICCID,重启设备 通过AT可以获取网络状态,SIM的ICCID linux下需要修改内核驱动才能出AT口  效果预览获取信息 12345678910111213141516171819&amp;#123;   &quot;sysinfo&quot;: &amp;#123;      &quot;hardware_version&quot;: &quot;NZ_S">
<meta property="og:type" content="article">
<meta property="og:title" content="网卡模式下获取Air720的运行状态">
<meta property="og:url" content="https://doc.luatos.wiki/2018/10/09/465/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="背景 需要获取联网状态,设备识别号(IMEI),ICCID,重启设备 通过AT可以获取网络状态,SIM的ICCID linux下需要修改内核驱动才能出AT口  效果预览获取信息 12345678910111213141516171819&amp;#123;   &quot;sysinfo&quot;: &amp;#123;      &quot;hardware_version&quot;: &quot;NZ_S">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2018-10-09T03:33:00.000Z">
<meta property="article:modified_time" content="2021-01-27T16:09:27.338Z">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-465" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/09/465/" class="article-date">
  <time class="dt-published" datetime="2018-10-09T03:33:00.000Z" itemprop="datePublished">2018-10-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      网卡模式下获取Air720的运行状态
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><ol>
<li>需要获取联网状态,设备识别号(IMEI),ICCID,重启设备</li>
<li>通过AT可以获取网络状态,SIM的ICCID</li>
<li>linux下需要修改内核驱动才能出AT口</li>
</ol>
<h2 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h2><p>获取信息</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">   <span class="attr">&quot;sysinfo&quot;</span>: &#123;</span><br><span class="line">      <span class="attr">&quot;hardware_version&quot;</span>: <span class="string">&quot;NZ_SSG_V20&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;device_name&quot;</span>: <span class="string">&quot;MIFI&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;version_num&quot;</span>: <span class="string">&quot;NZ_NZ_CP_2.174.000X&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;version_date&quot;</span>: <span class="string">&quot;Oct  6 2018&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;model_name&quot;</span>: <span class="string">&quot;LV01&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;main_chip_name&quot;</span>: <span class="string">&quot;PXA1802&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;ssg_version&quot;</span>: <span class="string">&quot;LV01MVL01&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;ssg_compile_time&quot;</span>: <span class="string">&quot;Oct  6 2018 10:38:24&quot;</span>,</span><br><span class="line">      <span class="attr">&quot;current_device_mac&quot;</span>: <span class="string">&quot;ac:3d:d3:d5:6d:af&quot;</span></span><br><span class="line">   &#125;,</span><br><span class="line">      <span class="attr">&quot;wan&quot;</span>: &#123;</span><br><span class="line">          <span class="comment">// ...</span></span><br><span class="line">         <span class="attr">&quot;IMEI&quot;</span>: <span class="string">&quot;869300038716XXX&quot;</span></span><br><span class="line">         <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">   <span class="comment">//... 剩下的省略</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="突破口"><a href="#突破口" class="headerlink" title="突破口"></a>突破口</h2><ol>
<li>设备自带一个网页管理工具</li>
<li>该工具需要登录,基于变种的Digest realm登录验证</li>
<li>网页是通过ajax访问/xml_action.cgi读取和操作设备</li>
<li>必须先完成一次登录,才能通过普通的Digest realm机制访问xml_action</li>
</ol>
<h2 id="操作流程"><a href="#操作流程" class="headerlink" title="操作流程"></a>操作流程</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 访问&#x2F;login.cgi,服务器返回header WWW-Authenticate</span><br><span class="line">2. 解析WWW-Authenticate,得到nonce</span><br><span class="line">3. 先使用uri&#x3D;&#x2F;cgi&#x2F;protected.cgi生成签名,作为url参数. 这点非常重要</span><br><span class="line">4. 再使用uri&#x3D;&#x2F;cgi&#x2F;xml_action.cgi生成普通的Digest realm签名,放入header</span><br><span class="line">5. 使用上两步的参数和签名,访问&#x2F;login.cgi, 服务器返回200代表登录成功,500代表失败</span><br><span class="line">6. 使用普通Digest realm签名,访问&#x2F;xml_action.cgi, 可以读取和操作设备</span><br></pre></td></tr></table></figure>
<h3 id="Digest-realm签名算法简介"><a href="#Digest-realm签名算法简介" class="headerlink" title="Digest realm签名算法简介"></a>Digest realm签名算法简介</h3><p><a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/HTTP%E6%91%98%E8%A6%81%E8%AE%A4%E8%AF%81">https://zh.wikipedia.org/wiki/HTTP%E6%91%98%E8%A6%81%E8%AE%A4%E8%AF%81</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HA1 &#x3D; md5_hex(username:realm:password)</span><br><span class="line">HA2 &#x3D; md5_hex(method:uri) &#x2F;&#x2F; method是GET&#x2F;POST&#x2F;PUT等, uri是&#x2F;cgi&#x2F;protected.cgi(仅登录)或&#x2F;xml_action.cgi</span><br><span class="line">&#x2F;&#x2F; 其中nonce是访问&#x2F;login.cgi时获取的</span><br><span class="line">&#x2F;&#x2F; nonceCount是16进制自增数列,login总是1,后续请求逐次+1</span><br><span class="line">&#x2F;&#x2F; clientNonce是客户端随机字符串,长度12字节,数字+字母就行</span><br><span class="line">&#x2F;&#x2F; qop总是auth</span><br><span class="line">RE &#x3D; md5_hex(HA1:nonce:nonceCount:clientNonce:qop:HA2)</span><br></pre></td></tr></table></figure>
<h2 id="演示代码"><a href="#演示代码" class="headerlink" title="演示代码"></a>演示代码</h2><p>基于Java的示例代码,2018-10-06的AT固件验证有效<br><a target="_blank" rel="noopener" href="https://gitee.com/wendal/Air720Master">https://gitee.com/wendal/Air720Master</a></p>
<h2 id="附上部分可以操作"><a href="#附上部分可以操作" class="headerlink" title="附上部分可以操作"></a>附上部分可以操作</h2><p>module总是duster,还没发现例外</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F; http:&#x2F;&#x2F;192.168.0.1&#x2F;xml_action.cgi?method&#x3D;get&amp;module&#x3D;duster&amp;file&#x3D;status1</span><br><span class="line">&#x2F;&#x2F; 全部状态? status1</span><br><span class="line">&#x2F;&#x2F; 流量信息 statistics</span><br><span class="line">&#x2F;&#x2F; 上网配置 wan</span><br><span class="line">&#x2F;&#x2F; 局域网配置 lan</span><br><span class="line">&#x2F;&#x2F; PIN&#x2F;PUK设置 pin_puk</span><br><span class="line">&#x2F;&#x2F; USSD设置 ussd</span><br><span class="line">&#x2F;&#x2F; 联网设备 device_management_all</span><br><span class="line">&#x2F;&#x2F; 设备统计 device_management</span><br><span class="line">&#x2F;&#x2F; 日志 detailed_log</span><br><span class="line">&#x2F;&#x2F; 自定义防火墙 custom_fw</span><br><span class="line">&#x2F;&#x2F; 端口过滤 port_filter</span><br><span class="line">&#x2F;&#x2F; 端口转发 port_forwarding</span><br><span class="line">&#x2F;&#x2F; 电话本 phonebook</span><br><span class="line">&#x2F;&#x2F; 短信 message</span><br><span class="line">&#x2F;&#x2F; 管理员配置 admin</span><br><span class="line">&#x2F;&#x2F; 固件版本 firmware</span><br><span class="line">&#x2F;&#x2F; 重启 reset</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/09/465/" data-id="ckkfmdgbf005pvkcgd0ex74rg" data-title="网卡模式下获取Air720的运行状态" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/10/09/466/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          4G模块Air720系列 android RIL驱动源码发布！（2019/2/25更新)
        
      </div>
    </a>
  
  
    <a href="/2018/10/07/464/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">详解Air202/Air80x的Luat升级流程</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>