<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:type" content="website">
<meta property="og:title" content="Luat doc 社区文章静态页面镜像">
<meta property="og:url" content="https://doc.luatos.wiki/page/30/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-20" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/02/10/20/" class="article-date">
  <time class="dt-published" datetime="2020-02-10T07:14:00.000Z" itemprop="datePublished">2020-02-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/02/10/20/">上海合宙Luat 模块 Air720SL开发板 入门指南（1）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="本文要实现的内容"><a href="#本文要实现的内容" class="headerlink" title="本文要实现的内容"></a>本文要实现的内容</h2><p><a href="#1">1） 给开发板添加必要的附属器件</a></p>
<p><a href="#2">2） 安装开发环境</a></p>
<p><span id="1"></span></p>
<p>##设置开发板</p>
<p>我司提供的开发板是这样的</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210150911367_devboard2.jpg></img></p>
<p>您需要自行添加排针排母以方便实用。 需要的配套元件如下：</p>
<p>1）2.54mm<strong>排针</strong>：1X2 4个，1X4 1个，1X3 1个</p>
<p>2）2.54mm<strong>排母</strong>： 2X11 一个，2X10 1个</p>
<p>再备用一些杜邦线。</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210150958901_line.jpg></img></p>
<p>安装配套元件后如下图所示：</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151006512_board_conn.jpg></img></p>
<p>电路板上有两个microUSB接口，上面的和Air720SL的USB_DM，USB_DP相连，安装驱动后，可以被映射成三个虚拟串口和一个NDiS标准网卡。 下面的通过CH330N和720SL的 UART1/UART2相连，并通过一个拨动开关来选择。 如果采用Lua开关，USB应该插到上面的插口，如果采用AT开发，USB应该插到下面的接口。两个接口也有辅助供电的功能，可以同时插上，提高对开发板的供电能力。</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151054924_microusb.jpg></img></p>
<p>电路上有3个可以从MicroUSB取到电或者从外部给模块供电的接口。 电源开关置于DC-DC后端，用来控制MicroUSB给Air720SL模块的供电。</p>
<p>GND-&gt;电源负极，与USB GND 相连</p>
<p>5V-&gt;电源正极，与USB +5V 相连</p>
<p>4V-&gt;DC-DC输出，与720SL模块VBAT_MODULE供电相连</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151116960_power.jpg></img></p>
<p>下面介绍板载的接口</p>
<p>720SL 共有GPIO接口37个，电平均为1.8V 最大输出电流约2mA。 GPLDO，1个，电压1.8V,2.8V,3.3V可配置，最大输出电流200mA</p>
<p>10,11,</p>
<p>17,18</p>
<p>20,21,22,23, 24,25,26,27, 28,29,30,31, 32,33,34,35, 36,37,38,39, 40,41,42</p>
<p>49,50,51,52,</p>
<p>61,62,63,64, 65,66</p>
<p>其中下侧引出GPIO口18个，上侧引出GPIO口为17个, 共35个，除被I2C2端口复用的GPIO49,50从右侧引脚单独引出外，上下两侧排针包括了模块所有GPIO，分布如下图</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151134740_gpio.jpg></img></p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151148693_GPIO.png></img></p>
<p>图中VG为1.8V 20mA常备LDO输出，A0，A1为两个 0-1.35V的 12bits ADC，B为强制Flash的功能性引脚，V6为GPLDO6，输出电压默认为1.8V，最大200mA，G为电源负极。</p>
<p>其余引脚定义如下：</p>
<p>1）I2C1 （复用排母上的GPIO10,11）</p>
<p>2）I2C2 （GPIO49,50,右侧双针)</p>
<p>3）3.3V电平转换过的I2C1端口 （右侧3针排针）</p>
<p>4）UART信号监听 (左下侧3针，未框起来的）</p>
<p>注意：由于UART引脚和内部驱动电路已经连接，不可再作为外部UART口使用，此处仅可作为波形监控之用。</p>
<p>使用720SL的IO端口首要注意的问题是电平问题，因为输出的高电平只有1.8V，如果需要其他电平输出需要自行转换。</p>
<p><span id="2"></span></p>
<h2 id="设置软件开发环境"><a href="#设置软件开发环境" class="headerlink" title="设置软件开发环境"></a>设置软件开发环境</h2><p>第一步，安装驱动程序，安装后如果不使用开发板网卡上网，应该禁用网卡。</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151228764_visualport.jpg></img></p>
<p>驱动下载地址和安装方法在以下链接：<br><a target="_blank" rel="noopener" href="http://www.openluat.com/Product/file/asr1802/lte.html">http://www.openluat.com/Product/file/asr1802/lte.html</a></p>
<p>第二步，安装编程环境，推荐使用微软公司的最新开源编辑器Visual studio code + Luatools，</p>
<p>第三步，我简要的介绍一下烧写固件的方法，出厂默认的Air720SL固件一般为AT固件，我们需要将其刷为Luat固件，下载地址为：</p>
<p><a target="_blank" rel="noopener" href="http://www.openluat.com/Product/file/asr1802s/core_V0008.zip">http://www.openluat.com/Product/file/asr1802s/core_V0008.zip</a><br><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151259871_luatools.png></img></p>
<p>对于Air720SL，开发板左上侧的电源开关要先打开，然后右下侧的开机按钮按3秒钟，如果电脑扬声器打开，应该能听到USB被识别的声音。此时Luatools下选择下载文件名带luat的blf固件（文末配套资源包里有），然后按一下左下部的重启按钮，刷机就开始启动。</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151316807_flash.jpg></img></p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151329419_downloadFW.jpg></img></p>
<p>这个过程并不复杂，如果不能按这个逻辑执行，请依次检查</p>
<p>1） 驱动是否安装成功（设备管理器里能看到3个虚拟COM口）</p>
<p>2） 供电是否充足（板子有没有反复重启，或者电源灯点不亮）</p>
<p>3） USB电缆质量</p>
<p>如果您因故需要刷会AT版的固件，请使用文末配套资源包里含AT字样的blf文件刷回去。 注意：可以短路R49的TP，使开发板上电自开机。</p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151339331_autopower.jpg></img></p>
<p>EVB_Air720SL官方商城购买链接：</p>
<p><a target="_blank" rel="noopener" href="http://m.openluat.com/product/1192">http://m.openluat.com/product/1192</a></p>
<p><img id="portrait" src=http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200210151350479_evb.jpg></img></p>
<p>感谢您选用上海合宙正品物联网模块，祝您开发顺利。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/02/10/20/" data-id="ckkfmdga7002jvkcg4vco3l19" data-title="上海合宙Luat 模块 Air720SL开发板 入门指南（1）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-688" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/02/06/688/" class="article-date">
  <time class="dt-published" datetime="2020-02-06T07:40:36.000Z" itemprop="datePublished">2020-02-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/02/06/688/">1小时完成简单的测试用&#34;车载定位器&#34;（使用air800开发板与阿里云物联网平台）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><span style="color: rgb(51, 51, 51);"><br></span></p><p><span style="color: rgb(51, 51, 51);"><br></span></p><h4><span style="font-weight: bold;"><font color="#333333">看到淘宝上有很多便宜的车载定位器，也想试试！<br></font><font color="#333333">正好手里有一块</font><span style="color: rgb(51, 51, 51);">Air800<br></span><span style="color: rgb(51, 51, 51);">众所周知，Air800 模块 M4 是一款支持 GPRS+GPS 的开发版</span></span></h4><h4><span style="font-weight: bold;"><span style="color: rgb(51, 51, 51);"><br></span></span></h4><h4><span style="font-weight: bold;"><span style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);">功能：</span></span></h4><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="font-size: 14pt; font-family: 楷体;">电子围栏、历史轨迹、短信告警、热力图、3D模型</span></h3><p><span style="color: rgb(51, 51, 51);"><br></span></p><p></p><h4><span style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);"><b style="">首先：</b></span></h4><p></p><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"></h3><h3></h3><h3><span style="font-size: 14pt; font-family: 楷体;">准备air800开发板</span></h3><h4><span style="font-size: 14pt; font-family: 楷体;">开通阿里云物联网平台</span><span style="font-family: 楷体; font-size: 18.6667px;">打开连接阿里云物联网平台的luat程序（参考：</span><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/438/0" style="background-color: rgb(255, 255, 255); font-family: inherit; text-indent: -21pt;">http://doc.openluat.com/article/438/0</a><span style="color: inherit; text-indent: -21pt; font-family: 楷体; font-size: 18.6667px;">）</span></h4><h4 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><br></h4><h4 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);"><span style="font-weight: 700;">其次：</span></span></h4><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">登陆阿里云，进入物联网平台</h3><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">创建产品、设备</h3><p style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><img src="https://oldask.openluat.com/image/show/attachments-2020-02-vCmHgw5T5e3bb876f4063.png" class="img-responsive" style="width: 763px;"><br></p><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">编辑功能定义</h3><h4 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><img src="https://oldask.openluat.com/image/show/attachments-2020-02-fNiXjGHW5e3bb8e2228f7.png" class="img-responsive" style="width: 629.5px;"><span style="color: inherit; font-family: 楷体; font-size: 18.6667px; text-indent: -21pt;"><br></span></h4><h3 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">改写阿里云程序（设备三元组、功能定义标识符、获取gps/基站程序）</h3><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">参考<a target="_blank" rel="noopener" href="http://doc.openluat.com/article/438/0" style="font-size: 14px; font-weight: bold;">http://doc.openluat.com/article/438/0</a></h3><h4 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><img src="https://oldask.openluat.com/image/show/attachments-2020-02-W8wgKoZV5e3bb963a2b34.png" class="img-responsive" style="width: 321.5px;"><span style="color: inherit; text-indent: -21pt; font-family: 楷体; font-size: 18.6667px;"><br></span></h4><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">下载好程序后，进入物联网平台的数据分析</h3><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">进入空间数据可视化，二维数据可视化，点击创建场景</h3><h4 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><img src="https://oldask.openluat.com/image/show/attachments-2020-02-hbplVm8F5e3bbb25dd385.png" class="img-responsive" style="width: 515px;"><span style="font-family: 楷体; font-size: 18.6667px;"><br></span></h4><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">选择之前创建的产品下的设备，开始设置</h3><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">此时地图中出现设备的图标</h3><h4 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><img src="https://oldask.openluat.com/image/show/attachments-2020-02-fiE5y3im5e3bbc6068a1a.png" class="img-responsive" style="width: 759px;"><span style="font-family: 楷体; font-size: 18.6667px;"><br></span></h4><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">点击绘制围栏，上图的浅蓝色圆圈就是围栏了</h3><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">如果设备的地理位置超出围栏，会有短信告警</h3><h4 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><img src="https://oldask.openluat.com/image/show/attachments-2020-02-Kfouf7e35e3bbcef15838.png" class="img-responsive" style="width: 319.5px;"><span style="font-family: 楷体; font-size: 18.6667px;"><br></span></h4><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">点击历史轨迹，产看定位器的轨迹线</h3><h4 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><img src="https://oldask.openluat.com/image/show/attachments-2020-02-uZy6tYaC5e3bbdda29aac.png" class="img-responsive" style="width: 706.5px;"><span style="font-family: 楷体; font-size: 18.6667px;"><br></span></h4><h4 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><span style="font-family: 楷体; font-size: 18.6667px;"><br></span></h4><h4 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);"><span style="font-weight: 700;">最后：</span></span></h4><h4 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);"><span style="font-weight: 700;"><br></span></span></h4><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">超简单的车载air800开发板的定位器，完成</h3><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;">开车去测试！</h3><h4 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><br></h4><h4 style="color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><br></h4>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/02/06/688/" data-id="ckkfmdgd400ahvkcg8nulgfbs" data-title="1小时完成简单的测试用&#34;车载定位器&#34;（使用air800开发板与阿里云物联网平台）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-14" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/02/04/14/" class="article-date">
  <time class="dt-published" datetime="2020-02-04T14:22:35.000Z" itemprop="datePublished">2020-02-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/02/04/14/">协程的简单实现(C/C++)</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="协程的简单实现-C-C"><a href="#协程的简单实现-C-C" class="headerlink" title="协程的简单实现(C/C++)"></a>协程的简单实现(C/C++)</h1><p>本文介绍Linux下用C/C++实现简单的协程的方法</p>
<p>协程有数种不同的实现方式，这里尝试最简单的一种方法。</p>
<hr>
<p>参考：</p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Coroutine">https://en.wikipedia.org/wiki/Coroutine</a>   协程介绍</p>
<p><a target="_blank" rel="noopener" href="https://linux.die.net/man/3/getcontext">https://linux.die.net/man/3/getcontext</a>    函数文档</p>
<p><a target="_blank" rel="noopener" href="https://linux.die.net/man/3/makecontext">https://linux.die.net/man/3/makecontext</a>   函数文档</p>
<p><a target="_blank" rel="noopener" href="https://code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/x86/sys/ucontext.h.html">https://code.woboq.org/userspace/glibc/sysdeps/unix/sysv/linux/x86/sys/ucontext.h.html</a>     linux源码</p>
<p><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/52061644">https://zhuanlan.zhihu.com/p/52061644</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/tonbit/coroutine">https://github.com/tonbit/coroutine</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/Winnerhust/uthread">https://github.com/Winnerhust/uthread</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/cloudwu/coroutine">https://github.com/cloudwu/coroutine</a></p>
<p>搜索引擎能搜到不少资料。其他在此不一一列举。</p>
<hr>
<ul>
<li>重要的概念：调用栈上下文</li>
<li>两个重要数据：mcontext_t，ucontext_t</li>
<li>四个系统级函数：getcontext，setcontext，makecontext，swapcontext</li>
</ul>
<p>主要就是用这几个工具，在调用栈层面修改相关寄存器的内容，来实现代码的执行流程（上下文）控制（切换、跳转），从而实现简单的协程。函数为系统级库函数，多数用汇编实现。</p>
<hr>
<p>看一下数据结构：</p>
<pre><code>/* Userlevel context.  */
typedef struct ucontext_t
  &#123;
    unsigned long int __ctx(uc_flags);
    struct ucontext_t *uc_link;
    stack_t uc_stack;                     //signal stack
    mcontext_t uc_mcontext;
    sigset_t uc_sigmask;
    struct _libc_fpstate __fpregs_mem;
    __extension__ unsigned long long int __ssp[4];
  &#125; ucontext_t;


mcontext_t uc_mcontext
描述cpu的状态。包含相关寄存器的数据。

uc_link
指针，指向下一个上下文（当前上下文结束后执行）。

stack_t uc_stack
signal stack信号栈

sigset_t uc_sigmask
信号mask
</code></pre>
<p>再看两个函数</p>
<pre><code>int getcontext(ucontext_t *ucp)
把当前上下文存入ucp，成功返回0。
当后续切换到这个ucp时仿佛从此处再次返回，并往下执行。

int setcontext(const ucontext_t *ucp)
将当前上下文替换为ucp，即“切换”协程，不返回。
</code></pre>
<p>看个小例子感受一下：</p>
<pre><code>#include &lt;iostream&gt;
#include &lt;ucontext.h&gt;
#include &lt;chrono&gt;
#include &lt;thread&gt;

int main()
&#123;
    int count = 0;

    ucontext_t context;

    getcontext(&amp;context);

    std::cout&lt;&lt;&quot;gg &quot;&lt;&lt;count&lt;&lt;std::endl; // c++ 打印

    ++ count;

    std::this_thread::sleep_for(std::chrono::seconds(1));

    setcontext(&amp;context); // 跳转到上面的getcontext处继续执行

    return 0;
&#125;
</code></pre>
<p>输出为</p>
<p>gg 0</p>
<p>gg 1</p>
<p>gg 2</p>
<p>gg 3</p>
<p>gg 4</p>
<p>gg 5</p>
<p>….</p>
<p>无限循环</p>
<p>注意count的值不会归零，只是执行点瞬间跳转，不相关的值并不会发生回退。</p>
<hr>
<p>再看另两个函数</p>
<pre><code>void makecontext(ucontext_t *ucp, void (*func)(), int argc, ...);
getcontext获取了上下文后，可以对其进行人为修改。func为此ucp被激活时调用的函数，即一般所说的协程。
此前得给这个ucp的uc_stack干净的空间。uc_link也得指定func结束之后要切换的目的上下文，如果设为NULL，那就不再切换，流程随func直接返回。

int swapcontext(ucontext_t *oucp, ucontext_t *ucp);
把当前上下文存入oucp，然后切换到ucp。
</code></pre>
<p>那么现在已经可以实现一个简单的协程系统。</p>
<ol>
<li><p>先有一个Coroutine类。<br>包含每个协程自己的状态，上下文等。</p>
</li>
<li><p>再有一个调度者Hub类。<br>Hub管理所有协程的数据、状态，并进行调度。</p>
<p>Hub会保存自己的上下文，然后每次协程切换都会先回到Hub的上下文，Hub再进行调度。</p>
</li>
<li><p>Hub::make()<br>make创建或者说是注册一个协程，用户端把自己的函数传给make，等待执行即可。</p>
</li>
<li><p>Hub::yield()<br>yield切换(交出控制权)，返回hub继续调度执行其他协程。<br>这里说明一下。单纯的协程切换并没有什么用，需要配合事件系统（也可以说异步机制）来达到不浪费cpu的目的。</p>
<p>举例：现在要从socket读数据，数据由远程机器的数据库产生，可能需要10秒，那么这10秒阻塞就浪费了自己的cpu。</p>
<p>如果借助某个事件系统比如libev来起一个事件，先切换出去干别的事，数据到了以后libev会发通知，那时再切换回读socket这个点继续执行代码。这样就不会浪费cpu。<br>可参考gevent等。这里不作深入，只实现基本的协程。</p>
</li>
<li><p>调度。这里没有任何算法，没有优化，就是从当前位置无脑往后轮询，保证每个协程都能轮到、不出现卡死即可。<br>实用情况应参考或发明各种调度方法。</p>
</li>
</ol>
<hr>
<p>最终代码和测试结果：</p>
<p>cr.h</p>
<pre><code>// xc 20200129 coroutine cr.h
#include &lt;iostream&gt;
#include &lt;ucontext.h&gt;
#include &lt;vector&gt;
#include &lt;chrono&gt;
#include &lt;cassert&gt;

// EMPTY-可创建新协程 NEW-新的协程 RUNNING-运行中 SUSPEND-挂起 DONE-完成
enum CoroutineStatus &#123;EMPTY, NEW, RUNNING, SUSPEND, DONE&#125;;

const int STACK_SIZE = 1024 * 32; // 每个协程的栈大小
const int MAX_COROUTINE_COUNT = 5; // 协程总数限制

class Coroutine // 协程类。包含状态、上下文、函数、各种标志位。
&#123;
public:
    int id;
    CoroutineStatus status;
    ucontext_t context;     // 上下文
    char stack[STACK_SIZE]; // 栈空间。直接用数组，不折腾动态申请。
    void (*func)(void); // 要执行的函数。为了简便，不处理参数了。
    int yielded; // 区分协程是1.函数自然执行完毕，还是2.切换出来。如果是执行完毕，状态改为EMPTY腾出位置。

    Coroutine()
    &#123;
        status = EMPTY; // 默认EMPTY，该位置可创建新协程。
    &#125;
&#125;;

class Hub // hub类。即调度者，每次协程切换都会回到hub的context进行调度。
&#123;
private:
    ucontext_t hub_context; // hub的上下文。每次协程切换都会回这里进行调度。

public:
    int max_size; // 协程总数限制
    int current_index; // 当前位置
    int coroutine_count; // 当前协程数

    std::vector&lt;Coroutine&gt; coroutine_vector; // 协程vector。简化为vector，一次创建，不动态申请。

public:
    Hub()
    &#123;
        coroutine_count = 0;
        current_index = -1;
        max_size = MAX_COROUTINE_COUNT;
        coroutine_vector = std::vector&lt;Coroutine&gt;(MAX_COROUTINE_COUNT); // 直接创建所有。不折腾动态申请内存。
    &#125;

    int print_status() // 打印系统当前状态
    &#123;
        std::cout&lt;&lt;&quot;--    coroutine_count = &quot;&lt;&lt;this-&gt;coroutine_count&lt;&lt;&quot;/&quot;&lt;&lt;this-&gt;max_size&lt;&lt;std::endl;
        std::cout&lt;&lt;&quot;--    current coroutine id = &quot;&lt;&lt;this-&gt;current_index&lt;&lt;std::endl;
    &#125;

    int make(void (*func)(void)) // 创建协程
    &#123;
        if(coroutine_count &gt;= max_size) // 超出限定数量
            return 1;

        // 找一个EMPTY的位置
        int pos = -1;
        auto coroutine_vector_size = coroutine_vector.size();
        for(int i = current_index + 1; i &lt; coroutine_vector_size; ++ i) // 往后找
        &#123;
            if(EMPTY == coroutine_vector[i].status)
            &#123;
                pos = i;
                break;
            &#125;
        &#125;

        if(pos == -1) // 没找到。再从头找。
        &#123;
            for(int i = 0; i &lt; current_index; ++ i)
            &#123;
                if(EMPTY == coroutine_vector[i].status)
                &#123;
                    pos = i;
                    break;
                &#125;
            &#125;
        &#125;

        assert(pos != -1);

        coroutine_vector[pos].id = pos;
        coroutine_vector[pos].status = NEW; // 标志为新协程
        coroutine_vector[pos].func = func;

        ++ coroutine_count; // 计数+1

        return 0;
    &#125;

    int schedule() // 调度
    &#123;
        // 选出要执行的协程。NEW或SUSPEND状态。
        int pos = -1;
        auto coroutine_vector_size = coroutine_vector.size();
        for(int i = current_index + 1; i &lt; coroutine_vector_size; ++ i) // 往后找
        &#123;
            if(NEW == coroutine_vector[i].status || SUSPEND == coroutine_vector[i].status)
            &#123;
                pos = i;
                break;
            &#125;
        &#125;

        if(pos == -1) // 从头找
        &#123;
            for(int i = 0; i &lt; current_index; ++ i)
            &#123;
                if(NEW == coroutine_vector[i].status || SUSPEND == coroutine_vector[i].status)
                &#123;
                    pos = i;
                    break;
                &#125;
            &#125;
        &#125;

        if(pos == -1) // 没找到可执行的
        &#123;
            if(coroutine_count == 1 &amp;&amp; coroutine_vector[current_index].yielded == 0)
            &#123;
                return 1; // 如果只存在一个协程，那么就是当前的协程，并且yielded == 0，代表函数正常结束，那么代表所有协程都执行完毕。
            &#125;

            std::cout&lt;&lt;&quot;no runnable coroutine&quot;&lt;&lt;std::endl;
            std::this_thread::sleep_for(std::chrono::seconds(1));
            return 0;
        &#125;

        std::cout&lt;&lt;&quot;schedule pick &quot;&lt;&lt;pos&lt;&lt;std::endl; // 选择了pos这个位置

        // 更新状态
        if(current_index != -1) // 初始状态的话，不用更新。否则更新当前协程的状态。
        &#123;
            if(coroutine_vector[current_index].yielded == 0)
            &#123;
                // 如果是函数自己执行完毕，设为EMPTY，计数-1。即销毁。
                coroutine_vector[current_index].status = EMPTY;
                -- coroutine_count;
            &#125;
            else // 否则是切换出来的，设为挂起。
                coroutine_vector[current_index].status = SUSPEND;
        &#125;

        current_index = pos; // 当前位置标记设为pos

        print_status();

        // 开始切换
        auto coroutine = &amp;coroutine_vector[pos]; // 取新选定的协程

        if(coroutine-&gt;status == NEW) // 新的协程。需要配置一下。
        &#123;
            getcontext(&amp;(coroutine-&gt;context)); // 获取当前contenxt

            // 配置
            std::fill_n(coroutine-&gt;stack, STACK_SIZE, 0); // 清理stack
            coroutine-&gt;context.uc_stack.ss_sp = coroutine-&gt;stack;
            coroutine-&gt;context.uc_stack.ss_size = STACK_SIZE;
            coroutine-&gt;context.uc_stack.ss_flags = 0;
            coroutine-&gt;context.uc_link = &amp;hub_context; // 此协程执行完跳回hub_context

            makecontext(&amp;(coroutine-&gt;context), coroutine-&gt;func, 0); // 设置要执行的函数

        &#125;

        coroutine-&gt;status = RUNNING;
        coroutine-&gt;yielded = 0;  // 默认标记为“非切换”

        // 切换。当前上下文存hub_context
        swapcontext(&amp;hub_context, &amp;(coroutine-&gt;context));

        // 因为uc_link设置为了&amp;hub_context，所以下次切换回hub时会走到这里。
        // 这样就实现了每次协程切换都会回到hub_context进行下一次调度。

        return 0;
    &#125;

    int yield() // 切换出去，交出控制权。
    &#123;
        // 切换回hub
        coroutine_vector[current_index].yielded = 1; // 标记为切换
        swapcontext(&amp;(coroutine_vector[current_index].context), &amp;hub_context);

        // 在用户端的函数内调用yield()
        // 当前上下文会存到对应的协程内。下次切换回这个函数时，就会从这里继续执行。
    &#125;

    int run() // 启动
    &#123;
        std::cout&lt;&lt;&quot;run&quot;&lt;&lt;std::endl;
        print_status();
        for(;;) // 不停地调度，直到所有协程都执行完毕。
        &#123;
            std::cout&lt;&lt;&quot;schedule ...&quot;&lt;&lt;std::endl;
            auto result = schedule();

            if(result == 1)
            &#123;
                std::cout&lt;&lt;&quot;all over&quot;&lt;&lt;std::endl;
                break;
            &#125;
        &#125;

        return 0;
    &#125;
&#125;;

Hub hub;
</code></pre>
<p>cr.cpp</p>
<pre><code>// xc 20200129 coroutine cr.cpp
#include &lt;iostream&gt;
#include &lt;chrono&gt;
#include &lt;thread&gt;
#include &quot;cr.h&quot;

void func_1_1()
&#123;
    std::cout&lt;&lt;&quot;func_1_1&quot;&lt;&lt;std::endl;
    hub.yield(); // 切换
    std::cout&lt;&lt;&quot;func_1_1 over&quot;&lt;&lt;std::endl;
&#125;

void func_1()
&#123;
    std::cout&lt;&lt;&quot;func_1&quot;&lt;&lt;std::endl;
    hub.yield(); // 切换

    for(int i = 0; i &lt; 6; ++ i)
    &#123;
        auto result = hub.make(func_1_1); // 创建
        if(result == 0)
            std::cout&lt;&lt;&quot;hub.make ok&quot;&lt;&lt;std::endl;
        else
            std::cout&lt;&lt;&quot;hub.make failed&quot;&lt;&lt;std::endl;

        std::this_thread::sleep_for(std::chrono::seconds(1));
    &#125;
    std::cout&lt;&lt;&quot;func_1 over&quot;&lt;&lt;std::endl;
&#125;

void func_2()
&#123;
    std::cout&lt;&lt;&quot;func_2&quot;&lt;&lt;std::endl;
    hub.yield(); // 切换
    hub.yield(); // 切换
    std::cout&lt;&lt;&quot;func_2 over&quot;&lt;&lt;std::endl;
&#125;

void func_3()
&#123;
    std::cout&lt;&lt;&quot;func_3&quot;&lt;&lt;std::endl;
    hub.yield(); // 切换
    std::cout&lt;&lt;&quot;func_3 over&quot;&lt;&lt;std::endl;
&#125;


int main()
&#123;
    std::cout&lt;&lt;&quot;main&quot;&lt;&lt;std::endl;
    auto result = hub.make(func_1); // 创建
    result = hub.make(func_2); // 创建
    result = hub.make(func_3); // 创建

    hub.run(); // 启动

    return 0;
&#125;
</code></pre>
<p>输出：</p>
<pre><code>main
run                                  // hub 启动
--    coroutine_count = 3/5          // 新建了3个协程
--    current coroutine id = -1      // 初始状态。当前id为-1
schedule ...
schedule pick 0                      // 执行0号位
--    coroutine_count = 3/5
--    current coroutine id = 0
func_1                               // 0号位func_1
schedule ...
schedule pick 1                      // 切换。执行1号位
--    coroutine_count = 3/5
--    current coroutine id = 1
func_2                               // 1号位func_2
schedule ...
schedule pick 2                      // 切换。执行2号位
--    coroutine_count = 3/5
--    current coroutine id = 2
func_3                               // 2号位func_3
schedule ...
schedule pick 0                      // 切换。执行0号位
--    coroutine_count = 3/5
--    current coroutine id = 0
hub.make ok                          // 连续建6个协程。但是当前已经有3个，而且总数限定为5。所以只成功2个。
hub.make ok
hub.make failed
hub.make failed
hub.make failed
hub.make failed
func_1 over                          // 0号位func_1结束。
schedule ...
schedule pick 1                      // 切换。执行1号位func_2
--    coroutine_count = 4/5          // 数量变为4
--    current coroutine id = 1
schedule ...
schedule pick 2                      // 切换。执行2号位
--    coroutine_count = 4/5
--    current coroutine id = 2
func_3 over                          // 2号位func_3结束。
schedule ...
schedule pick 3                      // 切换。执行3号位
--    coroutine_count = 3/5          // 数量变为3
--    current coroutine id = 3
func_1_1                             // 3号位func_1_1
schedule ...
schedule pick 4                      // 切换。执行4号位
--    coroutine_count = 3/5
--    current coroutine id = 4
func_1_1                             // 4号位func_1_1
schedule ...
schedule pick 1                      // 切换。执行1号位
--    coroutine_count = 3/5
--    current coroutine id = 1
func_2 over                          // 1号位func_2结束。
schedule ...
schedule pick 3                      // 切换。执行3号位
--    coroutine_count = 2/5          // 数量变为2
--    current coroutine id = 3
func_1_1 over                        // 3号位func_1_1结束。
schedule ...
schedule pick 4                      // 切换。执行4号位
--    coroutine_count = 1/5          // 数量变为1
--    current coroutine id = 4
func_1_1 over                        // 4号位func_1_1结束。
schedule ...
all over                             // 所有协程执行完毕
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/02/04/14/" data-id="ckkfmdge800cbvkcg8vklebl4" data-title="协程的简单实现(C/C++)" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-686" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/02/04/686/" class="article-date">
  <time class="dt-published" datetime="2020-02-04T00:47:59.000Z" itemprop="datePublished">2020-02-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/02/04/686/">【MQTT】为什么我收不到“遗嘱消息”呢？</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;日前，有开发者在交流群中提问：&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 0, 0); font-family: 微软雅黑, &#39;MS Sans Serif&#39;, sans-serif; font-size: 13.3333330154419px; font-style: normal; font-variant: normal; font-weight: normal; letter-spacing: normal; line-height: normal; orphans: auto; text-align: start; text-indent: 0px; text-transform: none; white-space: normal; widows: 1; word-spacing: 0px; -webkit-text-stroke-width: 0px; display: inline !important; float: none; background-color: rgb(255, 237, 196);&quot;&gt;我按官方的MQTT api,&amp;nbsp; “遗嘱”效果是反的：掉线时没有消息，上线时反而有消息。&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;本文就来讲解一下，什么情况使用遗嘱消息，什么情况下会触发遗嘱，以及如何避免它产生的误判。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;什么是遗嘱&lt;/h2&gt;&lt;p&gt;顾名思义，就是dying message。该“内定”的消息，是MQTT Client 连接 MQTT Broker 时定义的，Broker 记录下该消息。&lt;/p&gt;&lt;p&gt;其后，不论任何情况下，MQTT Client 与 MQTT Broker 之间的连接发生错误，MQTT Broker都会自动发出该消息到对应的主题。&lt;/p&gt;&lt;p&gt;典型的“异常情况”有：&lt;/p&gt;&lt;ol&gt;&lt;li&gt;MQTT Client 没有上报 close 就和 MQTT Broker 断开连接；&lt;/li&gt;&lt;li&gt;多个 keepalive 周期内没有心跳包上报；&lt;/li&gt;&lt;li&gt;其他相同 ClientID 登录 MQTT Broker 时。&lt;br&gt;&lt;/li&gt;&lt;/ol&gt;&lt;p&gt;也就是说，灵活的使用遗嘱，可以更方便的应对设备通信时发生的各种异常情况（如模块掉线、设备被盗、流量卡欠费、网咯信号差等等）。&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;如何启用MQTT遗嘱&lt;/h2&gt;&lt;p&gt;默认的MQTT例程中，没有遗嘱的相关内容。不过不用担心，MQTT 已有相关API，敬请查阅：&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://wiki.openluat.com/doc/luatApi/#mqttclientclientid-keepalive-username-password-cleansession-will-version&quot;&gt;https://wiki.openluat.com/doc/luatApi/#mqttclientclientid-keepalive-username-password-cleansession-will-version&lt;/a&gt;&lt;/p&gt;&lt;p&gt;示例代码：&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;require &quot;mqtt&quot;&lt;br&gt;module(..., package.seeall)&lt;br&gt;&lt;br&gt;-- 这里请填写修改为自己的IP和端口&lt;br&gt;local host, port = &quot;lbsmqtt.airm2m.com&quot;, 1884&lt;br&gt;&lt;/p&gt;&lt;p&gt;sys.taskInit(function()&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp; while true do&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; while not socket.isReady() do sys.wait(1000) end&lt;br&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; local mqttc = &lt;b&gt;mqtt.client(misc.getImei(), 300, &quot;username&quot;, &quot;password&quot;, nil, &lt;span style=&quot;color: rgb(255, 0, 0);&quot;&gt;
</code></pre>
<p><span style="background-color: rgb(255, 255, 0);">{qos=0, retain=0, topic=”/willmsg”, payload=misc.getImei()..”device_conn_err”}</span></span>, “3.1”)</b><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while not mqttc:connect(host, port) do sys.wait(2000) end<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if mqttc:subscribe(string.format(“/device/%s/req”, misc.getImei())) then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if mqttc:publish(string.format(“/device/%s/report”, misc.getImei()), “test publish “ .. os.time()) then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; while true do<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; local r, data, param = mqttc:receive(120000, “pub_msg”)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; if r then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; log.info(“这是收到了服务器下发的消息:”, data.payload or “nil”)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif data == “pub_msg” then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; log.info(“这是收到了订阅的消息和参数显示:”, data, param)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mqttc:publish(string.format(“/device/%s/resp”, misc.getImei()), “response “ .. param)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; elseif data == “timeout” then<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; log.info(“这是等待超时主动上报数据的显示!”)<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mqttc:publish(string.format(“/device/%s/report”, misc.getImei()), “test publish “ .. os.time())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; else<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; break<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; end<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; mqttc:disconnect()<br>&nbsp;&nbsp;&nbsp; end<br>end)</p><p>– 测试代码,用于发送消息给socket<br>sys.taskInit(function()<br>&nbsp;&nbsp;&nbsp; while true do<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sys.publish(“pub_msg”, “11223344556677889900AABBCCDDEEFF” .. os.time())<br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; sys.wait(180000)<br>&nbsp;&nbsp;&nbsp; end<br>end)<br></p></blockquote><p>后端程序的 MQTT Client 订阅 “/willmsg” 这个主题。</p><p>当该某 MQTT Client 和 MQTT Broker 连接出错时，Broker 就会自动向 “/willmsg” 主题下发内容为 “868570000000000device_conn_err”（例） 的消息。</p><p><br></p><h2>为什么我没有收到遗嘱<br></h2><p>通常，这是因为测试时，MQTT Client “掉线”时间不够长造成的。测试中，至少要等3个 Keepalive 周期，才会收到 MQTT Broker 下发的内容。</p><p>如果长时间测试仍没有收到，那么可能是如下原因：</p><ol><li>模块代码错误，或者网络错误等其他情况，或者没有成功连接到 MQTT Broker；</li><li>后台订阅的主题，和模块的遗嘱不是同一个主题；</li><li>MQTT Broker 不支持遗嘱；</li></ol><p><br></p><h2>为什么我收到了好多次遗嘱</h2><p>通常是因为模块端频繁掉线或者重连，MQTT Broker 认为上一个 MQTT Client 已经阵亡了，所以向既定主题发布了对应的消息。<br></p><p>开发者需要根据自己的需求，使用不同的主题和payload，区分遗嘱消息和正常消息，并做好对应的处理。<br></p><p><br></p><p><br></p></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/02/04/686/" data-id="ckkfmdgd300agvkcg81u370th" data-title="【MQTT】为什么我收不到“遗嘱消息”呢？" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-685" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/01/20/685/" class="article-date">
  <time class="dt-published" datetime="2020-01-20T06:02:24.000Z" itemprop="datePublished">2020-01-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/01/20/685/">onenet 新版MQTTS 连接代码分享</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;luat 编写代码连接onenet 新版MQTTS代码&lt;/p&gt;&lt;p&gt;代码功能：1.动态生成token 密钥&amp;nbsp;&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 2.根据IMEI号码 自动创建 平台设备&lt;/p&gt;&lt;p&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; 3. 利用生成的token 连接MQTTS 上传数据&lt;/p&gt;&lt;p&gt;工程代码分享github&amp;nbsp;https://github.com/CQADu/luat-onenet-MQTTS.git&lt;/p&gt;&lt;p&gt;token&lt;/p&gt;&lt;table class=&quot;highlight tab-size js-file-line-container&quot; style=&quot;border-collapse: collapse; border-spacing: 0px; box-sizing: border-box; color: rgb(36, 41, 46); font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji; font-size: 14px; font-style: normal; font-variant: normal; font-weight: 400; letter-spacing: normal; orphans: 2; text-align: left; text-decoration: none; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: normal; word-spacing: 0px;&quot; data-tab-size=&quot;8&quot;&gt;&lt;tbody style=&quot;box-sizing: border-box;&quot;&gt;&lt;tr style=&quot;box-sizing: border-box;&quot;&gt;&lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC61&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--[[&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L62&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;62&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC62&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;连接onenet后台 的token 创建函数&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L63&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;63&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC63&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;参数 et 密钥过期时间点 字符串&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L64&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;64&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC64&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp; res 实例名称 有API访问的密钥 和设备mqtt 登陆用的密钥&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L65&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;65&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC65&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;     access_key 产品key&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L66&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;66&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC66&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;返回连接用的 密钥&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L67&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;67&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC67&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;说明：加密方式 为sha1&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L68&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;68&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC68&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;]]&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L69&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;69&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC69&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;local&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;function&lt;/span&gt; &lt;span class=&quot;pl-en&quot; style=&quot;box-sizing: border-box; color: rgb(111, 66, 193);&quot;&gt;OnenetTokenCreate&lt;/span&gt;(&lt;span class=&quot;pl-smi&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46);&quot;&gt;et&lt;/span&gt; , &lt;span class=&quot;pl-smi&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46);&quot;&gt;res&lt;/span&gt; ,&lt;span class=&quot;pl-smi&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46);&quot;&gt;access_key&lt;/span&gt;)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L70&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;70&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC70&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt; 密钥时间只能一个小时有效 &lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L71&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;71&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC71&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt;res = &quot;products/&quot;.. tostring(productsId)&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L72&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;72&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC72&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt;et = os.time() + 3600&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L73&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;73&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC73&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt;et = 1578231806&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L74&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;74&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC74&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    method &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;sha1&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L75&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;75&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC75&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    version &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;2018-10-31&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L76&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;76&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC76&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    org1 &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; et &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;pl-cce&quot; style=&quot;box-sizing: border-box;&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; method &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;pl-cce&quot; style=&quot;box-sizing: border-box;&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt;&amp;nbsp; res &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; &lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;span class=&quot;pl-cce&quot; style=&quot;box-sizing: border-box;&quot;&gt;\n&lt;/span&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; version&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L77&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;77&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC77&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    log.&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;info&lt;/span&gt;(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;org1=&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt;org1)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L78&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;78&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC78&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    key&amp;nbsp; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; crypto.&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;base64_decode&lt;/span&gt;(access_key,&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;string.len&lt;/span&gt;(access_key)) &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt; 解码&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L79&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;79&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC79&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;br&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L80&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;80&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC80&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    sign_b &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; crypto.&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;hmac_sha1&lt;/span&gt;(org1,&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;string.len&lt;/span&gt;(org1),key,&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;string.len&lt;/span&gt;(key)) &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt; 采用hmac 里面的sha1 加密算法&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L81&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;81&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC81&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    log.&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;info&lt;/span&gt;(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;Hmac_sha1 Hex data = &lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; sign_b)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L82&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;82&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC82&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    sign_b &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;hex_to_binary&lt;/span&gt;(sign_b)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L83&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;83&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC83&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    log.&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;info&lt;/span&gt;(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;Hmac_sha1 Hex data2 = &lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; sign_b)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L84&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;84&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC84&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;br&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L85&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;85&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC85&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    sign &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; crypto.&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;base64_encode&lt;/span&gt;( sign_b, &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;string.len&lt;/span&gt;(sign_b) ) &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt; 对hmac 出来的数据进行 base64 编码&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L86&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;86&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC86&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;br&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L87&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;87&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC87&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    hmacUrl &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;urlEncode&lt;/span&gt;(sign)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L88&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;88&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC88&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    log.&lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;info&lt;/span&gt;(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;经过url 编码的hamc 加密码=&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;..&lt;/span&gt; hmacUrl)&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L89&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;89&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC89&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    resUrl &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;urlEncode&lt;/span&gt;(res) &lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;&lt;span class=&quot;pl-c&quot; style=&quot;box-sizing: border-box; color: rgb(106, 115, 125);&quot;&gt;--&lt;/span&gt; res 字符串也 url 编码&lt;/span&gt;&lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L90&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;90&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC90&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;    &lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;pl-c1&quot; style=&quot;box-sizing: border-box; color: rgb(0, 92, 197);&quot;&gt;string.format&lt;/span&gt;(&lt;span class=&quot;pl-s&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;version=%s&amp;amp;res=%s&amp;amp;et=%s&amp;amp;method=%s&amp;amp;sign=%s&lt;span class=&quot;pl-pds&quot; style=&quot;box-sizing: border-box; color: rgb(3, 47, 98);&quot;&gt;&#39;&lt;/span&gt;&lt;/span&gt; ,version, resUrl, et, method, hmacUrl) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr style=&quot;box-sizing: border-box;&quot;&gt;
    &lt;td class=&quot;blob-num js-line-number&quot; id=&quot;L91&quot; style=&quot;box-sizing: border-box; color: rgba(27, 31, 35, 0.3); cursor: pointer; font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; min-width: 50px; -ms-user-select: none; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; text-align: right; vertical-align: top; white-space: nowrap; width: 1%;&quot; data-line-number=&quot;91&quot;&gt;&lt;/td&gt;
    &lt;td class=&quot;blob-code blob-code-inner js-file-line&quot; id=&quot;LC91&quot; style=&quot;box-sizing: border-box; color: rgb(36, 41, 46); font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,monospace; font-size: 12px; line-height: 20px; overflow: visible; overflow-wrap: normal; padding-bottom: 0px; padding-left: 10px; padding-right: 10px; padding-top: 0px; position: relative; vertical-align: top; white-space: pre;&quot;&gt;&lt;span class=&quot;pl-k&quot; style=&quot;box-sizing: border-box; color: rgb(215, 58, 73);&quot;&gt;end&lt;/span&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;p&gt;&lt;b&gt;&lt;/b&gt;&lt;i&gt;&lt;/i&gt;&lt;u&gt;&lt;/u&gt;&lt;sub&gt;&lt;/sub&gt;&lt;sup&gt;&lt;/sup&gt;&lt;strike&gt;&lt;/strike&gt;&lt;br&gt;&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/01/20/685/" data-id="ckkfmdgf200e8vkcgbjr24ykk" data-title="onenet 新版MQTTS 连接代码分享" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-684" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/01/19/684/" class="article-date">
  <time class="dt-published" datetime="2020-01-19T12:44:57.000Z" itemprop="datePublished">2020-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/01/19/684/">做出快速简单的带有语音播放天气的定时闹钟（使用air202和阿里云物联网平台）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体; background-color: rgb(0, 0, 0); color: rgb(255, 255, 255);">首先：</span></p><p style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体;">准备air202开发板、杜邦线、喇叭</span></p><p style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体;">开通阿里云物联网平台</span></p><h4 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); margin-left: 21pt; text-indent: -21pt;"><span style="font-family: 楷体; font-size: 18.6667px;">打开连接阿里云物联网平台的luat程序（大佬们之前写过：</span>air202luat二次开发设备接入阿里云<a target="_blank" rel="noopener" href="http://doc.openluat.com/article/523/0" style="background-color: rgb(255, 255, 255); font-family: inherit; text-indent: -21pt;">http://doc.openluat.com/article/523/0</a><span style="color: inherit; text-indent: -21pt; font-family: 楷体; font-size: 18.6667px;">）</span></h4><p style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体;"><br></span></p><p style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体; color: rgb(255, 255, 255); background-color: rgb(0, 0, 0);">其次：</span></p><p style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体;">1.登陆阿里云，点击<span lang="EN-US">API</span>市场<span lang="EN-US"><o:p></o:p></span></span></p><p></p><p><span style="font-family: 楷体; font-size: 18.6667px; text-indent: -28px;">2.</span><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">选择墨迹天气免费版气象服务</span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-tprhUkyO5e2429594c827.png" class="img-responsive" style="width: 377px;"><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">3.</span><span style="font-family: 楷体; font-size: 14pt;">查看</span><span lang="EN-US" style="font-family: 楷体; font-size: 14pt;">API</span><span style="font-family: 楷体; font-size: 14pt;">接口</span><span lang="EN-US" style="font-family: 楷体; font-size: 14pt;">,</span><span style="font-family: 楷体; font-size: 14pt;">记录<span style="background-color: rgb(255, 0, 0);">调用地址、请求方式</span></span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-dw3B66yl5e2429e922355.png" class="img-responsive" style="width: 380.5px;"><span style="font-family: 楷体; font-size: 14pt;"><br></span></p><p class="MsoListParagraph" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体;"><span lang="EN-US"><o:p></o:p></span></span></p><p><span style="font-family: 楷体; font-size: 18.6667px; text-indent: -28px;">4.</span><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">然后<span lang="EN-US">,</span>点击立即购买</span></p><p class="MsoListParagraph" style="margin-left: 21pt; text-indent: -21pt;"><span style="font-size: 14pt; font-family: 楷体;"><span lang="EN-US"><o:p></o:p></span></span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-an4IORNz5e242a3942b3a.png" class="img-responsive" style="width: 385.5px;"></p><p><span style="font-family: 楷体; font-size: 18.6667px; text-indent: -28px;">5.</span><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">购买完成后<span lang="EN-US">,</span></span><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">点击进入墨迹天气</span></p><p><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">6.</span><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">查看产品详情，</span><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">点击</span><span lang="EN-US" style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">cityid</span><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">对照表，点击token查询方式，</span>将<span style="font-family: 楷体; font-size: 18.6667px; text-indent: 28px;">token下载到桌面</span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-bdOxV9VR5e243d9d537d8.png" class="img-responsive" style="width: 378px;"><br></p><p><span style="font-family: 楷体; font-size: 18.6667px; text-indent: 28px;">7.</span><span style="font-family: 楷体; font-size: 14pt;">查找所在的城市，记录</span><span style="background-color: rgb(255, 0, 0);"><span lang="EN-US" style="font-family: 楷体; font-size: 14pt;">id</span><span style="font-family: 楷体; font-size: 14pt;">号</span></span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-NQ5xmEuo5e243b3fa4bce.png" class="img-responsive" style="width: 299px;"></p><p></p><p><span style="font-family: 楷体; font-size: 18.6667px; text-indent: 28px;">8.</span><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">点击调试工具<span lang="EN-US">,</span>将刚才记录的数据填写进去</span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">点击发送请求</span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">查看当前天气<span style="color: rgb(255, 255, 255); background-color: rgb(255, 0, 0);">数据格式</span></span></p><p>&nbsp; &nbsp; 记录<span style="color: rgb(255, 255, 255); background-color: rgb(255, 0, 0);">APPCODE</span><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;"><br></span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-J15OIa1U5e24300f9378d.png" class="img-responsive" style="width: 371px;"></p><p><span style="font-family: 楷体; font-size: 14pt;">9.在iot studio中的</span><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">新建服务开发</span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">将所用到的节点搭建起来</span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 楷体; font-size: 18.6667px; text-indent: -28px;">将刚才记录的数据填写进去</span><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;"><br></span></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">配置各节点</span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-uFVa5jgU5e2430d192b69.png" class="img-responsive" style="width: 372.5px;"><span style="text-indent: 21pt;"></span></p><div><span style="font-family: 楷体; font-size: 18.6667px;">10.用</span>&nbsp;<span lang="EN-US" style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">python</span><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">脚本解析墨迹天气的数据</span></div><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-1n774Fab5e24319637e87.png" class="img-responsive" style="width: 369px;"></p><p><span style="font-family: 楷体; font-size: 18.6667px; text-indent: -28px;">11.修改air202的程序</span></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-sJWXNCb25e243bbf45ed5.png" class="img-responsive" style="width: 319px;"></p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-bQlzI3Bb5e243b509439f.png" class="img-responsive" style="width: 356.5px;"></p><p><br></p><p><span style="font-family: 楷体; font-size: 18.6667px; text-indent: -28px; color: rgb(255, 255, 255); background-color: rgb(0, 0, 0);">最后：</span><br></p><p><span style="font-family: 楷体; font-size: 18.6667px;">12.</span><span style="text-indent: -21pt; font-size: 14pt; font-family: 楷体;">点击HTTP节点的</span><span style="font-family: 楷体; font-size: 18.6667px; text-indent: -28px;">调试</span></p><h5 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);">&nbsp; &nbsp; air202<span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">开始语音播放天气</span></h5><h5 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;">13.配合阿里云web可视化开发，就可以快速简单的做出<span style="background-color: rgb(255, 255, 0);">带有播放天气的定时闹钟</span>了！</span></h5><h5 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;"><br></span></h5><h5 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;"><br></span></h5><h5 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;"><br></span></h5><h5 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;"><br></span></h5><h5 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0);"><span style="font-family: 楷体; font-size: 14pt; text-indent: 21pt;"><br></span></h5>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/01/19/684/" data-id="ckkfmdgd300afvkcggtat5rnd" data-title="做出快速简单的带有语音播放天气的定时闹钟（使用air202和阿里云物联网平台）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-683" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/01/19/683/" class="article-date">
  <time class="dt-published" datetime="2020-01-19T09:58:04.000Z" itemprop="datePublished">2020-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/01/19/683/">如果让linux 中的ethxx 设备 改名</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><b>应用场景:</b></p><p>&nbsp; &nbsp; 有些公司想将模块换成合宙的模块，但是之前的模块出现的是USBxx 网卡，合宙的是ethxx ,这让就让应用程序改动应用程序，很是麻烦！</p><p><b>修改方法：</b></p><p><b>方法一&nbsp; 修改脚本&nbsp;</b></p><p>&nbsp; &nbsp; &nbsp; &nbsp;1.找到文件&nbsp;&nbsp;/etc/udev/rules.d/70-persistent-net.rules&nbsp; &nbsp; 将SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="ac:00:00:c9:1e:c5", ATTR{dev_id}=="0x0", ATTR{type}=="1", KERNEL=="eth*"&nbsp; 改成&nbsp; SUBSYSTEM=="net", ACTION=="add", DRIVERS=="?*", ATTR{address}=="ac:00:00:c9:1e:c5", ATTR{dev_id}=="0x0", ATTR{type}=="1", KERNEL=="usb*",</p><p><b>方法二&nbsp; 修改内核&nbsp; </b>&nbsp;</p><p><span style="color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, Helvetica, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &quot;Helvetica Neue&quot;, &quot;Droid Sans&quot;, &quot;wenquanyi micro hei&quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif;">step 1：</span><br></p><p style="margin-bottom: 16px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, Helvetica, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &quot;Helvetica Neue&quot;, &quot;Droid Sans&quot;, &quot;wenquanyi micro hei&quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif;"><span style="font-weight: 700;">For Linux Kernel Version newer than 2.6.30<br>File: [KERNEL]/drivers/</span><b><span style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif;">net</span>/<span style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif;">usb</span>/<span style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif;">usbnet.c</span></b></p><pre class="prettyprint linenums prettyprinted" style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: 1.6; padding: 10px; margin-bottom: 16px; background: rgb(246, 246, 246); border-color: rgb(221, 221, 221); border-radius: 3px;"><ol class="linenums" style="padding: 0px 0px 0px 2.5em;"><li class="L0" style="list-style-type: decimal;"><font color="#000088" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">usbnet_probe (struct usb_interface *udev, const struct usb_device_id *prod)</span></font></li><li class="L2" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pun">&#123;</span></code></li><li class="L3" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span></code><font color="#000088" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">net-&gt;netdev_ops = &amp;usbnet_netdev_ops;</span></font></li><li class="L4" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span></code><font color="#000000" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">net-&gt;watchdog_timeo = TX_TIMEOUT_JIFFIES;</span></font></li><li class="L5" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span></code><font color="#000088" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">net-&gt;ethtool_ops = &amp;usbnet_ethtool_ops;</span></font></li><li class="L7" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">/ allow device-specific bind/init procedures</span></code></li><li class="L8" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span></code><font color="#000088" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">// NOTE net-&gt;name still not usable ...</span></font></li><li class="L9" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span></code><font color="#000000" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">if (info-&gt;bind) {</span></font></li><li class="L0" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">status = info-&gt;bind (dev, udev);</span></code></li><li class="L1" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span></code><font color="#000088" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">if (status &lt; 0)</span></font></li><li class="L2" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">           </span></code><font color="#000000" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">goto out1;</span></font></li><li class="L3" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        // heuristic:  "usb%d" for links we know are two-host,</span></code></li><li class="L4" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        // else "eth%d" when there's reasonable doubt.  userspace</span></code></li><li class="L5" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">// can rename the link if it knows better.</span></code></li><li class="L6" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">if ((dev-&gt;driver_info-&gt;flags &amp; FLAG_ETHER) != 0 &amp;&amp;</span></code></li><li class="L7" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">         ((dev-&gt;driver_info-&gt;flags &amp; FLAG_POINTTOPOINT) == 0 ||</span></code></li><li class="L8" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">         (net-&gt;dev_addr [0] &amp; 0x02) == 0))</span></code></li><li class="L9" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">        <b> strcpy (net-&gt;name, "eth%d");       /**** 请将此处修改为 </b></span></code><span style="font-weight: 700; color: rgb(136, 0, 0); font-size: 14px;">strcpy (net-&gt;name, "usb%d");   */</span></li><li class="L0" style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 12px; list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">         /* WLAN devices should always be named "wlan%d" */</span></code></li><li class="L1" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span></code><font color="#000000" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">if ((dev-&gt;driver_info-&gt;flags &amp; FLAG_WLAN) != 0)</span></font></li><li class="L2" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">            </span></code><font color="#000000" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">strcpy(net-&gt;name, "wlan%d");</span></font></li><li class="L3" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">          </span></code><font color="#000000" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">/* WWAN devices should always be named "wwan%d" */</span></font></li><li class="L4" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                </span></code><font color="#666600" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">if ((dev-&gt;driver_info-&gt;flags &amp; FLAG_WWAN) != 0)</span></font></li><li class="L5" style="list-style-type: decimal;"><code style="color: rgb(153, 153, 153); font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                </span></code><font color="#000088" face="YaHei Consolas Hybrid, Consolas, Meiryo UI, Malgun Gothic, Segoe UI, Trebuchet MS, Helvetica, monospace, monospace"><span style="font-size: 14px;">strcpy(net-&gt;name, "wwan%d");</span></font></li></ol></pre><p>&nbsp; &nbsp;&nbsp;<br></p><ul style="margin-bottom: 16px; padding-left: 2em; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, Helvetica, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &quot;Helvetica Neue&quot;, &quot;Droid Sans&quot;, &quot;wenquanyi micro hei&quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif;"><li><p style="margin-top: 16px; margin-bottom: 16px;">step 2：<br>为了禁止驱动将usb M0，M1加载为ttyUSB设备，需要将usb serial 驱动部分做如下修改：</p></li></ul><p style="margin-bottom: 16px; color: rgb(51, 51, 51); font-family: &quot;Microsoft YaHei&quot;, Helvetica, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Monaco, monospace, Tahoma, STXihei, 华文细黑, STHeiti, &quot;Helvetica Neue&quot;, &quot;Droid Sans&quot;, &quot;wenquanyi micro hei&quot;, FreeSans, Arimo, Arial, SimSun, 宋体, Heiti, 黑体, sans-serif;"><span style="font-weight: 700;">For Linux Kernel Version newer than 2.6.30<br>File: [KERNEL]/drivers/usb/serial/option.c</span></p><pre class="prettyprint linenums prettyprinted" style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 12px; line-height: 1.6; font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; padding: 10px; margin-bottom: 16px; background: rgb(246, 246, 246); border-color: rgb(221, 221, 221); border-radius: 3px;"><ol class="linenums" style="padding: 0px 0px 0px 2.5em; color: rgb(153, 153, 153);"><li class="L0" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="kwd">static</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> option_probe</span><span class="pun">(</span><span class="kwd">struct</span><span class="pln"> usb_serial </span><span class="pun">*</span><span class="pln">serial</span><span class="pun">,</span></code></li><li class="L1" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                        </span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> usb_device_id </span><span class="pun">*</span><span class="pln">id</span><span class="pun">)</span></code></li><li class="L2" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pun">&#123;</span></code></li><li class="L3" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="kwd">struct</span><span class="pln"> usb_interface_descriptor </span><span class="pun">*</span><span class="pln">iface_desc </span><span class="pun">=</span></code></li><li class="L4" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                                </span><span class="pun">&amp;</span><span class="pln">serial</span><span class="pun">-&gt;</span><span class="kwd">interface</span><span class="pun">-&gt;</span><span class="pln">cur_altsetting</span><span class="pun">-&gt;</span><span class="pln">desc</span><span class="pun">;</span></code></li><li class="L5" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="kwd">struct</span><span class="pln"> usb_device_descriptor </span><span class="pun">*</span><span class="pln">dev_desc </span><span class="pun">=</span><span class="pln"> </span><span class="pun">&amp;</span><span class="pln">serial</span><span class="pun">-&gt;</span><span class="pln">dev</span><span class="pun">-&gt;</span><span class="pln">descriptor</span><span class="pun">;</span></code></li><li class="L6" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"></code></li><li class="L7" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">/* Never bind to the CD-Rom emulation interface */</span></code></li><li class="L8" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">iface_desc</span><span class="pun">-&gt;</span><span class="pln">bInterfaceClass </span><span class="pun">==</span><span class="pln"> </span><span class="lit">0x08</span><span class="pun">)</span></code></li><li class="L9" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        i       </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="pln">ENODEV</span><span class="pun">;</span></code></li><li class="L0" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">//+add by airm2m for Air72x</span></code></li><li class="L1" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="kwd">if</span><span class="pun">(</span><span class="pln">dev_desc</span><span class="pun">-&gt;</span><span class="pln">idVendor </span><span class="pun">==</span><span class="pln"> cpu_to_le16</span><span class="pun">(</span><span class="lit">0x1286</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span></code></li><li class="L2" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">           dev_desc</span><span class="pun">-&gt;</span><span class="pln">idProduct </span><span class="pun">==</span><span class="pln"> cpu_to_le16</span><span class="pun">(</span><span class="lit">0x4e3d</span><span class="pun">)</span><span class="pln"> </span><span class="pun">&amp;&amp;</span></code></li><li class="L3" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">           iface_desc</span><span class="pun">-&gt;</span><span class="pln">bInterfaceNumber </span><span class="pun">&lt;=</span><span class="pln"> </span><span class="lit">1</span><span class="pun">)</span></code></li><li class="L4" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="pln">ENODEV</span><span class="pun">;</span></code></li><li class="L5" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">//-add by airm2m for Air72x</span></code></li><li class="L6" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="com">/*</span></code></li><li class="L7" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">         * Don't bind reserved interfaces (like network ones) which often have</span></code></li><li class="L8" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">         * the same class/subclass/protocol as the serial interfaces.  Look at</span></code></li><li class="L9" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">         * the Windows driver .INF files for reserved interface numbers.</span></code></li><li class="L0" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="com">         */</span></code></li><li class="L1" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">        </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">is_blacklisted</span><span class="pun">(</span></code></li><li class="L2" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                iface_desc</span><span class="pun">-&gt;</span><span class="pln">bInterfaceNumber</span><span class="pun">,</span></code></li><li class="L3" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                OPTION_BLACKLIST_RESERVED_IF</span><span class="pun">,</span></code></li><li class="L4" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                </span><span class="pun">(</span><span class="kwd">const</span><span class="pln"> </span><span class="kwd">struct</span><span class="pln"> option_blacklist_info </span><span class="pun">*)</span><span class="pln"> id</span><span class="pun">-&gt;</span><span class="pln">driver_info</span><span class="pun">))</span></code></li><li class="L5" style="list-style-type: decimal;"><code style="font-family: &quot;YaHei Consolas Hybrid&quot;, Consolas, &quot;Meiryo UI&quot;, &quot;Malgun Gothic&quot;, &quot;Segoe UI&quot;, &quot;Trebuchet MS&quot;, Helvetica, monospace, monospace; font-size: 14px; background-image: initial; background-position: 0px 0px; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; border-radius: 3px; margin: 0px; border: none; display: inline; max-width: initial; overflow: initial; line-height: inherit; overflow-wrap: normal;"><span class="pln">                </span><span class="kwd">return</span><span class="pln"> </span><span class="pun">-</span><span class="pln">ENODEV</span><span class="pun">;</span></code></li></ol></pre><p><b>优先推荐使用方法2</b></p><p>&nbsp;&nbsp;&nbsp;&nbsp;<br></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/01/19/683/" data-id="ckkfmdgf200e7vkcg3xbgdn8m" data-title="如果让linux 中的ethxx 设备 改名" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-682" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/01/17/682/" class="article-date">
  <time class="dt-published" datetime="2020-01-17T03:43:04.000Z" itemprop="datePublished">2020-01-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/01/17/682/">【4G】4G模块串口时隐时现的解决方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;使用4G模块进行二次开发时，有的群友碰到4G模块串口“时隐时现”的情况：&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;img style=&quot;width: 503px;&quot; src=&quot;https://oldask.openluat.com/image/show/attachments-2020-02-lY5nXP0R5e3781215a8a3.png&quot; class=&quot;img-responsive&quot;&gt;&lt;/p&gt;&lt;p&gt;伴随系统发现新硬件的提示音，设备管理器中，串口经常“失踪”后又“诈尸”&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;blockquote&gt;&lt;p&gt;&lt;img style=&quot;width: 497px;&quot; src=&quot;https://oldask.openluat.com/image/show/attachments-2020-02-q3O1ZvuT5e378127638a7.png&quot; class=&quot;img-responsive&quot;&gt;&lt;/p&gt;&lt;p&gt;Luatools也不能正确识别串口，无法打印任何Trace&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;通常，造成串口无法识别，或者频繁闪现的原因，是模块反复重启造成的。只有模块重启时，系统才会不断地“发现新硬件”。&lt;/p&gt;&lt;p&gt;那么，什么情况会造成模块反复重启呢？通常&lt;b&gt;供电不足&lt;/b&gt;和&lt;b&gt;代码错误&lt;/b&gt;两个原因。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;供电不足&lt;br&gt;&lt;/h2&gt;&lt;p&gt;针对&lt;b&gt;供电不足&lt;/b&gt;导致重启的情况，建议开发者检查供电问题，如果是使用USB线供电，不要使用usb-hub，也不要插在前面板，尽量使用机箱后边的插口。尽量使用足够粗的microUSB数据线，避免压降导致供电不足（必要时，可以双插usb线增强供电），模块反复重启。必要时，建议使用示波器查看供电情况。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;h2&gt;代码错误&lt;br&gt;&lt;/h2&gt;&lt;p&gt;而&lt;b&gt;代码错误&lt;/b&gt;导致的重启，通常AT模式不会遇到，只有Luat才会出现。&lt;/p&gt;&lt;blockquote&gt;&lt;p&gt;&lt;img style=&quot;width: 491.5px;&quot; src=&quot;https://oldask.openluat.com/image/show/attachments-2020-02-Pr7JCmyn5e3782b4753b6.png&quot; class=&quot;img-responsive&quot;&gt;&lt;/p&gt;&lt;p&gt;进行语法检测，可以有效避免由于代码错误导致的异常重启&lt;br&gt;&lt;/p&gt;&lt;/blockquote&gt;&lt;p&gt;开发者在下载Lua脚本，建议进行语法检测，避免常见的语法错误；另外可以使用UART1/2输出TRACE。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;由于模块重启速度很快，但是Windows识别新硬件需要很久的时间，所以通常会错过模块输出的错误信息，没有错误信息就没有办法进一步跟踪调试程序。那么怎么办呢？&lt;/p&gt;&lt;p&gt;如果开发者没有使用UART1/2，那么可以使用UART1/2输出TRACE，打开串口调试助手查看模块输出的重启日志，进一步分析代码运行的错误（波特率115200）。&lt;/p&gt;&lt;p&gt;通过UART1/2查看TRACE，这样一来，就不会因为Windows识别新硬件速度慢，而错过模块输出的错误信息了。&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;仍然反复重启，且找不到错误原因，那么建议开发者使用S720开发板进行对比测试。通常可能是布线问题，供电问题等多种因素造成的反复重启。&lt;/p&gt;&lt;p class=&quot;title&quot;&gt;如果开发者遇到无法解决又无法判断根源的反复重启问题，请参考文章：&lt;a href=&quot;http://doc.openluat.com/article/618/0&quot; target=&quot;_blank&quot;&gt;《关于Windows/Linux系统下如何用USB口抓取4G模块底层Trace？》&lt;/a&gt;&lt;/p&gt;&lt;p class=&quot;title&quot;&gt;抓取到相关底层日志后，进QQ群交流：851800257&lt;br&gt;&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/01/17/682/" data-id="ckkfmdgd300aevkcgako79ete" data-title="【4G】4G模块串口时隐时现的解决方法" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-681" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/01/17/681/" class="article-date">
  <time class="dt-published" datetime="2020-01-17T03:36:32.000Z" itemprop="datePublished">2020-01-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/01/17/681/">利用luat 一天搞定 天气预报</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>目前市面上太多开源的天气预报了，常见的有wifi esp8266 版本，树莓派版本。这些开源的天气预报都是利用wifi 或者以太网 调用第三方天气预报接口来查询当地天气预报。这里存在一个问题就是网络的接入不太方便。本次开源的天气预报利用了gprs恰好解决了这个问题。</p><p>实现原理：1.利用合宙提供的基站定位功能算出经纬度。</p><p>                   2.利用心知天气 API接口进行https的当地的天气预报数据获取</p><p>实现过程主要利用luat 里面的5个功能块：ntp 时间同步 ， lbsLoc 基站定位 ， json 数据解码 ，https 数据请求</p><p>实现教程：1.注册心知天气预报账号https://www.seniverse.com/signup?callback=https%3A%2F%2Fdocs.seniverse.com%2Fapi%2Fstart%2Fcode.html<br><img src="https://oldask.openluat.com/image/show/attachments-2020-01-1sK8BLTt5e2127df69f20.png" class="img-responsive" style="width: 312px;"><br></p><p>                   2.获取 api key<img src="https://oldask.openluat.com/image/show/attachments-2020-01-kV6KCiyv5e2127c71db84.png" class="img-responsive" style="width: 560px;">填入key 到源码里面（源码里面KEY无效了 必须自己申请）</p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-Chy8FBIu5e21280b31035.png" class="img-responsive" style="width: 287.5px;">最终效果</p><p><img src="https://oldask.openluat.com/image/show/attachments-2020-01-nOGKrwTv5e2128df1a9cb.png" class="img-responsive" style="width: 611px;"></p><p>整个工程源码在github 上 源码地址 https://github.com/CQADu/gprs-</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/01/17/681/" data-id="ckkfmdgd200advkcgg81oe7ws" data-title="利用luat 一天搞定 天气预报" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-680" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/01/17/680/" class="article-date">
  <time class="dt-published" datetime="2020-01-16T19:25:03.000Z" itemprop="datePublished">2020-01-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/01/17/680/">合宙Luat Air720SL开发板（EVB_Air720SL）初体验（3）-实现屏幕显示（下）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>##本文内容</p>
<p>在本篇文章的上部分中我们用Air202实现了一个串口屏，在本文的下部分中我们将尝试把做好的串口屏和Air720SL开发板连接，使Air720SL可以用屏幕输出文本信息。</p>
<p>##连接方法</p>
<p>Air720SL，本身有两个硬件串口，在Demo板上通过CH340转换成USB接口，供连接到电脑上调试。 由于Air720SL采用的UART为1.8V电平，在开发板中通过三极管和二极管构成的电平转换电路转换成3.3V电平，可惜这部分电路已经和CH340在线连接起来，无法单独使用，因此我用一块小板作了电平转换电路，并和DEMO板上的UART引出管脚相连接。</p>
<p> 刚好DEMO板上有一个UART1&lt;-&gt;UART2切换开关，可以将其中一路UART口与其他电路板载电路断开连接。 我们这里把开关拨到UART2上，这样UART1就可以外接电平转换电路和Air202串口屏相连了。 下面是连接示意图<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_45984.jpg"><br>##电平转换板的制作</p>
<p>因为手头没有电平转换板，所以参考Air720SL的电路自己DIY了一个，原件并不多，一共只有5个，其中TX一路采用一个三极管两个电阻，RX一路采用一个电阻和一个二极管即可。 原理图如下：</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_83038.jpg"></p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_74016.jpg"></p>
<p>我用了一块2cmX6cm的面包板，按照以上电路简单焊接了一下就完成了。 然后我们把以下几个部件用杜邦线连接起来</p>
<p>Air202串口屏</p>
<p>Air720SL开发板</p>
<p>电平转换小板</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_87648.jpg"></p>
<p>连接好后，通电测试。</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_89622.jpg"></p>
<p>##编写代码</p>
<p>下面我结合上一篇文章的IO口电平检测Demo，实现了对GPIO_32电平发生变化的检测，并显示在Air202串口屏幕上，代码如下：</p>
<p>demo.lua</p>
<pre><code>--- 模块功能：串口屏 测试 DEMO.
-- @author openLuat
-- @module gpio.testUARTDISPLAY
-- @license MIT
-- @copyright openLuat
-- @release 2020.01.17

require &quot;utils&quot;
require &quot;pm&quot;
require &quot;pins&quot;
require &quot;common&quot;

module(..., package.seeall)

local uartsetup=0

function gpioIntFnc(msg)

    if (uartsetup==1) then
        if msg==cpu.INT_GPIO_POSEDGE then
        --上升沿中断
        uart.write(1,common.utf8ToGb2312(&quot;检测到上升沿\n\r&quot;))
        else
        --下降沿中断
        uart.write(1,common.utf8ToGb2312(&quot;检测到下降沿\n\r&quot;))
        end
    end
end

--------------------------------------------GPIO初始化---------------------------------------------
pio32 = pins.setup(32, gpioIntFnc)

-------------------------------------------- 配置串口 --------------------------------------------
-- 串口ID,串口读缓冲区
local UART_ID, sendQueue, writeBuff, writeBusy = 1, &#123;&#125;, &#123; &#123;&#125;, &#123;&#125; &#125;, false
-- 串口超时，串口准备好后发布的消息
local uartimeout, recvReady = 25, &quot;UART_RECV_ID&quot;
--保持系统处于唤醒状态，不会休眠
pm.wake(&quot;mcuart&quot;)
uart.setup(UART_ID, 115200, 8, uart.PAR_NONE, uart.STOP_1, nil, 1)

uart.on(UART_ID, &quot;receive&quot;, function(uid)
    table.insert(sendQueue, uart.read(uid, 8192))
    sys.timerStart(sys.publish, uartimeout, recvReady)
end)

uartsetup=1
</code></pre>
<p>main.lua</p>
<pre><code>--必须在这个位置定义PROJECT和VERSION变量
--PROJECT：ascii string类型，可以随便定义，只要不使用,就行
--VERSION：ascii string类型，如果使用Luat物联云平台固件升级的功能，必须按照&quot;X.X.X&quot;定义，X表示1位数字；否则可随便定义
PROJECT = &quot;testUARTDISPLAY&quot;
VERSION = &quot;1.0.0&quot;

--加载日志功能模块，并且设置日志输出等级
--如果关闭调用log模块接口输出的日志，等级设置为log.LOG_SILENT即可
require &quot;log&quot;
LOG_LEVEL = log.LOGLEVEL_TRACE


require &quot;net&quot;
--每1分钟查询一次GSM信号强度
--每1分钟查询一次基站信息
net.startQueryAll(60000, 60000)


require &quot;errDump&quot;
errDump.request(&quot;udp://ota.airm2m.com:9072&quot;)


require &quot;demo&quot;

--启动系统框架
sys.init(0, 0)
sys.run()
</code></pre>
<p>##联机测试</p>
<p>将lua代码通过Luatools烧写到Air720SL上，然后连接GND与GPIO32，可以看到串口屏打印出了相应的响应信息，实验成功。</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_34463.jpg"></p>
<p>##总结</p>
<p>至此，我们完成了Air720SL模块连接Air202串口屏的整个原型电路，终于可以在Air720SL上轻松地显示调试信息了。如果您有兴趣也快来试试吧，多加20块钱立即让您的4G产品具有显示功能。 这个项目在Github上已经建立了目录，并上传了本文所述的Lua脚本代码和硬件连线图。 如果您有兴趣和我一起完善他，就快来关注吧。 也欢迎您加我 QQ：64034373 共同探讨 。</p>
<p>##开源项目地址</p>
<p>UART_DISPLAY 开源项目地址：<a target="_blank" rel="noopener" href="https://github.com/miuser00/202uartdisplay">https://github.com/miuser00/202uartdisplay</a></p>
<p>LLCCom 开源项目地址：<a target="_blank" rel="noopener" href="https://github.com/chenxuuu/llcom">https://github.com/chenxuuu/llcom</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/01/17/680/" data-id="ckkfmdgd200acvkcg06tuckh9" data-title="合宙Luat Air720SL开发板（EVB_Air720SL）初体验（3）-实现屏幕显示（下）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/29/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="page-number" href="/page/29/">29</a><span class="page-number current">30</span><a class="page-number" href="/page/31/">31</a><a class="page-number" href="/page/32/">32</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/31/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>