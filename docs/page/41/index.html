<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:type" content="website">
<meta property="og:title" content="Luat doc 社区文章静态页面镜像">
<meta property="og:url" content="https://doc.luatos.wiki/page/41/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-576" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/07/576/" class="article-date">
  <time class="dt-published" datetime="2019-04-07T15:10:17.000Z" itemprop="datePublished">2019-04-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/07/576/">合宙dtu实现各种定位器协议</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>去年闲的时候研究了下常见的定位平台的开发</p><p>最近发现合宙的产品很不错</p><p>所以用合宙的平台lua语言模拟别人的协议看看</p><p>实现性价比超高的自制定位器方案</p><p><br></p><p>这个后续会更新的</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/04/07/576/" data-id="ckkfmdgcb0082vkcghw5w923g" data-title="合宙dtu实现各种定位器协议" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-575" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/07/575/" class="article-date">
  <time class="dt-published" datetime="2019-04-07T15:03:39.000Z" itemprop="datePublished">2019-04-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/07/575/">合宙dtu实现各种报警推送</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>这个是个系列文章</p><p>会讲讲怎么接入各种报警服务</p><p>对平时开发项目很有帮助</p><p>1.合宙dtu+微信服务号模板信息推送</p><p>2.合宙dtu+潮信app信息推送</p><p>3.合宙dtu+sever酱推送</p><p>4.合宙dtu+<span style="color: rgb(128, 0, 0); font-family: &quot;lucida Grande&quot;, Verdana, &quot;Microsoft YaHei&quot;; font-size: small; text-align: justify; white-space: pre-wrap;">domoticz推送</span></p><p>5.合宙dtu+trello推送</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/04/07/575/" data-id="ckkfmdgcb0081vkcgeuy0hbk5" data-title="合宙dtu实现各种报警推送" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-574" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/07/574/" class="article-date">
  <time class="dt-published" datetime="2019-04-07T13:52:24.000Z" itemprop="datePublished">2019-04-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/07/574/">合宙dtu配置OEM工具</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;今天是放假最后一天&lt;/p&gt;&lt;p&gt;某些客户有OEM DTU配置工具的需要&lt;/p&gt;&lt;p&gt;根据合宙的接口做了这个&lt;/p&gt;&lt;p&gt;json解析和上传信息暂时还没做,后续会更新的.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;登录&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://dtu.openluat.com/api/site/login?name=用户名&amp;amp;password=密码&quot;&gt;http://dtu.openluat.com/api/site/login?name=用户名&amp;amp;password=密码&lt;/a&gt;&lt;/p&gt;&lt;p&gt;登出&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://dtu.openluat.com/api/site/logout&quot;&gt;http://dtu.openluat.com/api/site/logout&lt;/a&gt;&lt;/p&gt;&lt;p&gt;用户信息&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://dtu.openluat.com/api/site/user&quot;&gt;http://dtu.openluat.com/api/site/user&lt;/a&gt;&lt;/p&gt;&lt;p&gt;查询模块参数(如果不填就是查询所有模块参数&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;http://dtu.openluat.com/api/site/group?search_name=模块imei&quot;&gt;http://dtu.openluat.com/api/site/group?search_name=模块imei&lt;/a&gt;&lt;a href=&quot;http://dtu.openluat.com/api/site/group?search_name=模块imei&quot;&gt;&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;下面是用c#+restsharp 写的几个重要函数&lt;/p&gt;&lt;pre&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; private void button1_Click(object sender, EventArgs e)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#123;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //登录并保存cookie&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var client = new RestClient(&quot;http://dtu.openluat.com/api/site/login?name=&quot; + textBox1.Text + &quot;&amp;amp;password=&quot; + textBox2.Text + &quot;&quot;);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; client.CookieContainer = new System.Net.CookieContainer();&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var request = new RestRequest(Method.GET);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; IRestResponse response = client.Execute(request);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; foreach (var cookie in response.Cookies)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#123;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;cookie_name= cookie.Name.ToString();&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;cookie_value=cookie.Value.ToString();&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#125;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#125;&lt;/pre&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;pre&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; private void button2_Click(object sender, EventArgs e)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#123;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //查询模块信息&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var client = new RestClient(&quot;http://dtu.openluat.com/api/site/group?search_name=&quot; + textBox3.Text);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; client.CookieContainer = new System.Net.CookieContainer();&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var request = new RestRequest(Method.GET);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; request.AddParameter(cookie_name, cookie_value, ParameterType.Cookie);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; IRestResponse response = client.Execute(request);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; textBox4.Text=response.Content;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#125;&lt;/pre&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;pre&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; private void button3_Click(object sender, EventArgs e)&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#123;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; //查询用户信息&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var client = new RestClient(&quot;http://dtu.openluat.com/api/site/user&quot;);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; client.CookieContainer = new System.Net.CookieContainer();&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; var request = new RestRequest(Method.GET);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; request.AddParameter(cookie_name, cookie_value, ParameterType.Cookie);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; IRestResponse response = client.Execute(request);&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; textBox4.Text = response.Content;&lt;br&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &#125;&lt;/pre&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/04/07/574/" data-id="ckkfmdgca0080vkcg7dg0ewir" data-title="合宙dtu配置OEM工具" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-573" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/05/573/" class="article-date">
  <time class="dt-published" datetime="2019-04-05T14:30:54.000Z" itemprop="datePublished">2019-04-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/05/573/">合宙4g dtu+网页直接遥控设备</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>以前的方案用比较烂......最近发现百度云和阿里云的mqtt都支持websocket协议</p><p>经过测试都可以与mqtt.fx工具直接通信</p><p>这样就比较省事了.要求不高的控制设备可以不用装任何app就可以直接控制设备或者直接监控数据</p><p>没有以前的web api的跨域或者是开发接口的问题.</p><p><br></p><p>步骤过一阵放出来.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/04/05/573/" data-id="ckkfmdgc8007zvkcg2cjw3kko" data-title="合宙4g dtu+网页直接遥控设备" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-572" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/05/572/" class="article-date">
  <time class="dt-published" datetime="2019-04-05T14:25:47.000Z" itemprop="datePublished">2019-04-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/05/572/">合宙4G DTU+国网dlt645-2007协议抄表</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;工作中有的客户有这种需求,以前用的是安徽或者南京某公司产品,用起来还可以,就是太贵大于1000块,性价比很低&lt;/p&gt;&lt;p&gt;前一阵接触到合宙的dtu,准备用mqtt协议自己做套抄表系统,这样也方便平时上班&lt;/p&gt;&lt;p&gt;表是从淘宝上买的库存表一块25块包邮的.&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;思路:合宙dtu-发送到中国移动平台(mqtt协议)-用c#写个mqtt协议接收程序-解析dlt645-2007协议&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;-------2019-04-07 23:08更新---------------&lt;/p&gt;&lt;p&gt;645-2007协议报文&lt;/p&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;读当前正向有功总电量（假设表号为&lt;span t=&quot;7&quot; data=&quot;12345678&quot; style=&quot;border-bottom: 1px dashed rgb(204, 204, 204); z-index: 1;&quot;&gt;12345678&lt;/span&gt;）&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;FEFEFEFE6878563412000068110433333433C616&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;前导字节(固定)FEFEFEFE&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;起始符(固定)68&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;地址(根据读出的结果)&lt;span t=&quot;7&quot; data=&quot;785634120000&quot; style=&quot;border-bottom: 1px dashed rgb(204, 204, 204); z-index: 1;&quot;&gt;785634120000&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;结束符(固定)68&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;控制码()11&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;数据长度()04&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;数据内容()&lt;span t=&quot;7&quot; data=&quot;33333433&quot; style=&quot;border-bottom: 1px dashed rgb(204, 204, 204); z-index: 1;&quot;&gt;33333433&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;校验和()C6&lt;/div&gt;&lt;div style=&quot;font-family: &amp;quot;lucida Grande&amp;quot;, Verdana, &amp;quot;Microsoft YaHei&amp;quot;;&quot;&gt;结束符16&lt;/div&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;这个最近正在做,有进展下面会更新的.&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/04/05/572/" data-id="ckkfmdgc8007yvkcgcbvrbw14" data-title="合宙4G DTU+国网dlt645-2007协议抄表" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-571" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/04/05/571/" class="article-date">
  <time class="dt-published" datetime="2019-04-05T14:15:15.000Z" itemprop="datePublished">2019-04-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/04/05/571/">腾讯云通信参数计算工具</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;群里有朋友在喊腾讯云怎么连,群主也在吐槽他们的文档写的很烂,所以我抽空做了个腾讯云mqtt通信参数计算工具&lt;/p&gt;&lt;p&gt;注意:认证方式一定要选择密钥认证&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;http://oldask.openluat.com/image/show/attachments-2019-04-JeLUJwGv5ca762d27d858.jpg&quot; class=&quot;img-responsive&quot; style=&quot;width: 252.5px;&quot;&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;下载地址:&lt;a href=&quot;https://files.cnblogs.com/files/dXIOT/tengxunyun.zip&quot; target=&quot;_blank&quot;&gt;https://files.cnblogs.com/files/dXIOT/tengxunyun.zip&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/04/05/571/" data-id="ckkfmdgc8007xvkcg1pbbfybm" data-title="腾讯云通信参数计算工具" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-570" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/29/570/" class="article-date">
  <time class="dt-published" datetime="2019-03-29T08:42:13.000Z" itemprop="datePublished">2019-03-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/29/570/">如果你要频繁写文件到flash，然后频繁删除的话，请不要参考demo里的删除文件的方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>demo里的：</p><pre style="background-color:#2b2b2b;color:#a9b7c6;font-family:'Menlo';font-size:9.0pt;"><span style="color:#808080;">--[[函数名：deletefile(filename)<br></span><span style="color:#808080;">    功能：删除指定文件中的所有内容<br></span><span style="color:#808080;">    参数：文件名<br></span><span style="color:#808080;">    返回值：无             --]]<br></span><span style="color:#cc7832;font-weight:bold;">local function </span><span style="color:#009999;">deletefile</span>(<span style="color:#9966ff;">filename</span>)<span style="color:#808080;">--删除指定文件夹中的所有内容<br></span><span style="color:#808080;">    </span><span style="color:#cc7832;font-weight:bold;">local </span><span style="color:#009999;">filehandle </span>= <span style="color:#bf6060;">io</span>.<span style="color:#a39d2b;">open</span>(<span style="color:#9966ff;">filename</span><span style="color:#cc7832;">,</span><span style="color:#6a8759;">"w"</span>)<br>    <span style="color:#cc7832;font-weight:bold;">if </span><span style="color:#009999;">filehandle </span><span style="color:#cc7832;font-weight:bold;">then<br></span><span style="color:#cc7832;font-weight:bold;">        </span><span style="color:#009999;">filehandle</span>:<span style="color:#a39d2b;">write</span>()<span style="color:#808080;">--写入空的内容<br></span><span style="color:#808080;">        </span><span style="color:#bf6060;">print</span>(<span style="color:#6a8759;">"删除成功"</span>)<br>        <span style="color:#009999;">filehandle</span>:<span style="color:#a39d2b;">close</span>()<br>    <span style="color:#cc7832;font-weight:bold;">else<br></span><span style="color:#cc7832;font-weight:bold;">        </span><span style="color:#bf6060;">print</span>(<span style="color:#6a8759;">"文件不存在或文件输入格式不正确"</span>) <span style="color:#808080;">--打开失败  <br></span><span style="color:#808080;">    </span><span style="color:#cc7832;font-weight:bold;">end<br></span><span style="color:#cc7832;font-weight:bold;">end</span></pre><p>这个方法会让你的可用空间越来越少，要使用 os.remove(filename)</p><pre style="background-color: rgb(43, 43, 43); font-family: Menlo; font-size: 9pt;"><span style="color: rgb(169, 183, 198);"><span style="color:#cc7832;font-weight:bold;">if </span><span style="color:#bf6060;">io</span>.<span style="color:#a39d2b;">exists</span>(</span><font color="#6a8759">filename</font><font color="#a9b7c6">) </font><span style="color: rgb(204, 120, 50); font-weight: bold;">then<br></span><span style="color: rgb(204, 120, 50); font-weight: bold;">    </span><span style="color: rgb(191, 96, 96);">os</span><font color="#a9b7c6">.</font><span style="color: rgb(163, 157, 43);">remove</span><font color="#a9b7c6">(</font><font color="#6a8759">filename</font><font color="#a9b7c6">)<br></font><span style="color: rgb(204, 120, 50); font-weight: bold;">end</span></pre><p><br></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/03/29/570/" data-id="ckkfmdgc7007wvkcgh4va7a1x" data-title="如果你要频繁写文件到flash，然后频繁删除的话，请不要参考demo里的删除文件的方法" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-569" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/29/569/" class="article-date">
  <time class="dt-published" datetime="2019-03-29T08:03:41.000Z" itemprop="datePublished">2019-03-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/29/569/">非官方的自建OTA升级平台(Java版),免费,开源</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2 id="基本信息"><a href="#基本信息" class="headerlink" title="基本信息"></a>基本信息</h2><p>在线演示地址: <a target="_blank" rel="noopener" href="https://nutz.cn/adminlte">https://nutz.cn/adminlte</a> 使用QQ登录即可,无需注册<br>演示用升级地址: iot.nutz.cn/api/site/firmware_upgrade 推荐自建<br>本系统免费,开源,商用也是免费: <a target="_blank" rel="noopener" href="https://gitee.com/wendal/nutz-book-project">https://gitee.com/wendal/nutz-book-project</a></p>
<h2 id="相对于合宙ota的优势"><a href="#相对于合宙ota的优势" class="headerlink" title="相对于合宙ota的优势"></a>相对于合宙ota的优势</h2><ol>
<li>支持一个设备注册到多个项目</li>
<li>支持升级计划, 丰富的过滤方式(IMEI,原始版本号,时间段等等)</li>
<li>详尽的升级日志,精确到每个设备的响应及原因</li>
<li>自建可控</li>
</ol>
<h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><ol>
<li>登录 <a target="_blank" rel="noopener" href="https://nutz.cn/adminlte">https://nutz.cn/adminlte</a> 使用QQ登录即可,无需注册</li>
<li>点击luat管理模块,新建一个项目</li>
<li>修改项目密钥为合宙的PRODUCT_KEY, 推荐,但不是必须的</li>
<li>修改lua代码为</li>
</ol>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">&quot;update&quot;</span></span><br><span class="line">update.request(<span class="literal">nil</span>, <span class="string">&quot;iot.nutz.cn/api/site/firmware_upgrade&quot;</span>)</span><br></pre></td></tr></table></figure>

<ol start="5">
<li>点击固件编辑,上传新的固件</li>
<li>点击升级计划, 添加一个计划, 可以设置imei, 也可以不设置</li>
<li>启用升级计划, 重启设备,观察结果即可</li>
</ol>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_19106.png"></p>
<p>如有疑问,欢迎留言, 支持付费定制服务^_^</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/03/29/569/" data-id="ckkfmdgc7007vvkcg82pdcgi2" data-title="非官方的自建OTA升级平台(Java版),免费,开源" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-568" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/28/568/" class="article-date">
  <time class="dt-published" datetime="2019-03-28T13:51:55.000Z" itemprop="datePublished">2019-03-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/28/568/">阿里云ota示例</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>使用阿里云的用户可以使用阿里云提供的固件升级功能实现设备ota升级，相比luat云平台升级可以做到较高的实时性和高并发。</p><p>操作较为简单下面演示</p><p>1，参照之前文章建立项目并接入阿里云</p><p>2，设备端代码</p><p>我们之前连接阿里云的demo的下半部分其实就是远程升级用的</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-P29Rwsp05c9cc466c911a.png" style="width: 371.5px;" class="img-responsive">这部分代码我们不需要修改，在升级时需要的参数只有main.lua里的VERSION，在阿里云可以看到我们的版本是这样的</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-nWNv9INd5c9cc5098e9c0.png" style="width: 188px;" class="img-responsive">现在演示升到2.1.0</p><p>首先修改VERSION为2.1.0</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-gccNoZdt5c9ccea2b5c8b.png" style="width: 106px;" class="img-responsive"></p><p>然后打包</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-jAz4JZpQ5c9ccf166070f.png" style="width: 351px;" class="img-responsive">注意选择的底层一定要和你设备里的运行的相同，不然无法升级。</p><p>阿里云选择固件升级</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-a58COdvi5c9ccf7ae45cd.png" style="width: 84.5px;" class="img-responsive"></p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-ui2E6NK85c9cd020c82f9.png" style="width: 299px;" class="img-responsive">上传合并生成bin文件，注意由于阿里云限制文件名大小所以需要改一下名</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-lvWhlKRk5c9cd0726c349.png" style="width: 224.5px;" class="img-responsive"><br></p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-TIicBQGj5c9cd08fed5e4.png" style="width: 234px;" class="img-responsive"><img src="http://oldask.openluat.com/image/show/attachments-2019-03-usTp6aLR5c9cd0a00d270.png" style="width: 452.5px;" class="img-responsive"><img src="http://oldask.openluat.com/image/show/attachments-2019-03-OAsltQPf5c9cd0a958118.png" style="width: 232.5px;" class="img-responsive">然后如果你插着设备可以看到日志立刻打印</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-genu7ydZ5c9cd0e372a50.png" style="width: 497px;" class="img-responsive">稍等再查看设备</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-z4FPuBfI5c9cd11ab6107.png" style="width: 204px;" class="img-responsive">升级成功</p><p>因为设备和阿里云是长连接所以升级实时性高。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/03/28/568/" data-id="ckkfmdgc6007uvkcg2qxm4ujk" data-title="阿里云ota示例" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-567" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/03/21/567/" class="article-date">
  <time class="dt-published" datetime="2019-03-21T05:42:36.000Z" itemprop="datePublished">2019-03-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/03/21/567/">dtu做一个远程浇花系统</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>昨天晚上秦总在群里演示了一个远程开水泵抽水，既然dtu这么方便我们为何不做一个远程浇花系统呢。</p><p>1，准备</p><p>需要一个土壤湿度传感器（模拟量输出的就可以），一个air202模块，一个继电器，一个水泵，一台有公网IP的电脑。</p><p>2，系统设计</p><p>为了保证开关指令的实时下发，我们采取mqtt通信，包含上报下发两部分报文设计。</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-RWKGTC6E5c93049c1300b.png" style="width: 156px;" class="img-responsive">服务器根据上行消息的deviceid区分设备，处理数据写入数据库。设备订阅以/sub/imei为名称的topic，接受数据并处理</p><p>3，dtu设置</p><p>配置网络通道，按照上文提到的方式，发布到/pub，订阅/sub/imei（不勾选主题添加imei这里的imei就可以自动转义成设备自身的imei）</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-vrsUUnRn5c93057b2e1bf.png" style="width: 423px;" class="img-responsive"></p><p>定时采集任务</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-tmWwMwXd5c930616e3bd4.png" style="width: 339.5px;" class="img-responsive">具体脚本，直接用demo的adc改改就可以</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-VrLuXaXO5c930668af573.png" style="width: 301px;" class="img-responsive">定时采集的时间间隔是在网络通道配置的。</p><p>数据下发解析部分，这部分通过数据流实现，就是解析我们刚才定义的数据格式。</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-Pbxn1Nlr5c9306e6dba3a.png" style="width: 472px;" class="img-responsive"></p><p>4，服务器端</p><p>订阅pub，对消息处理。</p><p>php做的demo</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-Ude0lFes5c9318e546bd9.png" style="width: 292px;" class="img-responsive"><br></p><p>处理部分</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-YkT8Q1lN5c9319242d72c.png" style="width: 452px;" class="img-responsive">数据就可以分设备写入数据库。</p><p>小程序直接访问数据库就可以了</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-NQ75aOjN5c9319b6bea0d.png" style="width: 25%;" class="img-responsive"></p><p>下发指令，通过前端页面发送请求，后端通过mqtt发布。</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-RxmEv5Th5c9320937cf31.png" style="width: 325.5px;" class="img-responsive"></p><p>效果</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-DOHIpEfO5c932107c1914.png" style="width: 25%;" class="img-responsive"></p><p><br></p><p>5，最终演示</p><p>定时上报信息</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-VgZukhf75c932323a455d.png" style="width: 496.5px;" class="img-responsive"></p><p><br></p><p>小程序下发指令</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-03-zStrRpH45c9323656e017.png" style="width: 447.5px;" class="img-responsive"><img src="http://oldask.openluat.com/image/show/attachments-2019-03-uhZW7ajs5c93237b768a2.png" style="width: 399.5px;" class="img-responsive">6，总结</p><p>dtu可以方便的实现连接与协议解析，并且可以实现一部分采集和控制，免去了网络部分开发，用户只需要根据自己逻辑进行数据部分开发即可。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/03/21/567/" data-id="ckkfmdgc6007tvkcghxole14e" data-title="dtu做一个远程浇花系统" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/40/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/39/">39</a><a class="page-number" href="/page/40/">40</a><span class="page-number current">41</span><a class="page-number" href="/page/42/">42</a><a class="page-number" href="/page/43/">43</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/42/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>