<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:type" content="website">
<meta property="og:title" content="Luat doc 社区文章静态页面镜像">
<meta property="og:url" content="https://doc.luatos.wiki/page/8/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-2020" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/09/2020/" class="article-date">
  <time class="dt-published" datetime="2020-12-09T03:31:50.000Z" itemprop="datePublished">2020-12-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/09/2020/">CSDK coretest测试使用说明</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p style="text-align:center;" size="2" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false"></p><p></p><p></p><p style="text-indent:2em;">8910 CSDK地址：<a href="https://gitee.com/openLuat/Luat_CSDK_Air724U" target="">https://gitee.com/openLuat/Luat_CSDK_Air724U</a></p><p></p><p></p><p style="text-indent:2em;" class="MsoNormal"><strong><span style="line-height:150%">一、编译&amp;下载</span></strong></p><p style="text-align:justify;text-indent:2em;" class="MsoNormal" align="justify"><span style="line-height:150%">软件版本更新到最新，删除CSDK下/out目录，进入/project下运行cmd.exe，cmd。exe中运行coreTest.bat，编译最新的测试版本。编译完成，在/HEX目录下找到生成的pac包，将pac包通过luatools工具下载到模块中。</span></p><p style="text-align:justify;text-indent:2em;" class="MsoNormal" align="justify"> </p><p style="text-indent:2em;" class="MsoNormal"><strong><span style="line-height:150%">二、测试说明</span></strong></p><p style="text-indent:2em;" class="MsoNormal"><span style="line-height:150%">1、coretest的日志使用USB ap口或者HOST口输出；</span></p><p style="text-indent:2em;" class="MsoNormal"><span style="line-height:150%">2、coretest中包含zbar的测试，必须接Cam，否则开机就会出现死机；</span></p><p style="text-indent:2em;" class="MsoNormal"><span style="line-height:150%">3、通过搜索<span style="color:#ff0000">coretest</span>关键字查看coretest运行情况；</span></p><p style="text-indent:2em;" class="MsoNormal"><span style="line-height:150%">4、通过<span style="color:#ff0000">coretest-false</span>关键字判断测试中是否出现异常，只要有一个错误，那就是不正常的。没有任何错误信息，代表测试通过。</span></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/09/2020/" data-id="ckkfmdga9002ovkcg17ncda0r" data-title="CSDK coretest测试使用说明" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2013" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/08/2013/" class="article-date">
  <time class="dt-published" datetime="2020-12-08T09:08:22.000Z" itemprop="datePublished">2020-12-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/08/2013/">Air724UG模块产品规格书</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p></p><div class="media-wrap image-wrap"><img class="media-wrap image-wrap" src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20210106175606620_Air724UG_模块产品规格书-v2.0_00.png"/></div><p></p><div class="media-wrap image-wrap"><img class="media-wrap image-wrap" src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20210106175610074_Air724UG_模块产品规格书-v2.0_01.png"/></div><p></p><p></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/08/2013/" data-id="ckkfmdga8002kvkcg9c9t5r1l" data-title="Air724UG模块产品规格书" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1994" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/07/1994/" class="article-date">
  <time class="dt-published" datetime="2020-12-07T01:55:43.000Z" itemprop="datePublished">2020-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/07/1994/">$1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/07/1994/" data-id="ckkfmdga7002ivkcgfna0c2cq" data-title="$1" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1992" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/07/1992/" class="article-date">
  <time class="dt-published" datetime="2020-12-06T18:07:15.000Z" itemprop="datePublished">2020-12-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/07/1992/"> 合宙wifi模块air640w--python烧录Demo</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p><em>6块钱体验luat,你值得拥有</em><br>核心板已开源（随便画的其实）<br><a target="_blank" rel="noopener" href="https://oshwhub.com/nfwq666ya/air640-kai-fa-ban" title="立创eda">立创eda合宙air640w开发板</a><br>加群免费嫖资料<br><a target="_blank" rel="noopener" href="https://yajs666.gitee.io/" title="南风未起的个人博客">南风未起的个人博客</a></p>
<blockquote>
<p>为什么我的眼中常含着泪水，因为我对这片土地爱得深沉。–南风未起</p>
</blockquote>
<h1 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h1><p>Air640W 是基于嵌入式 Wi-Fi SoC 芯片（W600）设计的 Wi-Fi 参考设计模块，邮票孔加插针孔式接口设计，封装上兼容我司模块Air640，尺寸小，易开发。模块适用于智能家电、智能家居、无线音视频、智能玩具、医疗监护、工业控制等物联网应用领域。本规格书规定了该模块的物理特性、技术指标、通信协议、产品功能、性能、稳定性、环境适应性以及安全性等方面的技术标准。</p>
<h2 id="1-接口"><a href="#1-接口" class="headerlink" title="1.接口"></a>1.接口</h2><p>⚫    邮票孔与插针孔复合式接口，间距 2.0mm<br>⚫    UART0固件烧录口，波特率固定115200<br>⚫    UART1调试接口，支持硬件流控，波特率范围1200bps<del>2Mbps，默认为115200<br>⚫    1 个高速 SPI 设备控制器，工作时钟范围 0</del>50MHz<br>⚫    集成 GPIO 控制器</p>
<h2 id="2-通过usb-ttl供电和烧录"><a href="#2-通过usb-ttl供电和烧录" class="headerlink" title="2.通过usb-ttl供电和烧录"></a>2.通过usb-ttl供电和烧录</h2><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015158364_48.png" alt="undefined" title="undefined"></p>
<h2 id="3-Luatools烧录"><a href="#3-Luatools烧录" class="headerlink" title="3.Luatools烧录"></a>3.Luatools烧录</h2><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015728674_11.png" alt="undefined" title="undefined"><br>该工具在下面的QQ群文件下载即可<br>Demo位于script文件夹下啦</p>
<h2 id="4-py烧录"><a href="#4-py烧录" class="headerlink" title="4.py烧录"></a>4.py烧录</h2><h3 id="资料下载"><a href="#资料下载" class="headerlink" title="资料下载"></a>资料下载</h3><p>LuatOS技术交流QQ群：1061642968<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015747519_43.png" alt="undefined" title="undefined"><br>第一个是py烧录用的固件，第二个是luatools工具</p>
<h3 id="刷底层详解"><a href="#刷底层详解" class="headerlink" title="刷底层详解"></a>刷底层详解</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015759776_45.png" alt="undefined" title="undefined"><br>首先进入固件路径，选择tools文件夹点击进入<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015812610_46.png" alt="undefined" title="undefined"><br>点击刷底层文件夹，选择串口号，打开串口，<br>选择固件路径下后缀为.FLS的<code>LuatOS_Air640W_V0004_testing.FLS</code>文件<br>点击后面的<code>下载</code>按键<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015825954_47.png" alt="undefined" title="undefined"><br>此时我们需要复位air640w,按下RESET按键<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015838094_48.png" alt="undefined" title="undefined"><br>此时已下载完成<br>!!!刷底层之后需要再次复位模块!!!</p>
<h3 id="刷脚本详解"><a href="#刷脚本详解" class="headerlink" title="刷脚本详解"></a>刷脚本详解</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015854548_44.png" alt="undefined" title="undefined"><br>首先查设备管理器或者串口助手修改最后的端口号（保存）<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015909940_49.png" alt="undefined" title="undefined"><br>新建一个cmd终端并且输入此命令，上图即成功<br><code>pip3 install -i https://pypi.tuna.tsinghua.edu.cn/simple pyserial</code><br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207015920197_50.png" alt="undefined" title="undefined"><br><code>python air640w.py lfs dlfs</code><br>输入此命令便执行成功</p>
<h3 id="总结一下我做的不对的地方（请对照自己）"><a href="#总结一下我做的不对的地方（请对照自己）" class="headerlink" title="总结一下我做的不对的地方（请对照自己）"></a>总结一下我做的不对的地方（请对照自己）</h3><p>第一，底层一定要刷对，刷最新的air640w的<br>第二，刷底层成功之后必须重启模块！！不然烧不进去的<br>第三，powershell不行用cmd，命令相同</p>
<h3 id="群文件资料下载"><a href="#群文件资料下载" class="headerlink" title="群文件资料下载"></a>群文件资料下载</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201207020702465_qq.png" alt="undefined" title="undefined"><br>推荐加入QQ交流群下载咨询问题：679177589</p>
<h2 id="欢迎交流"><a href="#欢迎交流" class="headerlink" title="欢迎交流"></a>欢迎交流</h2>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/07/1992/" data-id="ckkfmdga7002hvkcgc6vu2t62" data-title=" 合宙wifi模块air640w--python烧录Demo" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1978" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/06/1978/" class="article-date">
  <time class="dt-published" datetime="2020-12-06T07:14:22.000Z" itemprop="datePublished">2020-12-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/06/1978/">Air302接入腾讯物联网通信平台 </a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Air302接入腾讯物联网通信平台"><a href="#Air302接入腾讯物联网通信平台" class="headerlink" title="Air302接入腾讯物联网通信平台"></a>Air302接入腾讯物联网通信平台</h1><h3 id="一、前简介"><a href="#一、前简介" class="headerlink" title="一、前简介"></a>一、前简介</h3><p><a target="_blank" rel="noopener" href="https://gitee.com/openLuat/LuatOS/tree/master/bsp/air302">合宙Air302</a>, 是基于移芯EC616的NB-IOT模块。</p>
<p><a target="_blank" rel="noopener" href="https://console.cloud.tencent.com/iothub">腾讯云物联网通信</a>（Internet of Things Hub， IoT Hub）旨在提供一个安全、稳定、高效的连接平台，帮助开发者低成本、快速地实现“设备-设备”、“设备-用户应用”、“设备-云服务”之间可靠、高并发的数据通信。不仅可以实现设备之间的互动、设备的数据上报和配置下发，还可以基于规则引擎和腾讯云产品打通，方便快捷地实现海量设备数据的存储、计算以及智能分析。</p>
<p>MQTT是一个基于客户端-服务器的消息发布/订阅传输协议。MQTT协议是轻量、简单、开放和易于实现的，这些特点使它适用范围非常广泛。在很多情况下，包括受限的环境中，如：机器与机器（M2M）通信和物联网（IoT）。其在，通过卫星链路通信传感器、偶尔拨号的医疗设备、智能家居、及一些小型化设备中已广泛使用。</p>
<h3 id="二、Air302刷入Luat固件"><a href="#二、Air302刷入Luat固件" class="headerlink" title="二、Air302刷入Luat固件"></a>二、Air302刷入Luat固件</h3><p>emmm 这部分还在写，其实已经有了官方教程。</p>
<h3 id="三、腾讯云注册"><a href="#三、腾讯云注册" class="headerlink" title="三、腾讯云注册"></a>三、腾讯云注册</h3><p><a target="_blank" rel="noopener" href="https://cloud.tencent.com/">点击直连腾讯云</a></p>
<h3 id="四、设置腾讯云物联网通信平台"><a href="#四、设置腾讯云物联网通信平台" class="headerlink" title="四、设置腾讯云物联网通信平台"></a>四、设置腾讯云物联网通信平台</h3><p>1、进入腾讯云物联网通信</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150236051_QQ%E6%88%AA%E5%9B%BE20201206141728.png" alt="undefined" title="undefined"></p>
<p>2、点击左上侧的创建新产品</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150312977_QQ%E6%88%AA%E5%9B%BE20201206141834.png" alt="undefined" title="undefined"></p>
<p>3、这里注意，节点类型选设备，产品类型选普通产品（别问为什么，因为这么做简单）</p>
<p>产品名称随便填，认证方式选密钥认证（这篇文章讲的就是密钥接入，主要还是简单）</p>
<p>数据格式建议json，比较方便，描述随意了。</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150323856_QQ%E6%88%AA%E5%9B%BE20201206142003.png" alt="undefined" title="undefined"></p>
<p>4、设置完之后，记录下产品ID</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150343240_QQ%E6%88%AA%E5%9B%BE20201206142251.png" alt="undefined" title="undefined"></p>
<p>5、进到设备列表，这里要添加两个设备，一个设备是air302，另一个设备相当于客户。</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150400600_QQ%E6%88%AA%E5%9B%BE20201206142429.png" alt="undefined" title="undefined"><br>密钥选择物联网通信提供的即可。</p>
<p>6、进入新建好的设备，找到设备密钥一栏。</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150411086_QQ%E6%88%AA%E5%9B%BE20201206142559.png" alt="undefined" title="undefined"><br>点击右侧的显示</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150427848_QQ%E6%88%AA%E5%9B%BE20201206142642.png" alt="undefined" title="undefined"></p>
<p>这里需要注意三个值，client id ；mqtt username；mqtt password；一会儿会用到</p>
<p>7、新建信息转发规则（因为两个设备如果信息不转发是不能收到互相的信息的）</p>
<p>点击左侧的“规则引擎”</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150443315_QQ%E6%88%AA%E5%9B%BE20201206142928.png" alt="undefined" title="undefined"><br>点击新建规则</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150451326_QQ%E6%88%AA%E5%9B%BE20201206142956.png" alt="undefined" title="undefined"></p>
<p>名称随便填 点击确定</p>
<p>设置好后会出现这条规则</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150502405_QQ%E6%88%AA%E5%9B%BE20201206143120.png" alt="undefined" title="undefined"><br>不要启用，点击管理</p>
<p>进入后先点击筛选数据右侧的编辑</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150511405_QQ%E6%88%AA%E5%9B%BE20201206143229.png" alt="undefined" title="undefined"><br> 进入后进行如下的设置</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150521268_QQ%E6%88%AA%E5%9B%BE20201206143430.png" alt="undefined" title="undefined"></p>
<p>字段填*号，意思是全部转发</p>
<p>下面三个框框选择你的产品 设备 订阅地址</p>
<p>设置好后点击确定</p>
<p>接下来点击添加行为操作</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150826691_QQ%E6%88%AA%E5%9B%BE20201206143755.png" alt="undefined" title="undefined"></p>
<p>按照下图设置即可</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150539230_QQ%E6%88%AA%E5%9B%BE20201206144039.png" alt="undefined" title="undefined"></p>
<p>设置好后回到规则引擎，启用规则皆可。</p>
<h3 id="五、编写lua脚本"><a href="#五、编写lua脚本" class="headerlink" title="五、编写lua脚本"></a>五、编写lua脚本</h3><p>这里使用了air302的mqtt2 demo修改</p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/openLuat/LuatOS/blob/master/bsp/air302/demo/mqtt2/main.lua">链接在这里</a></p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150555443_QQ%E6%88%AA%E5%9B%BE20201206145054.png" alt="undefined" title="undefined"></p>
<p>这里放一个腾讯的官方文档，链接地址直接复制就行。<a target="_blank" rel="noopener" href="https://cloud.tencent.com/document/product/634/14630">点我直达</a></p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206150604781_QQ%E6%88%AA%E5%9B%BE20201206145702.png" alt="undefined" title="undefined"><br>这里改一下就行</p>
<h3 id="六、上传lua脚本"><a href="#六、上传lua脚本" class="headerlink" title="六、上传lua脚本"></a>六、上传lua脚本</h3><p>建议用python脚本上传</p>
<p>python air302.py lfs dlfs</p>
<p>或者python air302.py lfs full</p>
<hr>
<p>上传完之后你就会看见腾讯云物联网通信平台显示设备一上线，客户端那里也可以接收到信息。</p>
<p>至此，air302接入腾讯物联网通信平台就完成了。</p>
<h5 id="有错误还请指出。"><a href="#有错误还请指出。" class="headerlink" title="有错误还请指出。"></a>有错误还请指出。</h5><p>梦程MI</p>
<p>2020.12.6</p>
<hr>
<p><a target="_blank" rel="noopener" href="https://space.bilibili.com/88809897">bilibili</a></p>
<p><a target="_blank" rel="noopener" href="https://www.dreamcstudio.cn/">个人博客</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/06/1978/" data-id="ckkfmdga6002gvkcgbqgq97u5" data-title="Air302接入腾讯物联网通信平台 " class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1976" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/06/1976/" class="article-date">
  <time class="dt-published" datetime="2020-12-05T19:44:39.000Z" itemprop="datePublished">2020-12-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/06/1976/">MIT 6.824 Distributed Systems 分布式系统课程系列3 Lab3-Fault-tolerant Key/Value Service</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="MIT-6-824-Distributed-Systems-分布式系统课程系列3-Lab3-Fault-tolerant-Key-Value-Service"><a href="#MIT-6-824-Distributed-Systems-分布式系统课程系列3-Lab3-Fault-tolerant-Key-Value-Service" class="headerlink" title="MIT 6.824 Distributed Systems 分布式系统课程系列3 Lab3-Fault-tolerant Key/Value Service"></a>MIT 6.824 Distributed Systems 分布式系统课程系列3 Lab3-Fault-tolerant Key/Value Service</h1><ul>
<li>实验主页：<a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.824/labs/lab-kvraft.html">https://pdos.csail.mit.edu/6.824/labs/lab-kvraft.html</a></li>
<li>任务：在raft基础上实现一个分布式可容灾的kv服务。</li>
</ul>
<hr>
<h1 id="1-介绍"><a href="#1-介绍" class="headerlink" title="1.介绍"></a>1.介绍</h1><ul>
<li><p>在Lab2中我们学习并实现了raft算法。有了raft，我们其实已经实现了数据的一致性存储和容灾。<br>比如起3个raft节点，把一批数据存进某个节点，数据在三个节点上都会保持强一致性。<br>整个系统可以承受在某个时间点有1个节点出现故障。<br>如果配置大量节点，比如9台服务器，可靠性会非常有保障。可承受4台机器同时出故障</p>
</li>
<li><p>这次任务是在raft的基础上实现一个key/value服务。<br>虽然是一个相对简单的kv服务，但是掌握基本技术之后可扩展为更复杂的应用，比如分布式数据库或分布式文件系统等等。</p>
</li>
<li><p>任务分为AB两部分。A部分是基础的kv服务。B部分引入log压缩(log快照)。</p>
</li>
</ul>
<hr>
<h1 id="2-kv服务"><a href="#2-kv服务" class="headerlink" title="2. kv服务"></a>2. kv服务</h1><h2 id="架构"><a href="#架构" class="headerlink" title="架构"></a>架构</h2><ul>
<li><p>有数个raft节点。实现数据一致性。</p>
</li>
<li><p>有数个kvserver实体。存储实际的kv数据。可看作数据库实体。<br>一个kvserver绑定一个raft节点。</p>
</li>
<li><p>可有任意多个client实体，即客户端。可以看作连接数据库的客户端工具。</p>
</li>
<li><p>比如有3台机器，每个机器上跑一个kvserver，每个kvserver里包含一个raft节点。<br>raft节点之间可互通。kvserver可与自己的raft节点交互。<br>client为任意多个，可与任意kvserver交互。</p>
</li>
</ul>
<h2 id="数据"><a href="#数据" class="headerlink" title="数据"></a>数据</h2><ul>
<li>数据就是简单的key和value键值对。都是string类型。</li>
</ul>
<h2 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h2><ul>
<li>实现3个操作：Put(key, value)赋值，Append(key, arg)追加，Get(key)取值。</li>
</ul>
<h2 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h2><h3 id="一些要点"><a href="#一些要点" class="headerlink" title="一些要点"></a>一些要点</h3><ul>
<li>只要多数server能互通，client发命令必须要能返回，不能无限卡死。否则允许卡死。</li>
<li>client发一个命令必须等到server回复才能返回。这里肯定是简化了，现实应用肯定得有个超时提示。</li>
<li>没有commit的log可能被清掉(别的命令覆盖)。一旦commit，就不能被清掉，如果发生，那数据就坏了，就是实现有问题。</li>
<li>看一下论文第8章，少走弯路。</li>
</ul>
<h3 id="基本流程-TestBasic3A"><a href="#基本流程-TestBasic3A" class="headerlink" title="基本流程 TestBasic3A"></a>基本流程 TestBasic3A</h3><ul>
<li><p>GenericTest是通用的测试流程。包含起kvserver，起client，发命令，设置网络故障、网络分组，重启节点等各种测试流程。</p>
</li>
<li><p>最简单的测试。5个server</p>
</li>
<li><p>make_config<br>对每个server调StartServer(我们实现)进行我们kv服务的初始化：起一个KVServer，KVServer包含一个raft节点。</p>
</li>
<li><p>makeClient<br>用MakeClerk(我们实现)创建客户端(他所谓的clerk)。</p>
</li>
<li><p>一些初始化后进入测试循环。</p>
</li>
<li><p>spawn_clients_and_wait<br>起一个channel<br>用run_client起一个client并调用循环里的闭包<br>等待channel的数据</p>
</li>
<li><p>闭包函数主要做一顿kv操作。先put一个值。<br>再进入一个循环(会持续5秒(见done_clients))，每次随机选一个操作：</p>
</li>
</ul>
<p>1.append。key是server id，value是根据循环造的一个值。并记下append后的值。<br>2.get。用key获取获取value，跟记下的值对比。不一样就是测试失败。</p>
<ul>
<li><p>5秒过后<br>做一些模拟(断网、重启等)，现在是最简测试，所以跳过。<br>对每个server的kv进行检查(checkClntAppends)。因为存入的值是定了规则的，所以可检查正确性。<br>最后对log的大小做一些检查</p>
</li>
<li><p>代码可总体分为3层：client，server，raft。<br>client可看作各种数据库连接工具。处理人类或测试程序发来的请求，与server交互，获取结果。client可以自己选择连哪个server<br>server实现kv存储，与raft系统交互，根据raft的指示来执行实际的kv操作。<br>raft负责每个kv操作在整个系统中的一致性。<br>例如一个命令来了以后，raft得把它安全复制到多数server后才通知server这个命令已经完成复制了，可以执行。然后各个server才能执行这个命令。然后client才能看到这个命令执行的最终结果。</p>
</li>
</ul>
<ul>
<li><p>client.go里。Get和PutAppend，直接给server发Get和PutAppend的rpc。<br>client把命令发给谁？<br>应该找leader发，并记录每一次的leader。如果leader改变，rpc应该返回相应的错误，client就找新的leader。</p>
</li>
<li><p>PutAppend怎样算成功？<br>命令提交给raft，按说要等raft把这个命令复制到多数server，再发apply消息后，kv服务才真正执行PutAppend，再返回成功。<br>看测试代码是Append之后必须Get到正确的值，也就是应用层面是不考虑任何超时的。<br>所以为了迎合测试，每次发命令一定要等到正确执行才返回。<br>在server里rf.Start()之后，要死等apply消息，等到才返回。<br>这里可以思考一些异常，如果leader apply这个之后马上挂了。下次这个client发命令时会连一个新的leader。这时会不会造成重发？各server的命令数据是否正确？</p>
</li>
<li><p>rpc的reliable问题<br>发rpc如果能收到正常回复，无论成功还是失败，都是好的。<br>如果rpc无响应，就麻烦，无法确定是什么情况。<br>测试程序可以模拟rpc不稳定，可能</p>
</li>
</ul>
<p>1.对端收不到rpc(不执行)。<br>2.对端收到rpc，执行以后，回复结果时网络不通。<br>这两种情况rpc都会失败，得重发，但是2的情况可能造成一条命令重复执行。<br>想到序列号的方法，给每一个命令做一个唯一的sn，收到命令后每次判断一下sn是否已经执行过，就可能避免重复执行了。也保证了操作的幂等性。怎么做唯一sn？现实中应该也是很有讲究，这里直接用随机数简化。</p>
<ul>
<li>ApplyMsg的接收<br>在每个kvserver里起一个ApplyTask的goroutine专门收ApplyMsg(在lab2里是测试程序收的这个消息)，收到就实际执行命令。<br>对于不是收命令的server，不做其他事情。<br>如果是该server接收的命令，那么得通知client命令已经执行完，让client返回。前面说过现在的模式是client发命令必须死等一个确切的结果。<br>我加了另一个channel来传这个消息。</li>
</ul>
<h3 id="TestOnePartition3A"><a href="#TestOnePartition3A" class="headerlink" title="TestOnePartition3A"></a>TestOnePartition3A</h3><ul>
<li><p>这个测试把server分割成两个群体，把当前leader放在少数群体。</p>
</li>
<li><p>Put(cfg, ckp2a, “1”, “15”)发到少数群体，是无法commit的，也就无法apply，client也就阻塞无法返回。<br>直到走到”Test: completion after heal (3A)”，恢复所有网络，p2的leader发的ae可以传到p1了，p1的leader发的ae也可以传到p2了，这时p1的leader的term一定是领先p2的，因为分割后p1没有leader，一定会选一个新的，term变大。<br>那么p2的leader一定会变成follwer。p2接收的Put命令会被p1的命令冲掉。kvserver应该返回wrongleader给client，client重新找leader发这个命令。<br>重点是kvserver执行命令等结果期间要能识别自己的命令被冲掉(因为自己的leader身份失效)。</p>
</li>
<li><p>Get()必须从多数群体中获取，否则可能获得失效的数据。<br>课程提示一个简单的方法。可以把Get也看作PutAppend，也走一遍一致性流程，这样肯定是从多数群体取值了。</p>
</li>
<li><p>一个死锁问题<br>LeaderSendAE里发ApplyMsg时我是先锁住rf然后进循环挨个检测index是否可以apply，有时会出现一次可以apply多个index的情况。<br>那么问题来了，循环里会往channel发消息，这样就带着锁到了一个kvserver的线程，这个线程里又会走到一个rf.GetState()的检测，GetState是要锁的。如果LeaderSendAE的第二个消息没发出去，就走到GetState()的话，就死锁了。<br>把ApplyMsg消息的发送挪到一个单独的goroutine，结构更好，耦合低，循环检测，每次循环加锁就行，解决问题。<br>其实lab2也是这么推荐的。</p>
</li>
<li><p>后话，挪到单独goroutine后，后来偶尔发现lab2的TestFigure8Unreliable2C居然过不了，能达成一致，但是很慢，耗了三分钟，测试程序最多给2分钟。而不挪出来只用40秒。<br>因为挪出来后，循环里要每次加锁，这样死循环争锁影响了性能。<br>还是改为最开始的方式，循环外面加锁，里面发消息。而接受消息的代码之前刚好做了优化，不连续发消息，而是设置kv的全局变量，另起goroutine来监控。所以不会死锁了。<br>注意死循环里看情况要加个sleep，否则会很卡。<br>最终形态就是死循环里每轮sleep10毫秒，争锁，然后循环发一波apply。<br>但是有个问题，在最坏的情况下，每一波只能apply一个命令的话，还是很耗时。当然如果每次来一个命令也说明命令不是很多。<br>一个很好的优化就是把多个apply打包一次发走。暂时跳过。</p>
</li>
<li><p>go test -race的问题<br>可以检测可能的race condition。比如有个变量某一处加了锁，另外一处没加，运行时如果出现篡改的可能，它就会检测出来报错。<br>是否有必要？比如有的地方我绝对有把握不会死锁。<br>如果统一加上锁肯定能避免一些难查的死锁。在lab2里试过，感觉有的地方略显啰嗦。特别是打印变量时，比较繁琐。</p>
</li>
</ul>
<h2 id="以下走进了死路"><a href="#以下走进了死路" class="headerlink" title="以下走进了死路"></a>以下走进了死路</h2><h5 id="TestManyPartitionsOneClient3A"><a href="#TestManyPartitionsOneClient3A" class="headerlink" title="TestManyPartitionsOneClient3A"></a>TestManyPartitionsOneClient3A</h5><ul>
<li><p>一个client。随机分组。<br>发现一个问题。如果client发了一个命令cmd1，leader1短暂变成follower，client返回准备重发cmd1，leader1这时又变成leader.<br>那么记过就是client认为只发了一个cmd1，但实际leader1上存了两个cmd1。<br>问题在于client被返回wrongleader时，第一个cmd1没有被删除。一般情况如果有leader2取代leader1，那么会把cmd1擦掉，没问题。<br>但如果leader1又做回leader，那么老的cmd1就会保留，出现重复。<br>可能的解法：<br>start会生成一个index，跟踪这个index，如果能apply，没问题。如果被擦除，返回wrongleader。其他情况都死等。期间不要自行检查leader。</p>
</li>
<li><p>这又会引出一个问题，一个命令可能会单纯被清掉而不是被覆盖(比如一个高term的leader1复活，发ae给leader2，leader2变成follower并且被清掉不同的命令)。<br>考虑上面说的情况：（ca为commit和apply。t1为term1。）</p>
</li>
</ul>
<p>|       |   1     |       2    |          3   |           4   |          5   |           6|<br>| — | — | — | — | — | — | — |  — | — | — |<br>|2 Leader1|   put’’0 ca |  x 0 0 y ca  |  x 0 1 y ca t1  | x 0 2 y t1|<br>|1 Leader2  | put’’0 ca  | x 0 0 y ca  |  x 0 1 y t1  |   t2|<br>|3    | …|<br>|4    | …|<br>|5   |  …|</p>
<ul>
<li><p>2先当leader，给2发一个命令，未复制成功时，被独立分割，1再当leader。<br>这时把1和2联通。1和2的身份都是leader。<br>2给1发AE会失败，因为term小。<br>1给2发AE会成功。因为1、2两点都通过。</p>
</li>
<li><p>问题是到底需不要把2的index4上的log删掉？<br>论文图2收AE的第3点。字面上是如果出现冲突要删掉冲突和之后的log。目前的实现是删掉。<br>如果把index4删掉，然后白等，就会导致index4没法apply。导致client卡死。因为按上面的等待index的实现，没考虑直接删除index4的情况。</p>
</li>
<li><p>如果不删，这时2会变成Follower，1继续做leader，虽然2比1多一个命令。<br>如果这时给1发命令。1会发ae把2的index4冲掉。<br>如果一直不发，那么2的index4的命令永远得不到返回，造成cleint卡死。那么这个情况按理要给这个client返回wrongleader吧。</p>
</li>
<li><p>想个办法，还是按删掉的实现来。<br>raft做个接口查询某个index上的命令。kvserver定时把正在等待的index查一遍，如果发现被删除，那么返回wrongleader。</p>
</li>
</ul>
<h4 id="按这个思路来，感觉问题越来越多，越来越复杂。是不是钻了牛角尖？"><a href="#按这个思路来，感觉问题越来越多，越来越复杂。是不是钻了牛角尖？" class="headerlink" title="按这个思路来，感觉问题越来越多，越来越复杂。是不是钻了牛角尖？"></a>按这个思路来，感觉问题越来越多，越来越复杂。是不是钻了牛角尖？</h4><ul>
<li>再从头理一遍client的交互。<br>client发命令，每个kvserver里起一个map判断重复，记录每个client的最高sn。<br>防止的是：实际commit但没有返回给client，比如rpc故障，client又把命令提交一遍。<br>这里有个问题，如果这时出了新的leader，client重新提交给新的leader，是否能防住？<br>如果是的话，那么是可以在kvserver里给等待命令设一个超时的，不死等index，而是返回让client重发命令。直接从源头解决了问题，不会造成client卡死了。<br>为什么重发命令给新leader可以判断重复？</li>
</ul>
<p>|     |             1   |  2  | 3  |4  |5  |  index|<br>| — | — | — | — | — | — | — |  — | — | — |<br>| —–&gt;0 Leader   | cmd1<br>|      1     |    cmd1|<br>|    2       |  cmd1|<br>|      3    |<br>|    4    |</p>
<ul>
<li>client先连0，成功复制到012，commit，这意味着cmd1在系统里是确定的，一定会执行，不会被清除。<br>当raft返回apply消息到kvserver时（这里简化为一定能成功返回apply消息），kvserver会记录cmd1的client和sn，这样后续就能判断重复了。<br>注意，发到0，但是012收apply消息时都会记录。这样后续再发到012时都能判断重复了。<br>下一个命令有没有可能发到3或4，不可能，因为34是少数，不管网络怎么分割，新leader一定是在012中产生。<br>也就是说只要命令得到成功复制，新的leader一定存了这个命令的唯一标识，一定可以判断出重复。<br>一个不爽的地方是重复的命令也会存到raft的log里，如果要做恢复数据等操作，还需要判断重复。</li>
</ul>
<ul>
<li>因为开始没有完全想清楚判断重复命令的细节，所以绕了弯路。<br>最后在kvserver等待index那加上超时返回wrongleader，让client重发。解决了重发问题。<br>过了partitions, one client和partitions, many clients这两个测试。</li>
</ul>
<h3 id="TestPersistOneClient3A"><a href="#TestPersistOneClient3A" class="headerlink" title="TestPersistOneClient3A"></a>TestPersistOneClient3A</h3><ul>
<li>从这开始，会重启kvserver。raft的log已经实现了持久化没问题，但kvserver也是有很多状态和数据的。<br>课程里好像没有直接提怎么恢复kvserver的数据。只在Part B开始时带了一句，As things stand now with your code, a rebooting server replays the complete Raft log in order to restore its state.<br>那么就从raft的log里恢复数据试试。<br>replay比想象的要容易，把rf的log跑一遍，同时更新命令sn信息，判断一下重复命令不要执行就行了。</li>
</ul>
<ul>
<li>到这里3A都通过了测试。跑一遍耗时4分钟。</li>
</ul>
<h3 id="go相关"><a href="#go相关" class="headerlink" title="go相关"></a>go相关</h3><ul>
<li><p>发AE时rpc传的arg参数在接收的地方变成了nil。<br>导致panic: runtime error: invalid memory address or nil pointer dereference<br>最后定位到labrpc.go的dispatch函数和value.go里的Elem()。<br>估计是新的命令类型造成。之前的命令是一个int没有问题。<br>我直接传的PutAppendArgs类型报错。后来用了server.go里他定义好的Op类型就不报错。搞不懂，用不同文件的类型会出这种错。<br>一堆reflect、value、type比较底层的东西，看不懂放弃。有恶心到。</p>
</li>
<li><p>简单情况下，channel如果没有人接收消息，发消息就会一直阻塞？</p>
</li>
<li><p>消息里放int64好像有时发不出去。不确定。</p>
</li>
<li><p>居然不能直接给map里的某个元素赋值</p>
</li>
</ul>
<hr>
<h1 id="3-log压缩"><a href="#3-log压缩" class="headerlink" title="3. log压缩"></a>3. log压缩</h1><h3 id="论文解读"><a href="#论文解读" class="headerlink" title="论文解读"></a>论文解读</h3><ul>
<li><p>log不能任其增长。如果量巨大，即占空间，replay也很耗时。<br>需要一个机制来把老的的log信息给挪走。</p>
</li>
<li><p>“快照”是一种最简单的压缩方式：<br>在某个时间点，当前系统的整个状态会存为一个快照并持久化备用，然后把这个时间点之前的log删除。</p>
</li>
<li><p>chubby和zookeeper都用到了快照。</p>
</li>
<li><p>作者又比较了一下其他的log压缩方法。结论是快照更简洁。</p>
</li>
<li><p>图12描述了raft的快照。<br>一个快照包含了最后的term和index，以及每个key的当前值(只保留最新的值，过程(log)丢弃)。</p>
</li>
<li><p>图13描述了具体算法。即“安装快照(IS)”rpc。<br>IS一定是leader发出。可分次发送（我们实际不实现），可作为一次心跳。</p>
</li>
</ul>
<h3 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h3><ol>
<li><p>kvserver每次收到正常apply的命令后需要检测一下raft的log大小，超出一定值就要发起存快照的操作。<br>把本地kv数据发给raft，raft删除被快照覆盖的log，再把快照和log持久化。<br>重要的原则是保持所有数据不丢，要么在快照里要么在log里，并已经持久化。</p>
</li>
<li><p>每个节点只保存一份快照。保存快照后，要记录快照最末log的index和term。</p>
</li>
<li><p>leader发AE时如果对端需要的index落在自己的快照里，给对端发自己的快照，即InstallSnapshot RPC。<br>否则正常发AE。</p>
</li>
<li><p>raft收到快照后判断有效性，再把快照发给自己的kvserver，kvserver拿到后直接覆盖本地kv数据。log和快照都要做好持久化。</p>
</li>
</ol>
<h3 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h3><ul>
<li>引入快照后，log的一些边界上的操作可能需要大范围改造，改得更通用、清晰，是一种进步。<br>改动后一定要保持lab2能通过测试。<br>可能需要折腾一番才能稳定下来。</li>
</ul>
<h3 id="一个错误场景"><a href="#一个错误场景" class="headerlink" title="一个错误场景"></a>一个错误场景</h3><ul>
<li><p>TestSnapshotRecoverManyClients3B报错。get出来的值是值比预期要短，是个旧的值。</p>
</li>
<li><p>原因：raft收到有效的快照后，把本地log清空，发给kvserver安装，但是没有持久化。<br>如果这时服务重启，这个raft节点选为leader，数据就丢失了，因为log删了，log持久化了，但快照却没持久化。违反了上述数据不能丢失的原则。</p>
</li>
</ul>
<h3 id="go相关-1"><a href="#go相关-1" class="headerlink" title="go相关"></a>go相关</h3><ul>
<li><p>go test -race的问题<br>出现一个经典的ab/ba死锁的情况。检测不出来。具体没懂。</p>
</li>
<li><p>channel的问题<br>循环阻塞读消息进行处理，里面加锁，容易死锁。可改成读出消息后进队列，再另起goroutine循环处理。</p>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/06/1976/" data-id="ckkfmdge900cfvkcgecsa9xyw" data-title="MIT 6.824 Distributed Systems 分布式系统课程系列3 Lab3-Fault-tolerant Key/Value Service" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1973" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/05/1973/" class="article-date">
  <time class="dt-published" datetime="2020-12-05T07:30:54.000Z" itemprop="datePublished">2020-12-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/05/1973/">合宙Air722UG开发板入门指南</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="合宙Air722UG开发板入门指南"><a href="#合宙Air722UG开发板入门指南" class="headerlink" title="合宙Air722UG开发板入门指南"></a>合宙Air722UG开发板入门指南</h1><p>Air722UG是合宙继Air724UG后又一款Cat.1模组，Air722UG是一款超小封装 LTE Cat.1 bis 模块，采用紫光展锐的UIS8910平台，支持 LTE 3GPP Rel.13 技术。未来物联网通信将转至Cat.1，此产品将是非常好的入门产品。</p>
<p>Air722UG 内置丰富的网络协议，集成多个工业标准接口，并支持多种驱动和软件功能（如Windows 7/8/8.1/10 ，Linux，Android等操作系统下的 USB 驱动等），极大地拓展了其在 M2M 领域的应用范围，如 CPE、路由器、数据卡、平板电脑、车载、安防以及工业级 PDA 等。Air722UG 支持TTS，支持SPI LCD，支持SPI Camera， 支持3*2 阵列键盘。支持多种开发方式，如USB上网、标准AT、Lua脚本二次开发等，并可提供专业且及时的在线技术支持。</p>
<h6 id="当然了，合宙模块最大优势不就是LUAT编程吗？贼香"><a href="#当然了，合宙模块最大优势不就是LUAT编程吗？贼香" class="headerlink" title="当然了，合宙模块最大优势不就是LUAT编程吗？贼香"></a>当然了，合宙模块最大优势不就是LUAT编程吗？贼香</h6><hr>
<h3 id="1、模块介绍"><a href="#1、模块介绍" class="headerlink" title="1、模块介绍"></a>1、模块介绍</h3><p>1 个 USB 2.0 高速接口（最高达 480Mbps）</p>
<p>1.8V/3.0V (U)SIM 卡接口</p>
<p>2个 NETLIGHT 接口 (NET_STATUS 和NET_MODE)</p>
<p>1路模拟语音输出</p>
<p>3个 UART 接口</p>
<p>1 个 SPI 接口</p>
<p>1 个 SPI LCD 接口</p>
<p>1 个 SPI Camera 接口</p>
<p>1 个 MMC 接口 PWRKEY（低电平有效）</p>
<p>支持3*2 阵列键盘</p>
<p>4个 ADC 接口</p>
<p>支持背光亮度控制</p>
<h3 id="2、开发板介绍"><a href="#2、开发板介绍" class="headerlink" title="2、开发板介绍"></a>2、开发板介绍</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205151609494_IMG_20201205_140117.jpg" alt="undefined" title="undefined"><br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205151630447_IMG_20201205_140128.jpg" alt="undefined" title="undefined"></p>
<p>Air722UG开发板（就是官方卖199那款）采用单sim卡单tf卡设计，IO丝印正反印刷。</p>
<p>开发板底部有两个microUSB设计，左侧标有USB的直连模组，可用于固件下载，软件调试，AT指令，数据传输，USB虚拟串口。（使用前需安装驱动，安装驱动教程在下面）</p>
<p>右侧标有UART字样的为串口调试，串口转接芯片为CH340N，可用于AT命令和数据传输，自适应波特率（赞）。</p>
<h3 id="3、模组引脚介绍"><a href="#3、模组引脚介绍" class="headerlink" title="3、模组引脚介绍"></a>3、模组引脚介绍</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205151712282_20201022163857914_Air722UG_%E7%AE%A1%E8%84%9A%E5%9B%BE.png" alt="undefined" title="undefined"></p>
<h2 id="初次使用教程"><a href="#初次使用教程" class="headerlink" title="初次使用教程"></a>初次使用教程</h2><h3 id="1、安装驱动"><a href="#1、安装驱动" class="headerlink" title="1、安装驱动"></a>1、安装驱动</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205151754750_QQ%E6%88%AA%E5%9B%BE20201205142233.png" alt="undefined" title="undefined"></p>
<p>在合宙官网可以下载驱动 <a target="_blank" rel="noopener" href="http://www.openluat.com/product_center/product_detail?id=40">链接</a></p>
<p>下载后解压</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205151824581_QQ%E6%88%AA%E5%9B%BE20201205142353.png" alt="undefined" title="undefined"><br>win10系统进入第一个文件夹，win7/8系统进入第二个文件夹</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205151833028_QQ%E6%88%AA%E5%9B%BE20201205142432.png" alt="undefined" title="undefined"></p>
<p>32位系统执行安装DPInst32.exe</p>
<p>64位系统执行安装DPInst64.exe</p>
<p>之后就按下一步执行安装就好了，安装完成后建议重启下在执行下面的操作。</p>
<h3 id="2、软件准备"><a href="#2、软件准备" class="headerlink" title="2、软件准备"></a>2、软件准备</h3><p>这里需要准备下载调试工具，合宙官方已经提供了。<a target="_blank" rel="noopener" href="http://www.openluat.com/product_center/product_detail?id=40">链接直达</a><br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152038264_QQ%E6%88%AA%E5%9B%BE20201205142625.png" alt="undefined" title="undefined"></p>
<p>Luatool V2工具，是一款极其强大的调试下载工具。</p>
<p>首次打开前请新建一个文件夹，并把下载的exe放到文件夹里面（注意：建议文件夹路径里面不要包含中文，以免造成麻烦），首次打开会进行更新和下载必要文件，耗时可能较长建议耐心等待。</p>
<p>下面是我下载完后的样子</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152057836_QQ%E6%88%AA%E5%9B%BE20201205143013.png" alt="undefined" title="undefined"><br>之后使用时直接打开Luatools_v2.exe即可使用。</p>
<p>以下是工具打开的样子<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152127500_QQ%E6%88%AA%E5%9B%BE20201205143136.png" alt="undefined" title="undefined"></p>
<h3 id="3、初次使用"><a href="#3、初次使用" class="headerlink" title="3、初次使用"></a>3、初次使用</h3><p>使用microUSB线连接电脑，插入USB丝印的端口即可（若供电不足可用另一根线插入uart，同时插入电脑usb端口）</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201206205123194_1607258655032.png" alt="undefined" title="undefined"></p>
<p>连接上电脑后 打开电脑的设备管理器，正常会有几个设备出现（端口号是随机的）<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152245942_QQ%E6%88%AA%E5%9B%BE20201205143746.png" alt="undefined" title="undefined"><br>出现以上几个设备证明驱动安装成功，开发板和电脑已经建立通信，默认的出厂固件是AT固件，现在我们去打开luatools工具，勾选上4G模块USB打印，此时软件就会自动建立通信。<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152317067_QQ%E6%88%AA%E5%9B%BE20201205144206.png" alt="undefined" title="undefined"><br>显示这样就证明第一次上电就完成了。</p>
<h6 id="接下来我们进入进阶部分。"><a href="#接下来我们进入进阶部分。" class="headerlink" title="接下来我们进入进阶部分。"></a>接下来我们进入进阶部分。</h6><h3 id="4、下载固件"><a href="#4、下载固件" class="headerlink" title="4、下载固件"></a>4、下载固件</h3><p>现在来用luatools下载固件</p>
<p>首先我们需要下载到air722ug的配套固件，还是去合宙官网下载。<a target="_blank" rel="noopener" href="http://www.openluat.com/product_center/product_detail?id=40">链接直达</a><br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152514229_QQ%E6%88%AA%E5%9B%BE20201205144729.png" alt="undefined" title="undefined"><br>第一个是Luat编程用的，第二个是AT用的，根据个人需求下载。</p>
<p>下载完成后解压<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152543825_QQ%E6%88%AA%E5%9B%BE20201205144839.png" alt="undefined" title="undefined"><br>这个是AT固件解压后的样子，pac文件就是要下载的固件<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152557180_QQ%E6%88%AA%E5%9B%BE20201205144938.png" alt="undefined" title="undefined"><br>这个是Luat固件解压后的样子，无后缀的是普通固件 ，后置float的支持浮点，后置tts的支持语音，根据需求刷写即可，不同版本占用内存不同。</p>
<h6 id="开始下载"><a href="#开始下载" class="headerlink" title="开始下载"></a>开始下载</h6><p>点击luatools里面的下载固件按钮<img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152632776_QQ%E6%88%AA%E5%9B%BE20201205145151.png" alt="undefined" title="undefined"><br>在这里点击“选择文件”，选择你要刷写的pac文件。<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152726219_QQ%E6%88%AA%E5%9B%BE20201205145228.png" alt="undefined" title="undefined"><br>选择完点击下载即可，正常情况下板子会自动进入下载模式，等待一会就会显示下载成功。</p>
<p>如果板子出错，可使用usb boot下载，具体操作如下</p>
<p>按住板子右下的boot按钮，然后上电，这时设备管理器中会显示一个新的端口<img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152754896_QQ%E6%88%AA%E5%9B%BE20201205145542.png" alt="undefined" title="undefined"><br>之后进入luatools里面的下载固件功能，</p>
<p>勾选上USB BOOT下载<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152813740_QQ%E6%88%AA%E5%9B%BE20201205145626.png" alt="undefined" title="undefined"><br>点击下载即可刷入固件<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152829515_QQ%E6%88%AA%E5%9B%BE20201205145843.png" alt="undefined" title="undefined"></p>
<p>下载成功后板子自动重启。</p>
<h3 id="5、Luat项目测试"><a href="#5、Luat项目测试" class="headerlink" title="5、Luat项目测试"></a>5、Luat项目测试</h3><p>合宙模块最突出的优点就是luat编程（真的很香）</p>
<p>进行luat编程前要先刷入luat固件，前面讲了。</p>
<p>然后准备官方demo，这些demo非常的好用，CV工程师必备demo。（此处来个滑稽）</p>
<p>官方demo在luat固件下载页面可以找到。<img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152852242_QQ%E6%88%AA%E5%9B%BE20201205150206.png" alt="undefined" title="undefined"><br>就是这个luatask。。。<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152903731_QQ%E6%88%AA%E5%9B%BE20201205150241.png" alt="undefined" title="undefined"><br>demo里面就是官方的示例</p>
<p>doc是文档存放处</p>
<p>lib是官方库，编写程序时需要调用</p>
<h6 id="现在-来输入一个demo试试效果"><a href="#现在-来输入一个demo试试效果" class="headerlink" title="现在 来输入一个demo试试效果"></a>现在 来输入一个demo试试效果</h6><p>打开luatools工具<img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152924495_QQ%E6%88%AA%E5%9B%BE20201205150406.png" alt="undefined" title="undefined"><br>点击这个功能按钮<br>进行如下的初步设置<img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205152946503_QQ%E6%88%AA%E5%9B%BE20201205150620.png" alt="undefined" title="undefined"><br>因为luatools自带了lib，如果你只用了官方的lib就不需要再加入，只需勾选添加默认lib即可。（luac加密那个不用勾选，我之前测试的时候不小心选上的）</p>
<p>设置完之后即可点击下载脚本，进度条走完程序就成功刷入到了板子内部。<img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201205153003661_QQ%E6%88%AA%E5%9B%BE20201205150930.png" alt="undefined" title="undefined"><br>emo效果就是这样了。</p>
<hr>
<h4 id="至此呢，初步教程就结束了，接下来就是根据个人需求写写程序刷入就好了，第一次写文字教程，经验不足，如有错误请指出来，我定会改正，谢谢大家"><a href="#至此呢，初步教程就结束了，接下来就是根据个人需求写写程序刷入就好了，第一次写文字教程，经验不足，如有错误请指出来，我定会改正，谢谢大家" class="headerlink" title="至此呢，初步教程就结束了，接下来就是根据个人需求写写程序刷入就好了，第一次写文字教程，经验不足，如有错误请指出来，我定会改正，谢谢大家"></a>至此呢，初步教程就结束了，接下来就是根据个人需求写写程序刷入就好了，第一次写文字教程，经验不足，如有错误请指出来，我定会改正，谢谢大家</h4><hr>
<p>​                                                                                                                                                                梦程MI<br>                                                                                                                                                 2020.12.05</p>
<p>bilibili:梦程MI<br><a target="_blank" rel="noopener" href="https://www.dreamcstudio.cn/" title="我的博客">我的博客</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/05/1973/" data-id="ckkfmdga6002fvkcg79at9wbc" data-title="合宙Air722UG开发板入门指南" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1966" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/04/1966/" class="article-date">
  <time class="dt-published" datetime="2020-12-04T03:38:22.000Z" itemprop="datePublished">2020-12-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/04/1966/">mpu6xxx驱动（包括mpu6050，mpu6500，mpu9250，icm20608G，icm20608D）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>mpu6xxx驱动（包括mpu6050，mpu6500，mpu9250，icm20608G，icm20608D）</p><p><span style="color:#6a9955">自动判断器件id，只需要配置i2c id就可以</span></p><p>测试mpu6050,其他请自行测试，如测试有问题可反馈也可自行修改，改动不会很大</p><p><a href="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/attachment/20201224085131190_mpu6xxx.lua" target="_blank">mpu6xxx.lua</a></p><p><span style="font-size:30px"><strong>此驱动已加入官方I2C demo，以后将在官方demo更新，如有问题可在此反馈</strong></span></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/04/1966/" data-id="ckkfmdga6002evkcg5219f22a" data-title="mpu6xxx驱动（包括mpu6050，mpu6500，mpu9250，icm20608G，icm20608D）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1956" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/02/1956/" class="article-date">
  <time class="dt-published" datetime="2020-12-02T03:54:48.000Z" itemprop="datePublished">2020-12-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/02/1956/">Air720UG/UH 4G LTE 开发板使用说明V1.1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 style="text-align:start;" size="0" _root="undefined" __ownerid="undefined" __hash="undefined" __altered="false"><strong><span style="font-size:40px"><span style="color:#000000">一、概述</span></span></strong></h1><hr/><p></p><h2><strong><span style="font-size:24px"><span style="color:#000000">1、产品描述</span></span></strong></h2><p></p><p></p><p style="text-indent:2em;"><span style="color:#000000"><span style="background-color:#ffffff"><span style="font-size:16px"><span style="line-height:1.5">Air720U 4G LTE 通信模块（以下简称为Air720U模块），是上海合宙通信科技有限公司新近推出的 LTE Cat.1 通信模块。它采用紫光展锐的UIS8910平台，支持LTE 3GPP Rel.13技术。</span></span></span></span></p><p style="text-indent:2em;"><span style="color:#000000"><span style="background-color:#ffffff"><span style="font-size:16px"><span style="line-height:1.5">Air720U 内置丰富的网络协议，集成多个工业标准接口，并支持多种驱动和软件功能（如Windows XP，Windows Vista，Windows 7/8/8.1/10，Linux，Android等操作系统下的USB驱动等），同时支持VOLTE，支持SPI LCD，支持多种开发方式，如USB上网、标准AT、Lua脚本二次开发等，并可提供专业且及时的在线技术支持，极大地拓展了其在 M2M 领域的应用范围，轻松实现如CPE、路由器、数据卡、平板电脑、车载、安防以及工业级 PDA等等应用。</span></span></span></span></p><h2><span style="background-color:#ffffff"><span style="line-height:1.5"><strong><span style="font-size:24px"><span style="color:#000000">2、主要优势</span></span></strong></span></span></h2><p></p><p><span style="color:#000000">l 全面支持中国移动的网络制式 </span><br/> <br/><span style="color:#000000">l 紧凑尺寸的SMT 封装形式满足小型终端产品对空间的需求 </span><br/> <br/><span style="color:#000000">l 轻松实现2G与4G网络之间的无缝切换 </span><br/> <br/><span style="color:#000000">l 支持 AT 与 Lua 二次开发，与 Air 系列模块一脉相承</span></p><h2><span style="font-size:24px"><strong>3、订购方式 </strong></span></h2><p></p><p>开发者可以通过官方店铺购买，或者联系我司的商务合作代表进行订购。</p><p><strong><span style="letter-spacing:2px"><span style="color:#07a9fe">官方链接：</span></span></strong><a href="https://item.taobao.com/item.htm?spm=a1z10.3-c-s.w4002-23305172767.36.56c91068pZnc3u&amp;id=614653714883" target="">https://item.taobao.com/item.htm?spm=a1z10.3-c-s.w4002-23305172767.36.56c91068pZnc3u&amp;id=614653714883</a></p><h1><span style="font-size:40px"><strong>二、初识开发板</strong></span></h1><hr/><ol><li><span style="letter-spacing:2px"><span style="color:#000000">开发板拥有两个MicroUSB插口，分别是“USB口” 和“UART口”。通过他们，开发者可以轻松实现供电、Trace输出、软件下载、AT命令等需求。 </span></span></li><li><span style="letter-spacing:2px"><span style="color:#000000">USB口通过开发板与模块USB引脚（USB_VBUS,USB_DM,USB_DP,GND）连接。 </span></span></li><li><span style="letter-spacing:2px"><span style="color:#000000">UART口通过开发板上的USB-TO-UART转换芯片与模块UART（即普通UART）引脚或调试UART（即DBG_UART）引脚连接。至于是普通UART口还是调试UART口，通过开发板上UART切换开关来控制(开发板上UART1是普通UART口，UART2是调试UART口)。 </span></span></li><li><span style="letter-spacing:2px"><span style="color:#000000">下载固件使用的是: SPRD U2S Diag ； </span></span></li><li><span style="letter-spacing:2px"><span style="color:#000000">Trace打印口是：LUAT USB Device 0 Modem 或DBG_UART（开发板上为UART2）； </span></span></li><li><span style="color:#000000"><span style="letter-spacing:2px">AT口是：LUAT USB Device 1 AT或 普通UART口（开发板上为UART1）。开发者可以根据自己的情况来选择或组合。比如，可以选UART1发AT，0 Modem口打印trace；或者USB AT口发AT，UART1打印trace。 </span></span><br/><span style="color:#000000"><span style="letter-spacing:2px"> 开发者应选择质量较好的MicroUSB线连接电脑和开发板。两个USB接口均可独立供电，开发者使用的时候可以选择其一，或者两者都接上。</span></span></li></ol><p></p><div class="media-wrap image-wrap"><img class="media-wrap image-wrap" src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201202112901505_1606878699(1).png"/></div><p></p><p>MicorUSB接口和LED等作用如下：</p><p></p><p></p><table border="1" style="border-collapse: collapse"><tr><td colSpan="1" rowSpan="1">接口类型</td><td colSpan="1" rowSpan="1">作用</td><td colSpan="1" rowSpan="1">备注</td></tr><tr><td colSpan="1" rowSpan="1">UART1</td><td colSpan="1" rowSpan="1">用来和模块进行AT指令通讯</td><td colSpan="1" rowSpan="1">支持自适应波特率，范围9600bps到115200bps</td></tr><tr><td colSpan="1" rowSpan="1">UART2</td><td colSpan="1" rowSpan="1">用来下载软件和射频校准</td><td colSpan="1" rowSpan="1">UART2 还用来和内部的蓝牙进行通讯，如果用到了蓝牙功能，则UART2 不可用作其他用途</td></tr><tr><td colSpan="1" rowSpan="1">USB口</td><td colSpan="1" rowSpan="1">可虚拟出DIAG/AT/MODEM/PPP四个口</td><td colSpan="1" rowSpan="1">AT口发送AT，DIAG口下载固件和打印trace</td></tr><tr><td colSpan="1" rowSpan="1">供电开关</td><td colSpan="1" rowSpan="1">控制模块是否上电</td><td colSpan="1" rowSpan="1"></td></tr><tr><td colSpan="1" rowSpan="1">PWR_LED</td><td colSpan="1" rowSpan="1">电源指示灯。模块上电开机后常亮。</td><td colSpan="1" rowSpan="1">可通过软件控制</td></tr><tr><td colSpan="1" rowSpan="1">NET_LED</td><td colSpan="1" rowSpan="1">网络连接状态指示灯</td><td colSpan="1" rowSpan="1">lua版本由Lua脚本控制；AT版本由版本自动控制</td></tr><tr><td colSpan="1" rowSpan="1">LTE_LED</td><td colSpan="1" rowSpan="1">LTE指示灯，工作在LTE模式的时候亮起</td><td colSpan="1" rowSpan="1">lua版本由Lua脚本控制；AT版本由版本自动控制</td></tr></table><p>其中，NET_LED闪烁规律如下：</p><p></p><p></p><table border="1" style="border-collapse: collapse"><tr><td colSpan="1" rowSpan="1">模式</td><td colSpan="1" rowSpan="1">闪烁情况</td><td colSpan="1" rowSpan="1">占空比</td></tr><tr><td colSpan="1" rowSpan="1">NULL</td><td colSpan="1" rowSpan="1">常灭</td><td colSpan="1" rowSpan="1">0%</td></tr><tr><td colSpan="1" rowSpan="1">飞行模式</td><td colSpan="1" rowSpan="1">常灭</td><td colSpan="1" rowSpan="1">0%</td></tr><tr><td colSpan="1" rowSpan="1">SIM卡异常</td><td colSpan="1" rowSpan="1">每6s闪烁一次</td><td colSpan="1" rowSpan="1">5%</td></tr><tr><td colSpan="1" rowSpan="1">空闲状态</td><td colSpan="1" rowSpan="1">每4s闪烁一次</td><td colSpan="1" rowSpan="1">7.5%</td></tr><tr><td colSpan="1" rowSpan="1">获取到运营商信息</td><td colSpan="1" rowSpan="1">每2s闪烁一次</td><td colSpan="1" rowSpan="1">15%</td></tr><tr><td colSpan="1" rowSpan="1">PDP激活</td><td colSpan="1" rowSpan="1">每1s闪烁一次</td><td colSpan="1" rowSpan="1">30%</td></tr><tr><td colSpan="1" rowSpan="1">已连接到服务器</td><td colSpan="1" rowSpan="1">每1s闪烁五次</td><td colSpan="1" rowSpan="1">50%</td></tr></table><h1 style="text-align:start;" size="0" _root="undefined" __ownerid="undefined" __hash="undefined" __altered="false"><strong><span style="font-size:40px">三、开发准备</span></strong></h1><hr/><p></p><p style="text-indent:2em;">在Windows平台对Air720U模块进行二次开发，首先要下载并安装模块开发板的USB驱动程序和串口驱动， 然后使用《Luatools下载调试工具》进行底层core以及Lua代码的下载、调试。<br/><br/>用户一般有两种开发方式，一种是经典的AT命令+MCU方式，一种是我司特有的lua脚本方式。</p><p style="text-indent:2em;"><strong>1.AT命令+MCU方式：</strong></p><p>这种情况，只需要给模块下载AT命令版本的底层软件（.blf）即可。所用的下载工具是Luatools。</p><p style="text-indent:2em;"><strong>2.lua脚本开发方式：</strong></p><p style="text-align:start;text-indent:2em;" class="MsoNormal"><span style="line-height:1.5">这种方式下，在模块内部，通过对AT命令的封装实现了各种API，然后我司提供各种demo通过API的调用实现各种功能。用户通过对demo的修改即可完成开发。这种开发形式实现了将MCU代码功能放到无线模块中去实现，省掉了一个MCU。</span></p><p style="text-align:start;text-indent:2em;" class="MsoNormal"><span style="line-height:1.5">这种开发方式下不仅需要下载模块底层软件，还需要下载上层软件，即lua脚本（Demo+lib）。下载底层软件和上层软件的工具也是Luatools。 这个工具的使用在第四章会有详细的讲解。</span></p><h1><span style="line-height:1.5"><strong><span style="font-size:40px">四、环境配置</span></strong></span></h1><hr/><p></p><h2 style="text-align:start;" size="0" _root="undefined" __ownerid="undefined" __hash="undefined" __altered="false"><strong>1、下载USB驱动</strong></h2><p>USB驱动下载：<a href="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/attachment/20200808183454135_sw_file_20200303181718_8910_module_usb_driver_signed%20_20200303_hezhou.7z" target="">http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/attachment/20200808183454135_sw_file_20200303181718_8910_module_usb_driver_signed%20_20200303_hezhou.7z</a></p><h2><strong>2、安装USB驱动</strong></h2><p>USB驱动文件解压后，根据自己电脑的系统选择WIN7/8或者WIN10，选择对应的安装程序运行，进行安装。32位操作系统请运行DPInst32.exe，64位操作系统请运行DPInst64.exe：</p><p></p><div class="media-wrap image-wrap"><img class="media-wrap image-wrap" src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201202140630780_1606889156(1).png"/></div><p>按提示点击“下一步”，安装成功。</p><p></p><div class="media-wrap image-wrap"><img class="media-wrap image-wrap" src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201202141219209_1606889307(1).png"/></div><h2><strong>3、下载LuaTools下载调试工具</strong></h2><p><span style="color:#07a9fe"><strong>下载地址：</strong></span></p><p><a href="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/attachment/20200808182655634_Luatools_v2.exe" target="">http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/attachment/20200808182655634_Luatools_v2.exe</a></p><p></p><p>解压后无需安装，直接运行LuaTools.exe即可：</p><p></p><div class="media-wrap image-wrap"><img class="media-wrap image-wrap" src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201202141459743_1606889683(1).png"/></div><h2><strong>4、下载底层软件（和例程代码）</strong></h2><p><a href="http://doc.openluat.com/article/1334/0" target="">http://doc.openluat.com/article/1334/0</a></p><p></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/02/1956/" data-id="ckkfmdga5002dvkcghczb5txi" data-title="Air720UG/UH 4G LTE 开发板使用说明V1.1" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-1931" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/11/30/1931/" class="article-date">
  <time class="dt-published" datetime="2020-11-30T12:11:13.000Z" itemprop="datePublished">2020-11-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/11/30/1931/">二读非暴力沟通</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="二读非暴力沟通"><a href="#二读非暴力沟通" class="headerlink" title="二读非暴力沟通"></a>二读非暴力沟通</h1><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>第一次读完这本书有个感性的思考，任务这本书可以解决所有问题，但是实际运用中发现发现许多难以运用的地方，所以我又进行第二次阅读</p>
<h2 id="本书的目的"><a href="#本书的目的" class="headerlink" title="本书的目的"></a>本书的目的</h2><p>本书主要是未了解决，静态语言和动态世界的不匹配，我们的沟通多数以静态语言表述自己的需要。由于我们的语言先天就是为了标识常态事务和终极解决方法，所以沟通过程种有很大一部分是以评论，命令以及批评表述的,但这种方式只适合奴隶社会和封建社会这种上下级不可突破的时代。由于我们当今的社会是民主的社会，如果还是用这种方式沟通，肯定会引起对方反驳，或者心里上的排斥。本书给出解决沟通问题的方法是 观察 -&gt; 感受  -&gt;需要 -&gt; 请求 。试图以这种方式来模拟动态的过程，来达到让对方满足自己的需求。下面围绕这四点来谈谈我的理解。</p>
<h2 id="分析本书"><a href="#分析本书" class="headerlink" title="分析本书"></a>分析本书</h2><ul>
<li><p>观察<br>作用的对象可以用于别人也可以作用于自己的内心，观察的重点在于区分观察和评论。“不带评论的观察是人类智力的最高形式”，因为评论往往带有自己的价值观，所以以评论的方式和对方沟通，对方往往因为价值观不同而进行本能的反对。对自己内心的观察可以明确自己的感受和想法。</p>
</li>
<li><p>感受<br>感受同样也分为感受别人和感受自己。我认为本书鼓励先自己感受自己，“你越是留意自己的内心的声音，就能够听到别人的声音”，这句话很是暗合我们的 “己所不欲勿施于人”，只有先了解自己的感受才能理解他人的感受，遇到挫折和困难的时候，充分体验人生的渴望，有助于自己成长。另外在沟通中表达自己的感受可以让沟通更为顺畅，适当的示弱有助于解决问题。此外，我们在表达感受的时候要区分感觉和想法，想法往往不会引起共鸣的。</p>
</li>
<li><p>需要<br>感受其实是服务于自己的需求，对方的批评其实是暗含着他的期待。我们不要因为对方的批评感到生气，而是要了解对方的需要，从而判断自己是否接受对方的需要。</p>
</li>
<li><p>请求<br>请求的目的是希望完成自己的需要而提出的解决方案，因此要格外注意不要抽象化，并且要和对方确认自己的请求是否理解。这个请求是在善意不带有惩罚含义的情况下才能起作用(我对这点存疑，实际安排工作的时候多少还是需要带有点惩罚成分)。</p>
</li>
</ul>
<h2 id="后记"><a href="#后记" class="headerlink" title="后记"></a>后记</h2><p>本书的第九章(爱自己)到第十四章(表达感激)主要说的是自己内心的建设，我认为只有自己内心的强大和平和才能将“非暴力沟通”的方法发挥到极致。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/11/30/1931/" data-id="ckkfmdga5002cvkcgdoxugxwh" data-title="二读非暴力沟通" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/7/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="page-number" href="/page/7/">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/9/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>