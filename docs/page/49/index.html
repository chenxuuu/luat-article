<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:type" content="website">
<meta property="og:title" content="Luat doc 社区文章静态页面镜像">
<meta property="og:url" content="https://doc.luatos.wiki/page/49/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-495" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/07/495/" class="article-date">
  <time class="dt-published" datetime="2018-11-07T09:48:23.000Z" itemprop="datePublished">2018-11-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/07/495/">Air 602 USB 模组部分 Mac os 驱动问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>对于window10&nbsp;和部分mac来说，<span style="font-family: &quot;Lucida Grande&quot;, &quot;Trebuchet MS&quot;, Verdana, Helvetica, Arial, sans-serif; font-size: 13px;">Air602 WiFi&nbsp;开发板是免驱的，插上电脑直接串口可以识别。</span></p><p>然而，我们发现部分版本的 mac os&nbsp;无法直接识别到这个开发板，如果无法识别，您检查设备管理器的时候可能会看到如下图所示的结果：</p><p><br></p><p><img src="https://github.com/SeeedDocument/Air602_WiFi_Module/raw/master/img/device_mana.jpg" style="width: 698px;"></p><p><br></p><p>如果是这样的话，您也许需要手动安装 CH340 的驱动，这个开发板使用的是 CH330N，&nbsp;它是兼容CH340驱动的。</p><p>请点击下面的链接查看驱动安装详情：</p><p><a href="https://github.com/MPParsley/ch340g-ch34g-ch34x-mac-os-x-driver" target="_blank">ch340g-ch34g-ch34x-mac-os-x-driver</a></p><p><br></p><p>成功后，您将看到如下结果：</p><p><img src="https://github.com/SeeedDocument/Air602_WiFi_Module/raw/master/img/well.jpg" style="width: 530px;"><br></p><p><br></p><p>好了，现在您的mac可以识别到这个模块了，enjoy :D</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/11/07/495/" data-id="ckkfmdgbo006fvkcg1aam9pac" data-title="Air 602 USB 模组部分 Mac os 驱动问题" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-494" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/07/494/" class="article-date">
  <time class="dt-published" datetime="2018-11-07T03:44:54.000Z" itemprop="datePublished">2018-11-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/07/494/">ILI9341的横竖屏切换，以及ST7735屏幕旋转</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;&lt;img src=&quot;http://oldask.openluat.com/image/show/attachments-2018-11-U8oWIWRM5bfbc527da67b.png&quot; class=&quot;img-responsive&quot; style=&quot;width: 331.5px;&quot;&gt;&lt;/p&gt;&lt;p&gt;ILI9341的横竖屏切换&lt;/p&gt;&lt;p&gt;下面是7735的：&lt;/p&gt;&lt;p&gt;&lt;img src=&quot;http://oldask.openluat.com/image/show/attachments-2018-11-RYeSIubN5be25eec4138b.png&quot; class=&quot;img-responsive&quot; style=&quot;width: 330.5px;&quot;&gt;在初始化文件中找到图示位置，前一个是命令36后一个是命令E0。修改中间的数据，分别是C0/AO/00/60,对应着每次90度的翻转，找到合适自己的显示方向。&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/11/07/494/" data-id="ckkfmdgbn006evkcgh59g00q6" data-title="ILI9341的横竖屏切换，以及ST7735屏幕旋转" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-493" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/11/02/493/" class="article-date">
  <time class="dt-published" datetime="2018-11-02T04:38:46.000Z" itemprop="datePublished">2018-11-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/11/02/493/">记一例Air2xx无法下载的解决方法</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>#前置</p>
<p>通常，无法下载/下载失败，是由以下原因造成的：</p>
<ol>
<li>模块没有开机（应测量vddio电压是否为2.8v）；</li>
<li>串口线波特率不支持921600；</li>
<li>串口线接线错误（应tx-rx，rx-tx接线）；</li>
<li>串口线和模块没有共地；</li>
<li>串口线的驱动存在异常；</li>
<li>模块供电不稳，导致运行失稳；</li>
<li>电脑u口带宽不足；</li>
<li>模块损坏。</li>
</ol>
<p>#病例</p>
<p>客户反应无法下载。经过排查：</p>
<ul>
<li>串口线是ft232芯片，稳定支持921600；</li>
<li>已经共地，且接线正确；</li>
<li>驱动完好，其他开发板可以正常下载、调试；</li>
<li>供电正常，几乎没有跌落；</li>
<li>模块已经正常开机，vddio为2.8v。</li>
</ul>
<p>经过上述排查，认为基本情况正常。初步怀疑可能是模块局部损坏，导致能正常开机，但是无法下载。让客户测量host_uart tx/rx电压均为2.8v，属于正常值。</p>
<p>常见的可能性和排除方法，都试了，一筹莫展。</p>
<p>#灵机一动</p>
<p>忽然想到，有没有可能是焊接问题导致的通信异常呢？遂让客户进行排查：</p>
<ul>
<li>host_uart_tx —&gt;  插针</li>
<li>host_uart_rx —&gt;  插针</li>
<li>host_uart_tx —&gt; host_uart_rx</li>
<li>其他针脚</li>
</ul>
<p>通过这个方式，判断是否贴片时，某些针脚短路导致无法下载。经过客户确认，发现vddio和host_uart_rx短路：</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_38875.png"></p>
<p>排除短路后，可以正常下载：</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_12937.png"></p>
<p>由于vddio和host_uart_rx都是2.8v，所以测量电压时，没有及时发现这个问题，但是下载时，会导致通信异常，导致下载失败。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/11/02/493/" data-id="ckkfmdgbn006dvkcg5050gs4m" data-title="记一例Air2xx无法下载的解决方法" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-492" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/30/492/" class="article-date">
  <time class="dt-published" datetime="2018-10-30T10:44:02.000Z" itemprop="datePublished">2018-10-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/30/492/">【AT】MQTT发布JSON出错的应对策略</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>开发者使用AT进行开发时，发布如下的json时，经常会出现ERROR：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">→ AT+MPUB=<span class="string">&quot;data&quot;</span>,<span class="number">0</span>,<span class="number">0</span>,“&#123;“test”:<span class="number">1</span>&#125;”</span><br><span class="line">← ERROR</span><br></pre></td></tr></table></figure>
<p>那么为什么出现这个问题呢？实际上时因为payload的双引号有误导致的。一般，写代码时，遇到这种情况，我们都使用如下方式规避：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; a = <span class="string">&quot;abc&quot;</span>..<span class="string">&quot;cef\&quot;ghi\&quot;jkl&quot;</span></span><br><span class="line">&gt; <span class="built_in">print</span>(a)</span><br><span class="line">abccef<span class="string">&quot;ghi&quot;</span>jkl</span><br></pre></td></tr></table></figure>
<p>#但是，AT开发怎么办呢？<br>同样的，我们也应该转义——使用<strong>\22</strong>代替所有payload的<strong>双引号</strong>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">→ AT+MPUB&#x3D;&quot;data&quot;,0,0,“&#123;\22test\22:1&#125;”</span><br></pre></td></tr></table></figure>
<br>
<br>
有的开发者可能不太理解，为什么是\22呢？实际上很简单啦，十六进制hex转十进制是34，ascii表中，34对应的就是双引号啦。

<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="built_in">print</span>(<span class="built_in">tonumber</span>(<span class="string">&quot;22&quot;</span>, <span class="number">16</span>))</span><br><span class="line"><span class="number">34</span></span><br><span class="line">&gt; <span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">char</span>(<span class="number">34</span>))</span><br><span class="line"><span class="string">&quot;</span></span><br></pre></td></tr></table></figure>
<p>#问题又来了，单片机端C代码中如何生成\22呢？<br>如果使用字符串，字符串内对\也需要转义处理，例如”\\22”才表示\22三个字节的字符串。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/30/492/" data-id="ckkfmdgbn006cvkcgflbwhi9j" data-title="【AT】MQTT发布JSON出错的应对策略" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-491" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/30/491/" class="article-date">
  <time class="dt-published" datetime="2018-10-29T23:18:32.000Z" itemprop="datePublished">2018-10-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/30/491/">那些年，我们用过的2G</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_77268.jpg"></p>
<p>毫无疑问，5G在今天是越来越热了。各种关于它的话题不断飞舞，炒作与实锤接连爆出。</p>
<p>如果此时我们想要感受一下什么叫“只见新人笑，不见旧人哭”，那最好的办法就是去看看5G的老前辈，差不多我们所有人都朝夕相伴过的2G……</p>
<p>是不是觉得这个词已经非常遥远？仔细一回忆，什么QQ秀啊、上网冲浪啊之类的词都涌上心头了？是不是预感本文即将开始回忆青春，探讨一下移动通讯的上古历史？</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_50980.jpeg"></p>
<p>有意思的地方恰恰在于，2G网络这个好像已经尘封在历史角落里的技术和服务，今天其实并没有过去。它此刻就在你的手机里，基本已经没什么用了，说不定还要给你找点麻烦，但真想让它彻底消失，似乎还不太容易。</p>
<p>可以说，今天每个手机用户，运营商和手机厂商，甚至正在跃跃欲试等待上场的5G时代，都依旧生活在2G的阴影下。</p>
<p>让我们来解释一下“食之无味，弃之可惜”的2G。</p>
<p>#危险的2G网络</p>
<p>可以肯定地说，除了始作俑者之外，没有一个中国人是不恨电信诈骗的。但是按道理讲，现在电话都实名制了，发现一个揪出来打掉不就行了吗？</p>
<p>然而事实上，我们收到的各种诈骗短信，都来自一些诡异的号码。甚至很多人都收到过运营商客服、银行客服、航空公司号码发来的诈骗短信，让人防不胜防。这一类短信绝大部分都来自同样的技术：<strong>伪基站</strong>。</p>
<p>据统计，中国每天要产生超过400万条伪基站短信，可以说伪基站是电信诈骗网络中的绝对主力。而伪基站之所以屡禁不止，很大程度上“归功”于2G网络这个温床。</p>
<p>在2G网络中，GSM只有单向鉴权加密，手机本身无法确认网络的合法性。这个天然的技术漏洞，导致2G网络下的手机无法抵御伪基站攻击，2G时代也就变成了移动互联网历史上最不安全的时代。</p>
<p>那么现在大家都4G了，2G网络的不安全不就无所谓了吗？</p>
<p>可惜并没有，由于2G网络本身并没有消失，所以不法份子可以通过网络干扰来诱使用户的手机回落到2G网络环境里，然后触发已经建立好，手机又无法识别的2G伪基站。轻辙可以借此向用户发一些”盗号形态“的诈骗短信。更有甚者，可以直接从用户手机里偷钱。</p>
<p>近两年，不少法制媒体报道过这样一种案件，不法分子通过2G网络劫持的方式，进行短信嗅探犯罪。</p>
<p>根据目前报道，这种犯罪方法是用一个信号比较强的伪基站设备和网络干扰器，在小区里进行信号劫持。一般是选在后半夜大家都睡了之后，通过频段干扰掐断用户的3G和4G网络，逼迫手机回落到2G环境。然后通过2G伪基站获得用户的短信控制权，随后打开支付宝、京东等APP进行劫持环境下的转账消费。</p>
<p>当用户一觉睡醒，发现手机里多出来了几十上百条验证短信，账户里却少了不少真金白银。这种犯罪方式的操作性，目前还有不少争论。但有一点是肯定的，对于今天绝大部分用户来说，2G都是完全没用的一种东西，唯一带到现实生活中的就是电信诈骗和垃圾短信。</p>
<p>由于2G的先天不足，导致各种电话诈骗、隐私盗取、移动互联网攻击案例，基本操作都是先把用户拉入到2G网络中。于是2G网络似乎成了一个危险水区，它连接着我们日常游泳的地方，但里面只有不怀好意之人在深水里窥视。</p>
<p>当然了，上述犯罪有终端侧和信带测的各种方式来解决，今天移动网络在变得愈发安全。但把2G网络直接切断，把所有终端设备拉入安全性更强的网络环境中，显而易见是最干脆利落的办法。</p>
<p>而且另一方面，切断2G网络不只有安全上的意义，还隐藏着运营商”苍天不死，黄天难立“的担忧。</p>
<p>#难以承受的“2G之重”</p>
<p>今年4月，中国联通披露正在逐步进行2G基站减频退服换机活动。很多媒体都认为，这将是联通彻底关闭2G网络业务的开始。</p>
<p>根据相关数据，今天中国手机网络用户里，2G使用者只有不到2%，并且在不断降低。但这个没啥人用的网络，却要占据规模颇大的基站资源，并且持续消耗着运营维护费用。这当然没法让必须响应国家“提速降费”号召的运营商们感到高兴。</p>
<p>而让2G网络真正变成比鸡肋还鸡肋的<strong>“真·鸡肋无双”</strong>，还不仅仅是因为运营维护，而是2G占据着未来通信产业近乎最重要的资源——频谱。</p>
<p>时至如今，5G的频谱到底如何划分还处在悬念阶段。但毫无疑问的是，随着网络越来越复杂，频谱越来越少，对这种通信资源的精耕细作就变得异常重要。2016年8月，工信部发布了《国家无线电管理规划（2016-2020年）》，提出制定适合我国国情和市场环境、体现不同类别应用特征的频谱资源市场化策略和方案。首次将拍卖等市场化竞争方式引入到中国通信行业中来，这基本意味着未来移动通信产业中频谱会变得越发珍贵和可交易化。</p>
<p>那么对于运营商来说，一方面同时运营四套网络资源浪费太大，另一方面5G上马意味着新市场的打开，运营商急需调动资源精耕细作。</p>
<p>而2G网络在干嘛呢？它在占据着900MHz和1800MHz等等公认的优质频谱，真可谓占着那啥不那啥。</p>
<p>于是我们看到，今天三大运营商都在提出重耕频谱资源，尤其是2G频谱。随之而来就是呼声日益高涨的2G退网运动。</p>
<p>当2G这个令人怀念的名词，最终只能带给消费者以不安全，带给运营商沉重的负担，那么似乎也是时候说再见了。</p>
<p>但是稍微有点尴尬的是，好像还不那么容易。</p>
<p>#虽然食之无味，但2G还真有点弃之可惜</p>
<p>如今，日本、韩国、美国、新加坡，这些我们熟知的移动通信大国，都已经彻底关闭了2G网络。而中国的运营商确实已经开始了这项行动，但还是很多人对我们可以彻底告别2G表示并不乐观。</p>
<p>根据三大运营商发布的数据，2017年，中国一共有接近3亿的2G用户，先别急着惊叹。因为其中绝大部分都不是人类用户。</p>
<p>想必大家都知道，只能连2G网络的手机今天只剩下所谓的老人机。而更多的2G终端，是水表电表、路灯设备、共享单车、儿童手表等等IoT设备。而问题也就出现在这里了。虽然我们天天说要万物互联，但是IoT设备所依存的NB-IoT网络发展其实相当滞后，并且处在反复的讨论与争议中。</p>
<p>于是大量IoT设备都选择了成本最低的2G网络作为信号基带。当然了，今天主流儿童手表等设备已经开始选择4G网络，但大量公共服务设施还是依赖于2G。</p>
<p>如果断然断网，这些设备和刚刚发展起来一点的产业链怎么办呢？这个状况大概就是没选好内功呢，先把招式练了。结果学了九阴白骨爪，回去一看是少林寺的内功，感觉有点不大合适的样子。</p>
<p>另一个2G网络的问题，是中国的通信基础设施一直是建得不慢拆得慢，这当然有各种非技术因素萦绕于其中了。比如说今天原本给各县级电视台采用的模拟电视网络其实还在运行，但是大概非特别偏远地区，已经不可能有人用这种上古技术了。甚至于说，小灵通的频谱其实也还在运行着。</p>
<p>面对这些更古老，但是也没灭亡的技术，2G网络表示很稳。</p>
<p>此外要注意的是，那个大约占比2%的老人机市场，其实衍生出一条被运营商深度把持着的产业链，而且利润也不低。这也是一个让2G网络欲断还休的理由。</p>
<p>毫无疑问，笼罩在2018年的2G阴影是有点点复杂的，到底是快刀乱麻，还是再温存片许，这是运营商们的战略选择，我们无从得知。</p>
<p>但可以看出，2G被拆是一个早晚要进行的工程。其中带来的一些影响，却是值得在今天思考一下的。</p>
<p>#“2G拆迁工程”的进度与影响</p>
<p>拆迁这事嘛，从来都是拆一发而动全身的，无论是拆房子还是拆网络。后面带来的产业影响，或许才是挑战与机会。</p>
<p>比如说刚刚说过的物联网问题，基于2G的物联网设备，今天已经达到了上亿台的规模，并且还在持续产出。那么2G网络终将被退，带来的影响很可能就是物联网，尤其是城市基础设施物联网产业的洗牌和大规模方案升级。</p>
<p>今天的IoT产业，大概处在一个乱拳打死老师傅的状态。大家是有什么用什么，没有考虑长远发展。这种状况终将被终结，专用网络和行业标准化的机遇，或许就藏在2G退网当中。</p>
<p>而另一个需要洗牌的就是老人机市场。很多老人之所以选择只有2G功能的手机，并不是贪便宜，而是因为触屏手机真的不会用。那么是不是有方案可以加强老人手机体验，同时达成2G退网目的呢？这或许也是留给手机行业的一个新增长点吧。</p>
<p>其实还有一个2G承载的任务，是在边远地区，基站建设不充分的环境里完成网络提供。那么这或许又是另一个话题了，究竟如何保证每一寸国土上的网络通畅呢？又或者2G网络将陆续从大城市清退，最终变成一种“边疆技术”？</p>
<p>一件普及化极高的技术，往往很容易过时，却并没有那么容易彻底离开。今天我们依旧面临着2G的困惑，甚至可以在它不可逆的离去中发现一些机遇。那么其他技术的离开呢？都是如此还是静悄悄了无生息？</p>
<p>科技的坟场，或许是一个值得经常开下脑洞的话题。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/30/491/" data-id="ckkfmdgbm006bvkcgd3hja6r1" data-title="那些年，我们用过的2G" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-490" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/30/490/" class="article-date">
  <time class="dt-published" datetime="2018-10-29T23:08:23.000Z" itemprop="datePublished">2018-10-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/30/490/">说起即将来临的 5G 时代，除了网速更快，你还能想到什么？</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>5G，第五代移动通讯网络，将改变的远不止更快的上网速度。</p>
<p>5G 第一阶段计划的起点是 2019 年，它将提高智能手机的响应能力。随后，5G 会逐渐渗透到你生活的方方面面，改善你的日常，从汽车安全、娱乐方式，再到虚拟现实。</p>
<p>智能手机接入 5G 网络后，将以千兆位的速度传输超高清视频，且具有高度稳定性，可以实现身临其境的 VR 体验。</p>
<p>5G 还将保障自动驾驶汽车之间的安全，让汽车共享行驶「计划」，实现无障碍对接，甚至能够与马路上的行人保持通讯，让上下班的通勤旅程更安全、更高效。</p>
<p>那么，这些愿景是如何实现的？</p>
<p>自 20 世纪 80 年代，人类开始使用手机以来，高通公司（Qualcomm）几乎每隔十年便会推出新一代通信技术。每一代都青出于蓝而胜于蓝。4G LTE 时代，高通公司的技术便已经能在你的手机上实现千兆网速，顺畅接收流媒体视频，观看电视、直播。</p>
<p>说起即将来临的 5G，它绝不仅仅是速度更快的新一代。这些年来，高通不断推动 5G 技术的发展和行业标准的改善，利用 5G 将数十亿台智能设备互联。这不只改变了你的智能手机，还将升级你的家居、汽车，你所身处的行业、社区。</p>
<p>#崭新的虚拟世界</p>
<p>我们只有使用 5G 才能体验 VR 和 AR 么？从技术上讲并非如此，但是，目前的 4G 网络无法使 VR 与 AR 技术充分应用到我们的生活中，因为包括 VR、AR 在内的扩展现实技术 XR 对通信有更高的要求标准，它需要更加稳定统一的高速率连接，更大的网络容量，以及更小的时延。</p>
<p>「要实现令人身临其境的 VR 和 AR，必须提高现有的网络速度。用户操作按键或转头行动之时，移动网络必须做到立即响应。」高通技术公司（Qualcomm Technologies, Inc.）高级工程副总裁杜尔加•马拉蒂（Durga Malladi）说。</p>
<p>设想一下，你正在体验一款 VR 篮球游戏，游戏内的数据传输到你的头显设备中，让你可以 360 度观看球场景观。可是，你不想只观看比赛，你还想暂停一下拍一拍球员的肩膀。</p>
<p>5G 可以满足你的要求。它能提供足够大的容量和足够低的时延，让你在没有数据拥塞或延迟的情况下，完全沉浸在篮球游戏中。毕竟，谁能容忍一个人物动作无比卡顿，场景加载异常缓慢的虚拟世界呢？</p>
<p>基于 5G 升级的扩展现实技术，还可支持虚拟电话会议。未来，你和家人将进入同一个虚拟房间，通话不会延迟，更不会掉线。使用触觉手套能让你握住他们的双手，尽管你们可能身处异地。</p>
<p>「5G 通讯的高速率低时延对于在移动端头显设备实现逼真的 XR 体验是不可或缺的。」马拉蒂说。</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_89125.jpg"></p>
<p>#智慧城市近在眼前</p>
<p>5G 时代，可穿戴技术还将与大规模的物联网（IoT）相结合, 数十亿相连接的智能传感器将使可穿戴设备具有更多功能，而不只是简单地告诉你，今天走了多少步，此时的心率又是如何。它将带来更多可能。</p>
<p>「目前，可穿戴设备提供的信息有限。」马拉蒂说，「但在 5G 环境下，万物互联，让我们能够时刻感知周围发生的一切。」这就是 5G 未来。</p>
<p>传感器与你的可穿戴设备彼此互动，毫不间断。它能监控你早晨上班通勤的路况，工厂仓储间的货物情况，以及孩子在学校的一切动向。</p>
<p>手腕上智能设备震动了几下，你抬起手查看，发现是它在提示你，你常驻位置的共享单车只剩下最后一辆了。你小跑前行，这个智能设备还会提醒你注意十字路口即将飞驰而过的汽车。</p>
<p>「4G LTE 已经可以实现传感器数据的连接。」马拉蒂说：「但在 5G 时代，大规模 IoT 变革将使设备的连接数扩展到几十亿。」</p>
<p>「如果我们能将全世界每一个智能传感器连接，并且使用人工智能探测趋势，构建场景，那么这个传感器的集成将具有无限影响力。」马拉蒂补充道。</p>
<p>这将是怎样一番景象呢？</p>
<p>以你购买的衣物为例，传感器可以从源头对衣物进行追踪。供应链的初级阶段，农场地面上和机械内的传感器通过 5G 反馈成衣的物料数据；配有传感器的自动驾驶卡车将物料运送到工厂；工厂内，无线的自动机器人按照规定的尺寸和样式量体裁衣，制作样品；配备 AR 眼镜的设计人员联手将样品转换成用于整个生产过程的标准模板。最后，衣物数据被上传到电商平台的货架，供用户通过 VR 设备进行试穿。</p>
<p>5G 网络可以实现从农场到橱窗整个过程的透明化。<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_62255.jpg"></p>
<p>#梦想中的上下班之旅</p>
<p>5G 时代，在高稳定性和低时延率的通信成为现实后，自动驾驶汽车、高精度制造工业等便能更加快速地发展。</p>
<p>5G 让自动驾驶汽车绕过网络基站，相互之间建立直接联系，这减少了紧急通信时的延迟。</p>
<p>比如，碰撞即将发生之时，即使危险领域超出了其摄像头和雷达的检测范围，汽车也可以立即收到警报，进而停止行驶，亦或是改变路线。此外，5G 汽车还可以连接智慧城市基础设施，如交通信号灯和路牌，以改善交通流量管理。</p>
<p>利用 5G 通信，自动驾驶的汽车还可以「出行」共享计划，并提前规划路径，制定更安全、更高效的行程。「汽车可以根据其他车辆的位置和自身的出行规划作决策。」马拉蒂说。</p>
<p>这些会如何改变你的日常生活呢？方向盘会消失；车内空间将成为生活空间，像是个移动的沙发或办公室；旅途中，即使车辆正在高速行驶，5G 通信也可以传输超高清视频，甚至是 VR 数据；乘客可以在行程中轻松工作，彻底改变上下班的性质与状态。</p>
<p>随着首批 5G 设备的发布，5G 将成为改变世界方方面面的技术新星。身临其境的虚拟世界、万物互联的大型网络、以及更安全的出行之旅，这些仅仅是一个开端。高通公司正努力升级通信技术，制定相应标准，以便让 5G 成为支持未来大胆创新的无线网络。</p>
<p>马拉蒂说：「高通公司正在研发基础 5G 技术，开启超出我们所能想象的新领域。」</p>
<p>5G 世界即将到来，你准备好了吗？</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/30/490/" data-id="ckkfmdgbm006avkcgc9ol346l" data-title="说起即将来临的 5G 时代，除了网速更快，你还能想到什么？" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-489" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/29/489/" class="article-date">
  <time class="dt-published" datetime="2018-10-29T11:39:18.000Z" itemprop="datePublished">2018-10-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/29/489/">关于AIR202模块开启飞行模式后电流无法达到1.2ma的原因总结</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>有用户反映说，怎么air202模块开启飞行模式后，消耗电流反而增大，稳定在30mA？此时用户可能怀疑各种原因，甚至怀疑模组是否有问题，在这里结合这个问题我总计一下原因。</p><p><br></p><p>测试模组：air202_s5开发板</p><p>1、用户程序很简单，lua代码中，直接开启飞行模式，然后检测电流为稳定的30ma</p><p>原因：模组启动后还未成功注册网络，而你此时却调用函数进入飞行模式，此时飞行模式启用失败，从而导致电流稳定在30ma</p><p>解决措施：确保成功进入飞行模式</p><p>具体可参考本站链接：<a target="_blank" rel="noopener" href="http://oldask.openluat.com/article/118">http://oldask.openluat.com/article/118</a><a href="http://oldask.openluat.com/article/118" target="_blank"></a></p><p>补充：若用户想要系统开机后不要注册到网络，可以调用函数<span style="color: rgb(68, 68, 68);">sys.init(1, 0) ，该函数的参数在正常情况下应该为 sys.init(0, 0) ；当用户需要注册到网络的时候可调用sys.powerOn()</span></p><p>2、在排除上面第一点原因后，用户使用air202_s5开发板测试功耗，发现此时模组可以成功开启飞行模式，且电流从之前的30ma降低到3ma，有效果，但是仍未达到手册描述的1.2ma</p><p>原因：由于air202_s5开发板上的air模组的I/O口拓展了一些外设，可能会在模组工作时产生拉电流输出，从而导致模组即使成功进入飞行模式，但是由于IO口仍会输出较大电流，从而导致功耗远远超出手册描述的1.2ma。</p><p>原因确认：使用air202_s6最小系统板，该开发板上外扩功能最简，测试相同的代码，进入飞行模式后，总耗电流已经降低到1.2mA</p><p><br></p><p><br></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/29/489/" data-id="ckkfmdgbm0069vkcgevrj0lpf" data-title="关于AIR202模块开启飞行模式后电流无法达到1.2ma的原因总结" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-488" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/26/488/" class="article-date">
  <time class="dt-published" datetime="2018-10-26T04:56:47.000Z" itemprop="datePublished">2018-10-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/26/488/">luat模组开启飞行模式后电流变为30mA的问题解决</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>备注：以下测试，基于我的AIR202_S5最小系统板</p><p><br></p><p>有个luat客户反映说，怎么luat模组开启飞行模式后，消耗电流不减小反而增大了，并且电流恒定在30mA左右，他研究了好久也没找到原因，让我帮他想想办法。</p><p>今上午我特意拿出一上午时间，来针对这个问题展开测试，并找到答案。</p><p><b>开启飞行模式后电流变为30mA的原因，就是因为你没有成功开启飞行模式。</b></p><p>你要开启飞行模式，那么你得先知道什么是飞行模式。飞行模式简而言之，就是切断模组与基站的通讯链路，从而起到减小功耗的作用。</p><p>那么在这里就有一个问题，你要进入飞行模式切断通讯链路的前提，应该是你的模组当前已经向基站成功注册网络连接。在你的模组还没注册网络的情况下，你就着急进入飞行模式，那么问题就来了，典型现象就是你检测的模组消耗电流变为30mA，至于为什么是30mA我也不清楚。</p><p><br></p><p>客户发给我他的代码，意图是让模组进入飞行模式，如下所示：</p><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; white-space: pre;"><div>PROJECT = <span style="color: #ce9178;">"power test"</span></div><div>VERSION = <span style="color: #ce9178;">"0.0.0.1"</span></div><br><div><span style="color: #dcdcaa;">require</span> <span style="color: #ce9178;">"sys"</span></div><div><span style="color: #dcdcaa;">require</span><span style="color: #ce9178;">"gps"</span></div><div><span style="color: #dcdcaa;">require</span> <span style="color: #ce9178;">"log"</span> </div><div><span style="color: #dcdcaa;">require</span> <span style="color: #ce9178;">"net"</span></div><br><div>gps.<span style="color: #dcdcaa;">closeAll</span>()</div><div>log.<span style="color: #dcdcaa;">info</span>(<span style="color: #ce9178;">'main'</span>,<span style="color: #ce9178;">'main.lua'</span>)</div><br><div>net.<span style="color: #dcdcaa;">switchFly</span>(<span style="color: #569cd6;">true</span>)</div><div>sys.<span style="color: #dcdcaa;">init</span>(<span style="color: #b5cea8;">0</span>, <span style="color: #b5cea8;">0</span>)</div><div>sys.<span style="color: #dcdcaa;">run</span>()</div></div><p><br></p><p>从上面代码可以看出，用户在模组启动后，立马就开启了飞行模式，这样的结果只有一个，那就是好点电流变为30mA.</p><p>上面的姿势完全错误，下面请看正确姿势，如下所示：</p><div style="color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &quot;Courier New&quot;, monospace; line-height: 19px; white-space: pre;"><div><span style="color: #dcdcaa;">module</span>(<span style="color: #569cd6;">...</span>,package.<span style="color: #9cdcfe;">seeall</span>)</div><br><div><span style="color: #dcdcaa;">require</span><span style="color: #ce9178;">"pm"</span></div><div><span style="color: #dcdcaa;">require</span> <span style="color: #ce9178;">"common"</span></div><br><div>sys.<span style="color: #dcdcaa;">taskInit</span>(<span style="color: #c586c0;">function</span>()</div><br><div><span style="color: #6a9955;">---------------等待模组网络附着成功，如果网络在未附着成功的情况下，去开启飞行模式，那么是不会成功的</span></div><div>    <span style="color: #c586c0;">local</span> netStatus = <span style="color: #569cd6;">true</span></div><div>    <span style="color: #c586c0;">local</span> netRes</div><div>    log.<span style="color: #dcdcaa;">info</span>(<span style="color: #ce9178;">'powerTest'</span>,common.<span style="color: #dcdcaa;">utf8ToGb2312</span>(<span style="color: #ce9178;">'等待模组附着网络成功'</span>))</div><div>    <span style="color: #c586c0;">while</span> netStatus <span style="color: #c586c0;">do</span></div><div>        <span style="color: #c586c0;">if</span> net.<span style="color: #dcdcaa;">getState</span>()==<span style="color: #ce9178;">'REGISTERED'</span> <span style="color: #c586c0;">then</span></div><div>            netStatus = <span style="color: #569cd6;">false</span></div><div>        <span style="color: #c586c0;">end</span></div><div>        sys.<span style="color: #dcdcaa;">wait</span>(<span style="color: #b5cea8;">1000</span>)</div><div>    <span style="color: #c586c0;">end</span></div><div>    log.<span style="color: #dcdcaa;">info</span>(<span style="color: #ce9178;">'powerTest'</span>,common.<span style="color: #dcdcaa;">utf8ToGb2312</span>(<span style="color: #ce9178;">'模组网络附着成功'</span>))</div><div><span style="color: #6a9955;">----------------------------------------------------------------------------------</span></div><div>    <span style="color: #c586c0;">while</span> <span style="color: #569cd6;">true</span> <span style="color: #c586c0;">do</span></div><div>        log.<span style="color: #dcdcaa;">info</span>(<span style="color: #ce9178;">'powerTest'</span>,common.<span style="color: #dcdcaa;">utf8ToGb2312</span>(<span style="color: #ce9178;">'10秒后将启动飞行模式，请注意对比电流变化'</span>))</div><div>        sys.<span style="color: #dcdcaa;">wait</span>(<span style="color: #b5cea8;">10000</span>)<span style="color: #6a9955;">--延时10秒</span></div><br><div>        log.<span style="color: #dcdcaa;">info</span>(<span style="color: #ce9178;">'powerTest'</span>,common.<span style="color: #dcdcaa;">utf8ToGb2312</span>(<span style="color: #ce9178;">'启动飞行模式，此时电流应该显著减小'</span>))</div><div>        net.<span style="color: #dcdcaa;">switchFly</span>(<span style="color: #569cd6;">true</span>) <span style="color: #6a9955;">--启动飞行模式</span></div><br><div>        log.<span style="color: #dcdcaa;">info</span>(<span style="color: #ce9178;">'powerTest'</span>,common.<span style="color: #dcdcaa;">utf8ToGb2312</span>(<span style="color: #ce9178;">'20秒后将退出飞行模式，请注意对比电流变化'</span>))</div><div>        sys.<span style="color: #dcdcaa;">wait</span>(<span style="color: #b5cea8;">20000</span>)<span style="color: #6a9955;">--延时20秒</span></div><br><div>        log.<span style="color: #dcdcaa;">info</span>(<span style="color: #ce9178;">'powerTest'</span>,common.<span style="color: #dcdcaa;">utf8ToGb2312</span>(<span style="color: #ce9178;">'退出飞行模式，此时电流应该显著增大'</span>))</div><div>        net.<span style="color: #dcdcaa;">switchFly</span>(<span style="color: #569cd6;">false</span>)<span style="color: #6a9955;">--退出飞行模式</span></div><br><div>       <span style="color: #6a9955;">-- pm.wake("A") --执行本句后，A唤醒了模块</span></div><div>        <span style="color: #6a9955;">--pm.wake("A") --执行本句后，A重复唤醒模块，实际上没什么变化</span></div><div>       <span style="color: #6a9955;">-- pm.sleep("A") --执行本句后，A休眠了模块，lua部分已经没有功能唤醒模块了，模块是否休眠由core决定</span></div><div>        <span style="color: #c586c0;">while</span> <span style="color: #569cd6;">true</span> <span style="color: #c586c0;">do</span></div><div>            sys.<span style="color: #dcdcaa;">wait</span>(<span style="color: #b5cea8;">2000</span>)</div><div>        <span style="color: #c586c0;">end</span></div><div>        </div><div>    <span style="color: #c586c0;">end</span></div><div><span style="color: #c586c0;">end</span>)</div></div><p><br></p><p>在上面的测试代码中，我先等待模组成功注册网络，然后我再进入飞行模式。经实测，在进入飞行模式前，电流是变化的，从大约20mA至最大70mA之间跳变。</p><p>然而在开启飞行模式后，电流稳定在3mA左右。此处飞行模式电流为3mA左右 ，对于低功耗产品来说电流仍较大，但是可以采取其他一些措施进一步减小功耗。</p><p><br></p><p>总结：</p><p>有不止一个客户反映飞行模式30mA的问题，请大家参考我的测试结果。</p><p><br></p><p>注意：我测试模组电流，是将模组VBAT供电引脚与电源的走线切断后，串联电流表。</p><p><br></p><p><br></p><p><br></p><p><br></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/26/488/" data-id="ckkfmdgbl0067vkcgdf37f6eq" data-title="luat模组开启飞行模式后电流变为30mA的问题解决" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-487" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/23/487/" class="article-date">
  <time class="dt-published" datetime="2018-10-23T04:12:45.000Z" itemprop="datePublished">2018-10-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/23/487/">如何计算GPS的NMEA校验码，并修改AIR530的输出间隔</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a href="http://doc.yannbaba.com/web/#/27?page_id=489" target="_blank">http://doc.yannbaba.com/web/#/27?page_id=489</a><br></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/23/487/" data-id="ckkfmdgbl0068vkcg4qvz3shi" data-title="如何计算GPS的NMEA校验码，并修改AIR530的输出间隔" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-486" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2018/10/23/486/" class="article-date">
  <time class="dt-published" datetime="2018-10-23T01:22:33.000Z" itemprop="datePublished">2018-10-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2018/10/23/486/">AIR202模块配合ONENET平台发送心跳包失败问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;现实用AIR202_S5最小系统板做一个小开发，配合移动的onenet物联网平台。&lt;/p&gt;&lt;p&gt;air202的开发使用lua脚本，对mqtt的配置如下：&lt;/p&gt;&lt;div style=&quot;color: rgb(212, 212, 212); background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; line-height: 19px; white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c586c0;&quot;&gt;local&lt;/span&gt; subTopic = &lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;/lock/176766/45967572/get&quot;&lt;/span&gt; &lt;span style=&quot;color: #6a9955;&quot;&gt;--设备端需要订阅的topic&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c586c0;&quot;&gt;local&lt;/span&gt; mqttIp,mqttPort =  &lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;mqtt.heclouds.com&quot;&lt;/span&gt;,&lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;6002&quot;&lt;/span&gt; &lt;span style=&quot;color: #6a9955;&quot;&gt;--定义onenet的服务器域名和端口&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c586c0;&quot;&gt;local&lt;/span&gt; clientId = &lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;xxx&quot;&lt;/span&gt; &lt;span style=&quot;color: #6a9955;&quot;&gt;--在onenet平台创建设备时，系统自动生成的设备id&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c586c0;&quot;&gt;local&lt;/span&gt; userName = &lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;xxx&quot;&lt;/span&gt;  &lt;span style=&quot;color: #6a9955;&quot;&gt;--在onenet平台创建设备时，系统生成的产品id&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c586c0;&quot;&gt;local&lt;/span&gt; passWord = &lt;span style=&quot;color: #ce9178;&quot;&gt;&quot;xxxx=&quot;&lt;/span&gt; &lt;span style=&quot;color: #6a9955;&quot;&gt;--onenet平台的APIkey&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c586c0;&quot;&gt;local&lt;/span&gt; keepAlive = &lt;span style=&quot;color: #b5cea8;&quot;&gt;600&lt;/span&gt;  &lt;/div&gt;&lt;/div&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;上面的keepAlive单位是秒，也就是多少秒后发送心跳包来保持长连接。&lt;/p&gt;&lt;p&gt;设备启动后，一切正常，然而在10分钟（600秒）后，LuaTool界面提示错误日志如下：&lt;/p&gt;&lt;p&gt;[2018-10-23 08:42:06.827]: [I]-[mqtt.client:checkKeepAlive]&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;pingreq send fail&lt;/p&gt;&lt;p&gt;[2018-10-23 08:42:06.827]: [D]-[mqtt.client:write]&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;C000&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;2&lt;/p&gt;&lt;p&gt;[2018-10-23 08:42:06.827]: [W]-[socket.client:send]&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;error&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;6, SEND FAIL&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;当出现上面错误提示的时候，AIR202会重连，也会连接成功，经过多次观察，发现重连成功后10分钟又再次出现该问题，这样是严重影响正常使用的。&lt;/p&gt;&lt;p&gt;上面问题周期性出现，且间隔都是10分钟，因此基本可以断定，是模组每隔600s发送心跳包，但是发送失败了。&lt;/p&gt;&lt;p&gt;模组使用的是移动的手机卡，考虑到mqtt是基于tcp的长连接，要想维持长连接必须间隔性的发送心跳包来告诉运行商，这个tcp连接我还要用，不要给我切断，所以怀疑是不是600秒发一次心跳包时间间隔太久了呢？&lt;/p&gt;&lt;p&gt;于是，将600s，修改为120s，也就是让模组每隔2分钟就发心跳包，然后进行测，问题得以解决。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;总结：&lt;/p&gt;&lt;p&gt;[2018-10-23 08:42:06.827]: [I]-[mqtt.client:checkKeepAlive]&lt;span style=&quot;white-space: pre;&quot;&gt;    &lt;/span&gt;pingreq send fail&lt;/p&gt;&lt;p&gt;[2018-10-23 08:42:06.827]: [D]-[mqtt.client:write]&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;C000&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;2&lt;/p&gt;&lt;p&gt;[2018-10-23 08:42:06.827]: [W]-[socket.client:send]&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;error&lt;span style=&quot;white-space:pre&quot;&gt;    &lt;/span&gt;6, SEND FAIL&lt;/p&gt;&lt;p&gt;出现上面问题的原因，与模组无关，与onenet物联网平台无关，只跟自己程序里心跳包发送间隔时间太长有关，时间改短点。&lt;/p&gt;&lt;p&gt;有人会觉得心跳包间隔时间短，那发送频率高，多么浪费流量啊？其实不然，你长时间不发送数据，你即使发送几个字节，那么运营商也会按照1K来计算的。&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2018/10/23/486/" data-id="ckkfmdgbl0066vkcge7zjdlpv" data-title="AIR202模块配合ONENET平台发送心跳包失败问题" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/48/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/47/">47</a><a class="page-number" href="/page/48/">48</a><span class="page-number current">49</span><a class="page-number" href="/page/50/">50</a><a class="page-number" href="/page/51/">51</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/50/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>