<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:type" content="website">
<meta property="og:title" content="Luat doc 社区文章静态页面镜像">
<meta property="og:url" content="https://doc.luatos.wiki/page/7/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-2092" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/21/2092/" class="article-date">
  <time class="dt-published" datetime="2020-12-21T01:47:38.000Z" itemprop="datePublished">2020-12-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/21/2092/">合宙Cat1模块能支持各种Sim卡的哪些功能</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p style="text-align:center;"><span style="font-size:30px"><strong>合宙Cat1模块能支持各种Sim卡的哪些功能</strong></span></p><p style="text-indent:2em;">智能家居、智能穿戴、智能电表、智能汽车、车联网、固定POS机等都在使用物联网卡和手机卡，通过移动、联通和电信等运营商的网络，实现数据的回传、通讯和控制。</p><p></p><p style="text-align:left;text-indent:2em;" size="1" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false">其实在前几年，并没有物联网卡与手机卡之分，智能设备用的全部是手机卡，并没有物联网卡之说。</p><p></p><p style="text-align:left;text-indent:2em;" size="1" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false">随着智能设备用卡量的与日俱增，号码资源日益匮乏，才有了物联网卡的专门分类。而对于模块来说，使用不同的SIM卡又是有区别的。下面就让我们一起来探究一下合宙模块使用不同的sim卡都支持哪些功能吧~</p><p style="text-align:left;" class="MsoNormal"><br/><strong><span style="font-size:24px">一、定义</span></strong></p><p style="text-align:left;text-indent:2em;" size="1" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false">物联网卡是三大运营商面向物联网用户提供的采用物联网专用号段作为MSISDN的移动通信接入业务，通过专用网元设备支持短信和无线数据等基础通信服务，并提供通信状态管理和通信鉴权等智能通道服务，默认开通物联网专用的短信接入服务号和物联网通用APN。</p><p style="text-align:left;" class="MsoNormal">物联网卡应用领域广、产品形态丰富、套餐资费灵活。</p><p></p><p style="text-align:left;text-indent:2em;" size="1" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false">sim卡是(Subscriber Identity Module 客户识别模块)的缩写，也称为用户身份识别卡、智能卡，GSM数字移动电话机必须装上此卡方能使用。在电脑芯片上存储了数字移动电话客户的信息，加密的密钥以及用户的电话簿等内容，可供GSM网络客户身份进行鉴别，并对客户通话时的语音信息进行加密。</p><p style="text-align:left;" class="MsoNormal"></p><p style="text-align:left;" class="MsoNormal"><strong><span style="font-size:24px">二、合宙模块使用物联卡和手机卡的功能有哪些</span></strong></p><p style="text-align:left;text-indent:2em;" size="1" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false">1. 合宙Cat.1模块支持移动、联通和电信的物联网卡和手机卡。前提是卡本身已经开通电话和短信功能。</p><p></p><p style="text-align:left;text-indent:2em;" size="1" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false">2. 合宙模块使用的物联卡的功能也是根据运营商而定的。目前只有中国移动支持短信功能，而且开卡时候默认短信是关闭，如客户需要短信功能，需在订单中明确备注，建议客户提前测试。电话功能默认是不支持的。相对于联通和电信就不支持短信功能了。就算是客户想要使用短信功能，提前申请了也无法使用短信功能。对于这一点，许多用户还不是很清楚，所以在这里再重点介绍一下。</p><p></p><p style="text-indent:2em;" size="1" _root="[object Object]" __ownerid="undefined" __hash="undefined" __altered="false">3. 合宙模块使用的普通SIM卡（手机卡）的功能跟我们使用手机时功能时一样的，支持电话、短信等功能。同样的像我们的手机一样，手机卡必须是开通了VOLTE才可以支持4g短信业务的，而针对没有开通VOLTE的则只能退而求其次期待在2g短信上面了。同时，需要提醒大家需要关注的一点是：目前对于合宙的Cat.1系列只有720UH是支持4G+2G的网络制式的。对于不支持2G网络制式的模块是无法在不开通VOLTE的情况下使用短信功能的。所以在其他模块上如果大家需要使用到手机卡的短信功能的话建议开通VOLTE功能。如果一旦没有开通VOLTE功能并且使用的不是720UH模块的话，那就建议大家使用移动物联网卡。</p><p></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/21/2092/" data-id="ckkfmdgac002vvkcgb56s4rot" data-title="合宙Cat1模块能支持各种Sim卡的哪些功能" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2081" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/17/2081/" class="article-date">
  <time class="dt-published" datetime="2020-12-17T13:08:51.000Z" itemprop="datePublished">2020-12-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/17/2081/">合宙Cat1超低功耗方案</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h2><span style="color:#000000">一、超低功耗是什么</span></h2><p>超低功耗是相对于低功耗而言的。考虑到模块大部分应用场景：系统休眠后，依然需要隔一段时间进行数据收发，来上报设备的状态。所以传统的低功耗数据只具备一定的参考意义，实际业务场景下，并不能达到这个数值。超低功耗是针对【隔段时间收发数据】这一场景的特定优化，来降低产品的整体功耗。</p><p><strong>特别说明：不管是进入低功耗还是超低功耗状态，都不会丢失服务器发来的数据。</strong></p><h2><span style="color:#000000">二、能降低多少功耗</span></h2><p>合宙Cat1 AT标准固件，在实网下测量的功耗数据如下：</p><p></p><table border="1" style="border-collapse: collapse"><colgroup><col width="0"></col><col width="0"></col><col width="0"></col><col width="0"></col><col width="0"></col></<colgroup><tr><td style="text-align:center;" colSpan="2" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">测试项</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">移动BAND40</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">联通BAND1</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">电信BAND1</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">样机数量</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">3PCS</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1#</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1#</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1#</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">信号质量</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">AT+CESQ</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">67</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">61</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">68</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="3"><span style="font-size:14px"><span style="color:#000000">飞行模式(mA)</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">底电流</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.2</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.2</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.2</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">AT+CFUN=0</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.21</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.21</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.21</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">AT+CFUN=4</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.21</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.21</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.21</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">工作电流(mA)</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">IDLE模式</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">12.37</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">11.98</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">12.72</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">休眠电流(mA)</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">AT+CSCLK=2</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.96</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1.72</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">2.71</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">TCP心跳包保活(mA)</span></span><br/><span style="font-size:14px"><span style="color:#000000">（默认设置）</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1分钟一次</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">10.17</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">9.32</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">8.29</span></span></td></tr><tr><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">TCP心跳包保活(mA)</span></span><br/><span style="font-size:14px"><span style="color:#000000">（超低功耗AT*RTIME=1）</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">1分钟一次</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">3.95</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">3.76</span></span></td><td style="text-align:center;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">4.41</span></span></td></tr></table><p>从最后两行对比结果看，超低功耗模式下，<strong>心跳包保活场景功耗降低了一半以上。</strong></p><p><strong>注意：实际测量数据会受网络信号、是否已经注册上网、外围是否接了设备因素影响，如果差异比较大建议先断开外围设备，进入飞行模式对比一下数据。</strong></p><h2><span style="color:#000000">三、什么时候用</span></h2><p>超低功耗可用于大多数的数传业务场景。这些场景有一个共同的特点：需要传输数据的时候利用网络进行数据传输，传输完成后，设备进入心跳包保活状态。超低功耗正是针对心跳保活功耗的优化来实现整体功耗的降低。典型产品场景有：云喇叭、监控摄像头、共享设备、远程控制等。</p><h2><span style="color:#000000">四、怎么用</span></h2><p>首先，打开进入低功耗休眠模式，让设备空闲状态下进入低功耗状态；其次，通过AT命令AT*RTIME打开超低功耗模式。下面以AT版本为例，设置步骤如下：</p><p>1，打开低功耗模式：AT+CSCLK=2</p><p>2，关闭网络灯：AT+CNETLIGHT=0</p><p>3，关闭日志： AT^TRACECTRL=0,0和AT^TRACECTRL=1,0</p><p>4，设置串口立即休眠：AT+WAKETIM=1</p><p>5，设置超低功耗：AT*RTIME=2</p><p>步骤1-4参考通用AT指令手册。</p><p>下面单独介绍一下超低功耗AT指令：</p><p>AT*RTIME=&lt;n&gt;</p><p><span style="color:#333333">该命令设置后会被保存到NV中，掉电后存储。</span></p><p><strong><span style="font-size:12px"><span style="color:#444444">语法规则：</span></span></strong></p><p></p><table border="1" style="border-collapse: collapse"><colgroup><col width="0"></col><col width="0"></col><col width="0"></col></<colgroup><tr><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">命令类型</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">语法</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">返回</span></span></td></tr><tr><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">设置命令</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">AT*RTIME=&lt;wait_time&gt;</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">OK</span></span></td></tr><tr><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">查询命令</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">AT*RTIME？</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">*RTIME: &lt;wait_time&gt; OK</span></span></td></tr></table><p><strong><span style="font-size:12px"><span style="color:#444444">参数定义：</span></span></strong></p><p></p><table border="1" style="border-collapse: collapse"><colgroup><col width="0"></col><col width="0"></col><col width="0"></col><col width="0"></col></<colgroup><tr><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">参数</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">定义</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">取值</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">对取值的说明</span></span></td></tr><tr><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">&lt;wait_time&gt;</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">在数传模式下，等待多长时间进入休眠状态</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">0~20</span></span></td><td style="text-align:left;" colSpan="1" rowSpan="1"><span style="font-size:14px"><span style="color:#000000">单位:秒，0表示关闭。</span></span></td></tr></table><p>信号正常情况下，&lt;n&gt;值越短功耗就越低，建议设置为2。如果实际使用环境信号比较差，数据收发经常出现重传延迟，那这个值就需要改大。</p><p><br/></p><h2><span style="color:#000000">五、哪个版本才支持</span></h2><p>AT版本&gt;=V301716</p><p>Lua版本&gt;=V3024</p><p>CSDK版&gt;= 2020-12-19提交 <a href="https://gitee.com/openLuat/Luat_CSDK_Air724U" target="">https://gitee.com/openLuat/Luat_CSDK_Air724U</a></p><p></p><h2><span style="color:#000000">六、要注意什么</span></h2><p>1，在进行CTA/GCF等测试认证的时候需要关闭该功能。</p><p>2，如果心跳包比较频繁，不如10秒一次，那就不建议开启这个功能，极端情况下可能会导致设备断网。</p><p>3，如果数传是基于UDP这种非可靠传输，打开这个功能后，丢包概率会变大。<br/></p><p><br/></p><p><br/></p><p><br/></p><p><br/></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/17/2081/" data-id="ckkfmdgab002tvkcgdi49b8um" data-title="合宙Cat1超低功耗方案" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2080" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/17/2080/" class="article-date">
  <time class="dt-published" datetime="2020-12-17T12:24:47.000Z" itemprop="datePublished">2020-12-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/17/2080/">3、Linux常用技巧：解决Linux下USB设备节点ttyUSB名不固定的问题，生成固定USB转串口设备节点</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>转载：<br>原文链接：<a target="_blank" rel="noopener" href="http://blog.sina.com.cn/s/blog_8b58097f0102wxm3.html">http://blog.sina.com.cn/s/blog_8b58097f0102wxm3.html</a></p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44570083/article/details/104285283">点击这里查看所有博文</a></p>
<p>&emsp;&emsp;本系列博客所述资料<code>均来自网络</code>，并不是本人原创（只有博客是自己写的）。出于热心，本人将自己的所学笔记整理并推出相对应的使用教程，方面其他人学习。若出现侵权现象，请告知本人，本人会立即停止更新，并删除相应的文章和代码。</p>
<h2 id="1-Linux下USB设备节点名不固定问题经常会遇到"><a href="#1-Linux下USB设备节点名不固定问题经常会遇到" class="headerlink" title="1. Linux下USB设备节点名不固定问题经常会遇到"></a>1. Linux下USB设备节点名不固定问题经常会遇到</h2><p>&emsp;&emsp;以USB转串口设备为例，通常设备节点名为ttyUSBx（x为0~n）,Linux内核会根据设备插入的先后顺序进行编号的分配，比如第一个插入的设备编号为ttyUSB0，然后依此加1，变为ttyUSB1，ttyUSB2……</p>
<p>&emsp;&emsp;如果仅仅以设备节点ttyUSBx来区别具体是哪个设备，因为末位的编号是随时会变的，所以就会造成混乱。无法保证A设备就是ttyUSB0，B设备就是ttyUSB1。</p>
<p>&emsp;&emsp;Linux在设备文件/dev目录下并没有提供固定显示ttyUSB的方法，但是，其实，每个USB端口都有唯一的端口号，相当于每个门店的门牌号。只要我们依据端口号来进行设备的区分，那么问题就迎刃而解了。简单点来说就是找到端口号，然后根据端口号找到挂载在这个端口号上面的USB设备是ttyUSB0还是 ttyUSB1….(这个是变化的，前面讲到了)。</p>
<h2 id="2-关于端口号的查看方法"><a href="#2-关于端口号的查看方法" class="headerlink" title="2. 关于端口号的查看方法"></a>2. 关于端口号的查看方法</h2><p>&emsp;&emsp;连接好两个USB转串口设备之后执行命令：<code>ls -l /sys/class/tty/ttyUSB*</code></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[smart@localhost multiTesting]$ ls -l /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB</span>*</span></span><br><span class="line"><span class="class"><span class="title">lrwxrwxrwx</span> 1 <span class="title">root</span> <span class="title">root</span> 0 <span class="title">Dec</span> 17 18:</span><span class="number">39</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB0</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.3</span>/<span class="number">1</span><span class="number">-1.3</span>:<span class="number">1.0</span>/ttyUSB0/tty/ttyUSB0</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Dec <span class="number">17</span> <span class="number">18</span>:<span class="number">39</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB1</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.1</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>:<span class="number">1.2</span>/ttyUSB1/tty/ttyUSB1</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Dec <span class="number">17</span> <span class="number">18</span>:<span class="number">39</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB2</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.1</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>:<span class="number">1.3</span>/ttyUSB2/tty/ttyUSB2</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Dec <span class="number">17</span> <span class="number">18</span>:<span class="number">39</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB3</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.1</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>:<span class="number">1.4</span>/ttyUSB3/tty/ttyUSB3</span><br><span class="line">[smart@localhost multiTesting]$ ls -l /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB</span>*</span></span><br><span class="line"><span class="class"><span class="title">lrwxrwxrwx</span> 1 <span class="title">root</span> <span class="title">root</span> 0 <span class="title">Dec</span> 17 18:</span><span class="number">41</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB0</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.1</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>:<span class="number">1.2</span>/ttyUSB0/tty/ttyUSB0</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Dec <span class="number">17</span> <span class="number">18</span>:<span class="number">41</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB1</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.1</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>:<span class="number">1.3</span>/ttyUSB1/tty/ttyUSB1</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Dec <span class="number">17</span> <span class="number">18</span>:<span class="number">41</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB2</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.1</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>/<span class="number">1</span><span class="number">-1.1</span><span class="number">.2</span>:<span class="number">1.4</span>/ttyUSB2/tty/ttyUSB2</span><br><span class="line">lrwxrwxrwx <span class="number">1</span> root root <span class="number">0</span> Dec <span class="number">17</span> <span class="number">18</span>:<span class="number">41</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB3</span> -&gt;</span> ../../devices/platform/soc/<span class="number">3f</span>980000.usb/usb1/<span class="number">1</span><span class="number">-1</span>/<span class="number">1</span><span class="number">-1.3</span>/<span class="number">1</span><span class="number">-1.3</span>:<span class="number">1.0</span>/ttyUSB3/tty/ttyUSB3</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;我这里分别进行了两次测试<br>&emsp;&emsp;第1次先插入CH340(ttyUSB0)，后插入4G模组(虚拟出来的ttyUSB1、ttyUSB2、ttyUSB3)。<br>&emsp;&emsp;第2次先插入4G模组(虚拟出来的ttyUSB0、ttyUSB1、ttyUSB2)，后插入CH340(ttyUSB3)。</p>
<p>&emsp;&emsp;由上面的日志可知：不管先后插入的顺序如何，CH340对应的USB端口都是1-1.3:1.0。知道端口后我们该如何确定设备对应的ttyUSBx设备节点呢。</p>
<h2 id="3-实际问题，实际解决"><a href="#3-实际问题，实际解决" class="headerlink" title="3. 实际问题，实际解决"></a>3. 实际问题，实际解决</h2><p>&emsp;&emsp;实际工程中，碰到的一个问题是：硬件上连接有两个USB转串口设备，硬件只要一上电，两个USB设备几乎是同时上电的，这将导致ttyUSB0或者ttyUSB1无法每次固定的对应到上一次的那个相同端口，上层软件需要通过串口设备节点/dev/ttyUSBx来打开一个串口，并从串口获取数据，但是这个ttyUSBx设备并不是一直都指向固定的一个usb端口号，这直接导致我们无法往下操作了。<br><code>解决办法：</code><br>&emsp;&emsp;这里使用bash语言加Python正则表达式的相关知识解决这个问题：解决问题的思路是：</p>
<ol>
<li>第一次上电的时候，我们需要确定哪个端口上的数据是我们所需要的：<br>ls -l /sys/class/tty/ttyUSB*<br>假设是3-1.1这个端口是我们的data端口。</li>
<li>以后每次上电，我们要找到3-1.1这个端口后面挂载的ttyUSB设备是ttyUSB0还是ttyUSB1，并建立一个软链接将当时获取到的ttyUSBx生成一个软链接，名字固定为ttydata,那么以后每次打开/dev/ttydata就能找到正确3-1.1这个端口，并获取数据了。</li>
<li>建立一个文件夹getUSB，该文件夹下面包含：</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/20201217200844283.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDU3MDA4Mw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>&emsp;&emsp;其中cmd.sh是利用bash脚本获取/sys/class/tty/ttyUSB*的一些信息保存在device_usb.txt中。<br>cmd.sh如下：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">declare <span class="literal">-i</span> a=<span class="number">0</span></span><br><span class="line">declare <span class="literal">-i</span> b=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> [[ ! -<span class="type">e</span> <span class="string">&quot;/sys/class/tty/ttyUSB0&quot;</span> ]]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">sudo <span class="built_in">sleep</span> <span class="number">0.01</span>s</span><br><span class="line">a=a+<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> [ <span class="variable">$a</span> -<span class="type">eq</span> <span class="number">300</span> ];then  <span class="comment">#等待一段时间没有检测ttyUSB0设备到会自动跳出while</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">fi</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> [[ ! -<span class="type">e</span> <span class="string">&quot;/sys/class/tty/ttyUSB1&quot;</span> ]]</span><br><span class="line"><span class="keyword">do</span></span><br><span class="line">sudo <span class="built_in">sleep</span> <span class="number">0.01</span>s</span><br><span class="line">b=b+<span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> [[ <span class="variable">$b</span> -<span class="type">eq</span> <span class="number">300</span>||<span class="variable">$a</span> -<span class="type">ne</span> <span class="number">0</span> ]];then  <span class="comment">#if USB0 been detected ,also get out of while</span></span><br><span class="line"><span class="keyword">break</span></span><br><span class="line">fi</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> [[ ! -<span class="type">e</span> /<span class="type">sys</span>/<span class="type">class</span>/<span class="type">tty</span>/<span class="type">ttyUSB0</span>&amp;&amp;! -<span class="type">e</span> /<span class="type">sys</span>/<span class="type">class</span>/<span class="type">tty</span>/<span class="type">ttyUSB1</span> ]]; then <span class="comment">#如果不存在ttyUSB设备</span></span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;Not have ttyUSB0 or not have ttyUSB1&quot;</span></span><br><span class="line"><span class="keyword">else</span>                             <span class="comment">#如果完美检测到了两个ttyUSB设备，则将信息log到device_usb.txt当中</span></span><br><span class="line">tty1=<span class="variable">$</span>(<span class="built_in">ls</span> <span class="literal">-l</span> /sys/<span class="class"><span class="keyword">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB0</span>)</span></span><br><span class="line"><span class="class"><span class="title">tty2</span>=$(<span class="title">ls</span> -<span class="title">l</span> /<span class="title">sys</span>/<span class="title">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB1</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">sudo</span> <span class="title">ls</span> -<span class="title">l</span> /<span class="title">sys</span>/<span class="title">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB0</span> /<span class="title">sys</span>/<span class="title">class</span>/<span class="title">tty</span>/<span class="title">ttyUSB1</span> &gt; ./<span class="title">device_usb</span>.<span class="title">txt</span></span></span><br><span class="line"><span class="class"><span class="title">fi</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">if</span> [ ! -<span class="title">n</span> &quot;$<span class="title">tty1</span>&quot; ] ;<span class="title">then</span>   # &quot;! -<span class="title">n</span>&quot; <span class="title">shows</span> <span class="title">blank</span> <span class="title">var</span>  #非空检测</span></span><br><span class="line"><span class="class"><span class="title">echo</span> &quot;<span class="title">tty1</span> <span class="title">is</span> <span class="title">empty</span>&quot;</span></span><br><span class="line"><span class="class"><span class="title">fi</span></span></span><br><span class="line"><span class="class">#<span class="title">delay</span> 0.01<span class="title">s</span> <span class="title">to</span> <span class="title">make</span> <span class="title">sure</span> <span class="title">the</span> <span class="title">device_usb</span>.<span class="title">txt</span> <span class="title">complete</span></span></span><br><span class="line"><span class="class"><span class="title">sudo</span> <span class="title">sleep</span> 0.01<span class="title">s</span></span></span><br><span class="line"><span class="class">#<span class="title">remove</span> <span class="title">the</span> <span class="title">old</span> <span class="title">USB</span> <span class="title">device</span> <span class="title">shortcut</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">if</span> [ ! -<span class="title">e</span> &quot;/<span class="title">dev</span>/<span class="title">ttydata</span>&quot; ] ;<span class="title">then</span> # 如果/<span class="title">dev</span>/<span class="title">ttydata</span>本身不存在</span></span><br><span class="line"><span class="class"><span class="title">echo</span> &quot;-------------/<span class="title">dev</span>/<span class="title">ttydata</span> <span class="title">not</span> <span class="title">found</span>&quot;</span></span><br><span class="line"><span class="class"><span class="title">else</span>                               #如果存在，则需删除之，然后重新创建之</span></span><br><span class="line"><span class="class"><span class="title">echo</span> &quot;/<span class="title">dev</span>/<span class="title">ttydata</span> <span class="title">is</span> <span class="title">exist</span>&quot;</span></span><br><span class="line"><span class="class"><span class="title">sudo</span> <span class="title">rm</span> /<span class="title">dev</span>/<span class="title">ttydata</span></span></span><br><span class="line"><span class="class"><span class="title">fi</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">#<span class="title">exct</span> <span class="title">Python</span> <span class="title">language</span> <span class="title">to</span> <span class="title">get</span> <span class="title">the</span> <span class="title">rignt</span> <span class="title">USB</span> <span class="title">interface</span></span></span><br><span class="line"><span class="class">./<span class="title">getUSB</span>.<span class="title">py</span>   #调用当前路径下的<span class="title">getUSB</span>.<span class="title">py</span>这个<span class="title">Python</span>语言，明确此次是哪个,<span class="title">ttyUSB0</span>,或者<span class="title">ttyUSB1</span>挂载在端口3-1.1上</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">usbdev</span>=$(<span class="title">cat</span> ./<span class="title">usbdev</span>) #获取到这个设备</span></span><br><span class="line"><span class="class"><span class="title">echo</span> &quot;<span class="title">the</span> <span class="title">device</span> <span class="title">is</span> : &quot;</span></span><br><span class="line"><span class="class"><span class="title">echo</span> $<span class="title">usbdev</span></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"><span class="title">sudo</span> <span class="title">ln</span> -<span class="title">s</span> /<span class="title">dev</span>/$<span class="title">usbdev</span> /<span class="title">dev</span>/<span class="title">ttydata</span> #将这个设备软连接到/<span class="title">dev</span>/<span class="title">ttydata</span>以后每次打开这个<span class="title">ttydata</span>即可</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class"></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;getUSB.py是通过device_usb.txt中的信息，获取到当前挂着在端口3-1.1上的是ttyUSB0还是ttyUSB1并保存在usbdev 中。</p>
<p>getUSB.py如下:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> re  <span class="comment">#正在表达式</span></span><br><span class="line">sss = <span class="built_in">open</span>(<span class="string">&quot;./device_usb.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="comment">#打开device_usb.txt设备，并读取内容</span></span><br><span class="line">www = <span class="built_in">open</span>(<span class="string">&quot;./usbdev&quot;</span>,<span class="string">&quot;wb&quot;</span>)  <span class="comment">#当前路径下创建usbdev文件，后续会写入内容</span></span><br><span class="line">s_read = sss.read()  usb3/<span class="number">3</span>-<span class="number">1</span>/<span class="number">3</span>-<span class="number">1.1</span>/</span><br><span class="line">r = <span class="string">r&quot;usb3/3-1/3-1\.1.+(ttyUSB[0-9])&quot;</span></span><br><span class="line"><span class="comment">#正则中“.”需要转义，所以使用“\.”表示“.”</span></span><br><span class="line"><span class="comment">#这个规则是找到usb3/3-1/3-1.1/这个字符串后面紧跟的是此次上电生成的ttyUSB0或者ttyUSB1</span></span><br><span class="line">output = re.findall(r,s_read)</span><br><span class="line">www.write(output[<span class="number">0</span>]) <span class="comment">#将结果写到usbdev中</span></span><br><span class="line">www.close()</span><br><span class="line">sss.close()</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;完成之后设置开机项目，将文件夹当道一个位置，然后设置开机启动cmd.sh（在/etc/rc.local中设置）则每次开机之后，会从/dev/ttydata获取到固定端口的数据。</p>
<h2 id="4-udev"><a href="#4-udev" class="headerlink" title="4. udev"></a>4. udev</h2><p>&emsp;&emsp;这两天在ubuntu中开发跟串口有关程序时，发现来回拔插串口线或者插多个串口线时总是出现串口号ttyUSB*不固定的问题，给应用程序带来不少麻烦，遂google解决。</p>
<p>&emsp;&emsp;linux中设备号一般按先后顺序一次向后增大，udev规则文件可以解决这个蛋疼的问题。udev是一种Linux2.6内核采用的/dev 目录的管理系统（可以把它认为是windows中的设备管理器），它通过从sysfs获得的信息，可以提供对特定设备的固定的设备名。sysfs是linux 2.6内核的一种新型文件系统，它提供了当前设备的基本信息。</p>
<p>&emsp;&emsp;udev的重要功能就是为为设备提供固定的设备名， 根据Wirting udev rules的详细介绍， udev有如下功能：</p>
<blockquote>
<p>Rename a device node from the default name to something else Provide<br>an alternative/persistent name for a device node by creating a<br>symbolic link to the default device node Name a device node based on<br>the output of a program Change permissions and ownership of a device<br>node Launch a script when a device node is created or deleted<br>(typically when a device is attached or unplugged) Rename network<br>interfaces</p>
</blockquote>
<p>&emsp;&emsp;简单阅读之后创建文件/etc/udev/rules.d/10-local.rule, 内容如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">KERNEL==<span class="string">&quot;ttyUSB*&quot;</span>, ATTRS&#123;idVendor&#125;==<span class="string">&quot;067b&quot;</span>, ATTRS&#123;idProduct&#125;==<span class="string">&quot;2303&quot;</span>, MODE:=<span class="string">&quot;0777&quot;</span>, SYMLINK+=<span class="string">&quot;user_uart&quot;</span></span><br><span class="line">KERNEL==<span class="string">&quot;ttyUSB*&quot;</span>, ATTRS&#123;idVendor&#125;==<span class="string">&quot;1a86&quot;</span>, ATTRS&#123;idProduct&#125;==<span class="string">&quot;7523&quot;</span>, MODE:=<span class="string">&quot;0777&quot;</span>, SYMLINK+=<span class="string">&quot;mcu_uart&quot;</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;意思就是匹配sys中内核名为ttyUSB*的设备，属性匹配依据生产商编号idVendor和产品号idProduct, 设定读写权限为0777。<br>符号链接名为：<br>1、user_uart—–PL2303串口转USB，<br>2、mcu_uart—-CH340串口转USB。</p>
<p>&emsp;&emsp;idVendor和idProduct由 lsusb  -vvv 命令查看。</p>
<p>&emsp;&emsp;保存退出后udev规则就生效了，重新拔插两个串口设备，就可以看到/dev/user_uart指向/dev/ttyUSB0, /dev/mcu_uart指向/dev/ttyUSB1. 这样以来，我只要在程序里打开/dev/user_uart或/dev/mcu_uart就可以一直准确的打开指定的串口设备了。</p>
<p><code>PS：如果您的两个串口用的都是PL2303或者都是CH340/CP2102,那就真的无能为力了。。。</code></p>
<p>常用的匹配类型：</p>
<ul>
<li><p>BUS：匹配总路类型，比如PCI USB等</p>
<ul>
<li>KERNEL：- 匹配Kernel设备名，比如hda hdb.</li>
</ul>
</li>
<li><p>DRIVER ：- 匹配Kernel的驱动程序名</p>
</li>
<li><p>SUBSYSTEM： - 匹配子系统名。</p>
</li>
<li><p>ID ：- 匹配总路系统的ID （e.g. PCI bus ID）。</p>
</li>
<li><p>PLACE ：- 匹配物理位置 （对USB很有用）</p>
</li>
</ul>
<p>资料链接：</p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/ynxf/p/6379449.html">http://www.cnblogs.com/ynxf/p/6379449.html</a></p>
<p><a target="_blank" rel="noopener" href="http://biancheng.dnbcw.net/linux/295328.html">http://biancheng.dnbcw.net/linux/295328.html</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/17/2080/" data-id="ckkfmdgab002svkcga9epds53" data-title="3、Linux常用技巧：解决Linux下USB设备节点ttyUSB名不固定的问题，生成固定USB转串口设备节点" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2059" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/14/2059/" class="article-date">
  <time class="dt-published" datetime="2020-12-14T08:45:00.000Z" itemprop="datePublished">2020-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/14/2059/">实时时钟驱动</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><span style="color:#6a9955">--- 模块功能：BM8563时钟功能测试</span><br/><span style="color:#6a9955">-- @author zwp0273</span><br/><span style="color:#6a9955">-- @module BM8563</span><br/><span style="color:#6a9955">-- @license MIT</span><br/><span style="color:#6a9955">-- @copyright zwp0273</span><br/><span style="color:#6a9955">-- @release 2020.12.14</span><br/><br/><br/><span style="color:#dcdcaa">require</span> <span style="color:#ce9178">&quot;pins&quot;</span><br/><span style="color:#dcdcaa">require</span> <span style="color:#ce9178">&quot;ntp&quot;</span><br/><span style="color:#dcdcaa">module</span><span style="color:#d4d4d4">(</span><span style="color:#569cd6">...</span><span style="color:#d4d4d4">,package.</span><span style="color:#9cdcfe">seeall</span><span style="color:#d4d4d4">)</span><br/><span style="color:#c586c0">local</span><span style="color:#d4d4d4"> i2cslaveaddr = </span><span style="color:#b5cea8">0x51</span><br/><span style="color:#c586c0">local</span><span style="color:#d4d4d4"> i2cid = </span><span style="color:#b5cea8">1</span><br/><span style="color:#c586c0">local</span><span style="color:#d4d4d4"> setdata = {</span><span style="color:#b5cea8">0x00</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x00</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x00</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x01</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x01</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x01</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x014</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x01</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x12</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">0x20</span><span style="color:#d4d4d4">} </span><span style="color:#6a9955">--地址位   秒分时 日 星期 月 年     20年 12月 14日 1时 1分 1秒   星期1   00    14/12/20</span><br/><span style="color:#c586c0">function</span><span style="color:#dcdcaa"> set_BM8563</span><span style="color:#d4d4d4">(</span><span style="color:#9cdcfe">tm</span><span style="color:#d4d4d4">)</span><br/> <br/> <br/> <span style="color:#c586c0">if</span><span style="color:#d4d4d4"> i2c.</span><span style="color:#dcdcaa">setup</span><span style="color:#d4d4d4">(i2cid, i2c.</span><span style="color:#9cdcfe">SLOW</span><span style="color:#d4d4d4">,i2cslaveaddr) ~= i2c.</span><span style="color:#9cdcfe">SLOW</span> <span style="color:#c586c0">then</span><br/> <br/><span style="color:#d4d4d4">            log.</span><span style="color:#dcdcaa">info</span><span style="color:#d4d4d4">(</span><span style="color:#ce9178">&quot;BM8563 设置失败&quot;</span><span style="color:#d4d4d4">)        </span><br/> <span style="color:#c586c0">else</span><br/> <span style="color:#6a9955">--tm.year % 100, tm.month, tm.day, tm.hour, tm.min, tm.sec</span><br/><span style="color:#d4d4d4">            setdata[</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">] = bit.</span><span style="color:#dcdcaa">lshift</span><span style="color:#d4d4d4">(tm.</span><span style="color:#9cdcfe">sec</span><span style="color:#d4d4d4"> / </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + tm.</span><span style="color:#9cdcfe">sec</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">10</span><br/><span style="color:#d4d4d4">            setdata[</span><span style="color:#b5cea8">5</span><span style="color:#d4d4d4">] = bit.</span><span style="color:#dcdcaa">lshift</span><span style="color:#d4d4d4">(tm.</span><span style="color:#9cdcfe">min</span><span style="color:#d4d4d4"> / </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + tm.</span><span style="color:#9cdcfe">min</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">10</span><br/><span style="color:#d4d4d4">            setdata[</span><span style="color:#b5cea8">6</span><span style="color:#d4d4d4">] = bit.</span><span style="color:#dcdcaa">lshift</span><span style="color:#d4d4d4">(tm.</span><span style="color:#9cdcfe">hour</span><span style="color:#d4d4d4"> / </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + tm.</span><span style="color:#9cdcfe">hour</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">10</span><br/><span style="color:#d4d4d4">            setdata[</span><span style="color:#b5cea8">7</span><span style="color:#d4d4d4">] = bit.</span><span style="color:#dcdcaa">lshift</span><span style="color:#d4d4d4">(tm.</span><span style="color:#9cdcfe">day</span><span style="color:#d4d4d4"> / </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + tm.</span><span style="color:#9cdcfe">day</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">10</span><br/><span style="color:#d4d4d4">            setdata[</span><span style="color:#b5cea8">9</span><span style="color:#d4d4d4">] = bit.</span><span style="color:#dcdcaa">lshift</span><span style="color:#d4d4d4">(tm.</span><span style="color:#9cdcfe">month</span><span style="color:#d4d4d4"> / </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + tm.</span><span style="color:#9cdcfe">month</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">10</span><br/><span style="color:#d4d4d4">            setdata[</span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4">] = bit.</span><span style="color:#dcdcaa">lshift</span><span style="color:#d4d4d4">(tm.</span><span style="color:#9cdcfe">year</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">100</span><span style="color:#d4d4d4"> / </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4">,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + tm.</span><span style="color:#9cdcfe">year</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">100</span><span style="color:#d4d4d4"> % </span><span style="color:#b5cea8">10</span><br/><br/><span style="color:#d4d4d4">            i2c.</span><span style="color:#dcdcaa">send</span><span style="color:#d4d4d4">(i2cid,i2cslaveaddr,setdata)</span><br/><span style="color:#d4d4d4">            log.</span><span style="color:#dcdcaa">info</span><span style="color:#d4d4d4">(</span><span style="color:#ce9178">&quot;BM8563 设置成功&quot;</span><span style="color:#d4d4d4">)</span><br/> <span style="color:#c586c0">end</span><br/><span style="color:#d4d4d4">        i2c.</span><span style="color:#dcdcaa">close</span><span style="color:#d4d4d4">(i2cid)</span><br/> <br/><br/><span style="color:#c586c0">end</span><br/><br/><span style="color:#569cd6">local </span><span style="color:#c586c0">function</span><span style="color:#dcdcaa"> read_BM8563</span><span style="color:#d4d4d4">()</span><br/> <span style="color:#6a9955">---set_time()</span><br/> <br/> <span style="color:#c586c0">if</span><span style="color:#d4d4d4"> i2c.</span><span style="color:#dcdcaa">setup</span><span style="color:#d4d4d4">(i2cid, i2c.</span><span style="color:#9cdcfe">SLOW</span><span style="color:#d4d4d4">,i2cslaveaddr) ~= i2c.</span><span style="color:#9cdcfe">SLOW</span> <span style="color:#c586c0">then</span><br/> <br/><span style="color:#d4d4d4">        log.</span><span style="color:#dcdcaa">info</span><span style="color:#d4d4d4">(</span><span style="color:#ce9178">&quot;BM8563 打开失败&quot;</span><span style="color:#d4d4d4">)        </span><br/> <span style="color:#c586c0">else</span><br/><br/><span style="color:#d4d4d4">        i2c.</span><span style="color:#dcdcaa">send</span><span style="color:#d4d4d4">(i2cid,i2cslaveaddr,{</span><span style="color:#b5cea8">0x02</span><span style="color:#d4d4d4">})</span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> data = i2c.</span><span style="color:#dcdcaa">recv</span><span style="color:#d4d4d4">(i2cid, i2cslaveaddr, </span><span style="color:#b5cea8">7</span><span style="color:#d4d4d4">)  </span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> _,D1,D2,D3,D4,D5,D6,D7 = pack.</span><span style="color:#dcdcaa">unpack</span><span style="color:#d4d4d4">(data, </span><span style="color:#ce9178">&#x27;b7&#x27;</span><span style="color:#d4d4d4">)</span><br/><span style="color:#d4d4d4">        D1 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D1,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D1,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 秒</span><br/><span style="color:#d4d4d4">        D2 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D2,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D2,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 分</span><br/><span style="color:#d4d4d4">        D3 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D3,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D3,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 小时</span><br/><span style="color:#d4d4d4">        D4 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D4,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D4,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 日</span><br/><span style="color:#d4d4d4">        D5 = bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D5,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 星期</span><br/><span style="color:#d4d4d4">        D6 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D6,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D6,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 月</span><br/><span style="color:#d4d4d4">        D7 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D7,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D7,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 年</span><br/><span style="color:#d4d4d4">        log.</span><span style="color:#dcdcaa">info</span><span style="color:#d4d4d4">(</span><span style="color:#ce9178">&quot;BM8563 read&quot;</span><span style="color:#d4d4d4">,D7,D6,D4,D3,D2,D1)</span><br/> <span style="color:#c586c0">end</span><br/><span style="color:#d4d4d4">    i2c.</span><span style="color:#dcdcaa">close</span><span style="color:#d4d4d4">(i2cid)</span><br/> <br/> <br/><span style="color:#c586c0">end</span><br/><br/><span style="color:#569cd6">local </span><span style="color:#c586c0">function</span><span style="color:#dcdcaa"> BM8563_to_local</span><span style="color:#d4d4d4">()</span><br/> <span style="color:#6a9955">---set_time()</span><br/> <br/> <span style="color:#c586c0">if</span><span style="color:#d4d4d4"> i2c.</span><span style="color:#dcdcaa">setup</span><span style="color:#d4d4d4">(i2cid, i2c.</span><span style="color:#9cdcfe">SLOW</span><span style="color:#d4d4d4">,i2cslaveaddr) ~= i2c.</span><span style="color:#9cdcfe">SLOW</span> <span style="color:#c586c0">then</span><br/> <br/><span style="color:#d4d4d4">        log.</span><span style="color:#dcdcaa">info</span><span style="color:#d4d4d4">(</span><span style="color:#ce9178">&quot;BM8563 打开失败&quot;</span><span style="color:#d4d4d4">)        </span><br/> <span style="color:#c586c0">else</span><br/><br/><span style="color:#d4d4d4">        i2c.</span><span style="color:#dcdcaa">send</span><span style="color:#d4d4d4">(i2cid,i2cslaveaddr,{</span><span style="color:#b5cea8">0x02</span><span style="color:#d4d4d4">})</span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> data = i2c.</span><span style="color:#dcdcaa">recv</span><span style="color:#d4d4d4">(i2cid, i2cslaveaddr, </span><span style="color:#b5cea8">7</span><span style="color:#d4d4d4">)  </span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> _,D1,D2,D3,D4,D5,D6,D7 = pack.</span><span style="color:#dcdcaa">unpack</span><span style="color:#d4d4d4">(data, </span><span style="color:#ce9178">&#x27;b7&#x27;</span><span style="color:#d4d4d4">)</span><br/><span style="color:#d4d4d4">        D1 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D1,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D1,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 秒</span><br/><span style="color:#d4d4d4">        D2 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D2,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D2,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 分</span><br/><span style="color:#d4d4d4">        D3 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D3,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D3,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 小时</span><br/><span style="color:#d4d4d4">        D4 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D4,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D4,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 日</span><br/><span style="color:#d4d4d4">        D5 = bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D5,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 星期</span><br/><span style="color:#d4d4d4">        D6 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D6,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D6,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 月</span><br/><span style="color:#d4d4d4">        D7 = </span><span style="color:#b5cea8">10</span><span style="color:#d4d4d4"> * bit.</span><span style="color:#dcdcaa">rshift</span><span style="color:#d4d4d4">(D7,</span><span style="color:#b5cea8">4</span><span style="color:#d4d4d4">) + bit.</span><span style="color:#dcdcaa">band</span><span style="color:#d4d4d4">(D7,</span><span style="color:#b5cea8">0x0f</span><span style="color:#d4d4d4">) </span><span style="color:#6a9955">-- 年</span><br/><span style="color:#d4d4d4">        misc.</span><span style="color:#dcdcaa">setClock</span><span style="color:#d4d4d4">({year=</span><span style="color:#b5cea8">2000</span><span style="color:#d4d4d4"> + D7,month=D6,day=D4,hour=D3,min=D2,sec=D1})</span><br/><span style="color:#d4d4d4">        log.</span><span style="color:#dcdcaa">info</span><span style="color:#d4d4d4">(</span><span style="color:#ce9178">&quot;BM8563 local&quot;</span><span style="color:#d4d4d4">,D7,D6,D4,D3,D2,D1)</span><br/> <span style="color:#c586c0">end</span><br/><span style="color:#d4d4d4">    i2c.</span><span style="color:#dcdcaa">close</span><span style="color:#d4d4d4">(i2cid)</span><br/> <br/><span style="color:#c586c0">end</span><br/><span style="color:#569cd6">local </span><span style="color:#c586c0">function</span><span style="color:#dcdcaa"> time</span><span style="color:#d4d4d4">()</span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> rc = </span><span style="color:#569cd6">false</span><br/><br/> <span style="color:#dcdcaa">BM8563_to_local</span><span style="color:#d4d4d4">()</span><br/> <span style="color:#c586c0">while</span> <span style="color:#569cd6">true</span> <span style="color:#c586c0">do</span> <br/> <br/> <span style="color:#c586c0">if</span><span style="color:#d4d4d4"> ntp.</span><span style="color:#dcdcaa">isEnd</span><span style="color:#d4d4d4">() == </span><span style="color:#569cd6">true</span> <span style="color:#c586c0">and</span><span style="color:#d4d4d4"> rc == </span><span style="color:#569cd6">false</span> <span style="color:#c586c0">then</span><br/> <span style="color:#c586c0">local</span><span style="color:#d4d4d4"> tm = misc.</span><span style="color:#dcdcaa">getClock</span><span style="color:#d4d4d4">()</span><br/> <span style="color:#dcdcaa">set_BM8563</span><span style="color:#d4d4d4">(tm)</span><br/><span style="color:#d4d4d4">            rc = </span><span style="color:#569cd6">true</span><br/> <span style="color:#c586c0">end</span><br/> <span style="color:#c586c0">if</span><span style="color:#d4d4d4"> rc </span><span style="color:#c586c0">then</span> <span style="color:#dcdcaa">read_BM8563</span><span style="color:#d4d4d4">() </span><span style="color:#c586c0">end</span><br/><span style="color:#d4d4d4">        sys.</span><span style="color:#dcdcaa">wait</span><span style="color:#d4d4d4">(</span><span style="color:#b5cea8">1000</span><span style="color:#d4d4d4">)</span><br/> <span style="color:#c586c0">end</span><br/><br/><span style="color:#c586c0">end</span><br/><br/><br/><span style="color:#d4d4d4">sys.</span><span style="color:#dcdcaa">taskInit</span><span style="color:#d4d4d4">(time)</span></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/14/2059/" data-id="ckkfmdgea00cgvkcghuue1s8v" data-title="实时时钟驱动" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2055" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/14/2055/" class="article-date">
  <time class="dt-published" datetime="2020-12-14T04:53:35.000Z" itemprop="datePublished">2020-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/14/2055/">浅谈对BFC的理解</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="浅谈对BFC的理解"><a href="#浅谈对BFC的理解" class="headerlink" title="浅谈对BFC的理解"></a>浅谈对BFC的理解</h1><p>对于前端开发人员来说肯定是知道盒模型（margin,border, padding, content）这个概念，对一个元素设置CSS，首先需要知道这个元素是block还是inline类型。而BFC就是用来格式化块级盒子，同样管理inline类型的盒子还有IFC，以及其他的FC。</p>
<h2 id="1-FC的概念。"><a href="#1-FC的概念。" class="headerlink" title="1. FC的概念。"></a>1. FC的概念。</h2><p>　  Formatting Context：指页面中的一个渲染区域，并且拥有一套渲染规则，他决定了其子元素如何定位，以及与其他元素的相互关系和作用。</p>
<h2 id="2-什么是BFC"><a href="#2-什么是BFC" class="headerlink" title="2. 什么是BFC"></a>2. 什么是BFC</h2><h3 id="2-1-概念"><a href="#2-1-概念" class="headerlink" title="2.1 概念"></a>2.1 概念</h3><p>块级格式化上下文，它是指一个独立的块级渲染区域，只有Block-level BOX参与，该区域拥有一套渲染规则来约束块级盒子的布局，且与区域外部无关。</p>
<p><span style="color:red">注意：</span> BFC 是W3C  CSS 2.1 规范中的一个概念，在CSS3中被修改为float root。</p>
<h3 id="2-2-BFC的生成"><a href="#2-2-BFC的生成" class="headerlink" title="2.2 BFC的生成"></a>2.2 BFC的生成</h3><ol>
<li>浮动元素（float: left | right）</li>
<li>绝对定位元素（position： absolute | fixed）</li>
<li>overflow的值不为visible</li>
<li>行内块元素（display：inline-block）</li>
<li>表格单元格（display：table-cells，td， th）</li>
<li>表格的标题（display：table-captions）</li>
<li><span style="color:red">注意：</span><ul>
<li>disable：table之所以也可以是因为table默认会生成一个匿名的table-cell。正是因为匿名的table-cell生成了BFC</li>
<li>是这些元素创建了BFC，他们本身不是BFC</li>
</ul>
</li>
</ol>
<h3 id="2-3-BFC的约束规则"><a href="#2-3-BFC的约束规则" class="headerlink" title="2.3 BFC的约束规则"></a>2.3 BFC的约束规则</h3><ol>
<li><p>浏览器对于BFC这块区域的约束规则如下：</p>
<ul>
<li>生成BFC元素的子元素会一个接一个的放置。垂直方向上他们的起点是一个包含块的顶部，两个相邻子元素之间的垂直距离取决于元素的margin特性。在BFC中相邻的块级元素外边距会折叠<span style="color:red">(即margin重叠)</span>。</li>
<li>生成BFC元素的子元素中，每一个子元素做外边距与包含块的左边界相接触，（对于从右到左的格式化，右外边距接触右边界），即使浮动元素也是如此（尽管子元素的内容区域会由于浮动而压缩），除非这个子元素也创建了一个新的BFC（如它自身也是一个浮动元素）</li>
</ul>
</li>
<li><p>网友解析</p>
<ul>
<li><p>内部的Box会在垂直方向上一个接一个的放置</p>
</li>
<li><p>垂直方向上的距离由margin决定。（完整的说法是：属于同一个BFC的两个相邻Box的margin会发生重叠，与方向无关。）</p>
</li>
<li><p>每个元素的左外边距与包含块的左边界相接触（从左向右），即使浮动元素也是如此。（这说明BFC中子元素不会超出他的包含块，而position为absolute的元素可以超出他的包含块边界）</p>
</li>
<li><p>BFC的区域不会与float的元素区域重叠</p>
</li>
<li><p>计算BFC的高度时，浮动子元素也参与计算</p>
</li>
<li><p>BFC就是页面上的一个隔离的独立容器，容器里面的子元素不会影响到外面元素，反之亦然</p>
</li>
</ul>
</li>
<li><p>css相关规则</p>
<ul>
<li>Block元素会扩展到与父元素同宽，所以block元素会垂直排列</li>
<li>垂直方向上的两个相邻DIV的margin会重叠，而水平方向不会(此规则并不完全正确)</li>
<li>浮动元素会尽量接近往左上方（或右上方）</li>
<li>为父元素设置overflow：hidden或浮动父元素，则会包含浮动元素</li>
</ul>
</li>
</ol>
<h3 id="2-4-BFC的应用"><a href="#2-4-BFC的应用" class="headerlink" title="2.4 BFC的应用"></a>2.4 BFC的应用</h3><ol>
<li><p>防止margin重叠</p>
<ul>
<li><p>案例上下margin重叠</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> * @Autor: Clairoll</span></span><br><span class="line"><span class="comment"> * @Date: 2020-12-14 11:18:24</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2020-12-14 11:39:56</span></span><br><span class="line"><span class="comment"> * @Email: 1755033445@qq.com</span></span><br><span class="line"><span class="comment"> * @description:</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body &#123;</span><br><span class="line">        height: 100%;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-id">#map</span> &#123;</span></span><br><span class="line">        padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.first</span> &#123;</span></span><br><span class="line">        margin: 20px;</span><br><span class="line">        background: lightgreen;</span><br><span class="line">        width: 100px;</span><br><span class="line">        height: 100px;</span><br><span class="line">    &#125;</span><br><span class="line">    ul &#123;</span><br><span class="line"><span class="css">        <span class="comment">/* display:inline-block; */</span></span></span><br><span class="line">        margin: 10px;</span><br><span class="line">        background: lightblue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">        margin: 25px;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;first&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201214125300755_margin%E9%87%8D%E5%8F%A0.png" alt="undefined" title="undefined"></p>
</li>
<li><p>解决</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment"> * @Autor: Clairoll</span></span><br><span class="line"><span class="comment"> * @Date: 2020-12-14 11:18:24</span></span><br><span class="line"><span class="comment"> * @LastEditTime: 2020-12-14 11:44:53</span></span><br><span class="line"><span class="comment"> * @Email: 1755033445@qq.com</span></span><br><span class="line"><span class="comment"> * @description:</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">    html,</span><br><span class="line">    body &#123;</span><br><span class="line">        height: 100%;</span><br><span class="line">        width: 100%;</span><br><span class="line">        margin: 0;</span><br><span class="line">        padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-id">#map</span> &#123;</span></span><br><span class="line">        padding: 0;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="css">    <span class="selector-class">.first</span> &#123;</span></span><br><span class="line">        margin: 20px;</span><br><span class="line">        background: lightgreen;</span><br><span class="line">        width: 100px;</span><br><span class="line">        height: 100px;</span><br><span class="line">    &#125;</span><br><span class="line">    ul &#123;</span><br><span class="line"><span class="css">        <span class="selector-tag">display</span><span class="selector-pseudo">:inline-block</span>; // 通过此处生成<span class="selector-tag">BFC</span></span></span><br><span class="line"><span class="css">       <span class="comment">/* overflow:hidden; */</span></span></span><br><span class="line"><span class="css">       <span class="comment">/*float: left;*/</span></span></span><br><span class="line"><span class="css">       <span class="comment">/*position: absolute;*/</span></span></span><br><span class="line">        margin: 10px;</span><br><span class="line">        background: lightblue;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    li &#123;</span><br><span class="line">        margin: 25px;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">class</span>=<span class="string">&quot;claro&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;first&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>1<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>2<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">li</span>&gt;</span>3<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201214125315695_%E8%A7%A3%E5%86%B3.png" alt="undefined" title="undefined"></p>
</li>
</ul>
</li>
<li><p>浮动相关布局问题</p>
</li>
<li><p>多栏布局</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/14/2055/" data-id="ckkfmdgaa002rvkcgfiap6kx1" data-title="浅谈对BFC的理解" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2054" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/14/2054/" class="article-date">
  <time class="dt-published" datetime="2020-12-14T03:36:55.000Z" itemprop="datePublished">2020-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/14/2054/"> 合宙wifi模块air640w--pwm</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h1><p>Air640W 是基于嵌入式 Wi-Fi SoC 芯片（W600）设计的 Wi-Fi 参考设计模块，邮票孔加插针孔式接口设计，封装上兼容我司模块Air640，尺寸小，易开发。模块适用于智能家电、智能家居、无线音视频、智能玩具、医疗监护、工业控制等物联网应用领域。本规格书规定了该模块的物理特性、技术指标、通信协设备控制器，工作时钟范围议、产品功能、性能、稳定性、环境适应性以及安全性等方面的技术标准。</p>
<h2 id="1-接口"><a href="#1-接口" class="headerlink" title="1.接口"></a>1.接口</h2><p>⚫    邮票孔与插针孔复合式接口，间距 2.0mm<br>⚫    UART0固件烧录口，波特率固定115200<br>⚫    UART1调试接口，支持硬件流控，波特率范围1200bps<del>2Mbps，默认为115200<br>⚫    1 个高速 SPI  0</del>50MHz<br>⚫    集成 GPIO 控制器</p>
<h2 id="2-固件下载"><a href="#2-固件下载" class="headerlink" title="2.固件下载"></a>2.固件下载</h2><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201214113458796_51.png" alt="undefined" title="undefined"><br>群文件第一个为支持pwm的固件</p>
<h2 id="3-固件烧录"><a href="#3-固件烧录" class="headerlink" title="3.固件烧录"></a>3.固件烧录</h2><p><code>https://yajs666.gitee.io/2020/11/27/air640w%20-demo/</code><br>固件烧录方法请参照上篇demo烧录文章</p>
<h2 id="4-修改脚本"><a href="#4-修改脚本" class="headerlink" title="4.修改脚本"></a>4.修改脚本</h2><p>首先修改local.ini文件夹下你对应的开发板端口<br>如：COM_PORT = COM4<br><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201214113531875_52.png" alt="undefined" title="undefined"><br>在user文件夹下的mian.lua脚本下加如下代码</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">sys.taskInit(function()</span><br><span class="line">    while 1 do</span><br><span class="line">        -- 仿呼吸灯效果</span><br><span class="line">        log.info(&quot;pwm&quot;, &quot;&gt;&gt;&gt;&gt;&gt;&quot;)</span><br><span class="line">        for i &#x3D; 10,1,-1 do</span><br><span class="line">            pwm.open(5, 1000, i*9) -- 5 通道, 频率1000hz, 占空比0-100</span><br><span class="line">            sys.wait(200 + i*10)</span><br><span class="line">        end</span><br><span class="line">        for i &#x3D; 10,1,-1 do</span><br><span class="line">            pwm.open(5, 1000, 100 - i*9)</span><br><span class="line">            sys.wait(200 + i*10)</span><br><span class="line">        end</span><br><span class="line">        sys.wait(5000)</span><br><span class="line">        --pwm.open(5, 1000, 50)</span><br><span class="line">    end</span><br><span class="line">end)</span><br></pre></td></tr></table></figure>
<h3 id="烧录脚本"><a href="#烧录脚本" class="headerlink" title="烧录脚本"></a>烧录脚本</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201214113553370_53.png" alt="undefined" title="undefined"><br>将<code>python air640w.py lfs dlfs</code>输入终端并且回车，等待烧录完成</p>
<h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201214113613476_1.jpg" alt="undefined" title="undefined"><br>呼吸灯效果</p>
<h3 id="群文件资料下载"><a href="#群文件资料下载" class="headerlink" title="群文件资料下载"></a>群文件资料下载</h3><p>推荐加入QQ交流群下载咨询问题：966019084</p>
<h2 id="欢迎交流"><a href="#欢迎交流" class="headerlink" title="欢迎交流"></a>欢迎交流</h2><p>本人csdn，b站，gitee及QQ交流群后面都会挂上。<br>友情链接里面都是大佬的博客，有时候百度真不如去看看他们的文章，欢迎大家去学习。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/14/2054/" data-id="ckkfmdgaa002pvkcgedagbc2k" data-title=" 合宙wifi模块air640w--pwm" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2053" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/14/2053/" class="article-date">
  <time class="dt-published" datetime="2020-12-14T02:27:35.000Z" itemprop="datePublished">2020-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/14/2053/">对爬虫采集器的认知</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>网络爬虫通过统一资源定位符URL (Uniform ResourceLocator)来查找目标网页，将用户所关注的数据内容直接返回给用户，并不需要用户以浏览网页的形式去获取信息，为用户节省了时间和精力，并提高了数据采集的准确度，使用户在海量数据中游刃有余。网络爬虫的最终目的就是从网页中获取自己所需的信息。一些爬虫基本库可以开发一个爬虫程序，获取到所需的内容，但是所有的爬虫程序都以这种方式进行编写，工作量未免太大了些，所有才有了爬虫框架。使用爬虫框架可以大大提高效率，缩短开发时间。</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201214102340268_wx_article_20190206222137_gsdv1M.jpg" alt="undefined" title="undefined"></p>
<p>当下是大数据时代，在这个信息爆炸的时代，我们可以利用爬虫获取大量有价值的数据，通过数据分析获得更多隐性的有价值的规律。</p>
<p>用途广泛。针对电商来说，抓取各种商品信息就可以做到精细化运营，精准营销。对新闻资讯平台和搜索引擎来说，抓取其他平台原创新闻稿，进行热点分析，就可以合理筛选优质内容，打造更有价值的新闻平台。（还可以抓取车票、爬取论文素材等等。已经与我们的生活结合在一起了。）</p>
<h3 id="通用爬虫"><a href="#通用爬虫" class="headerlink" title="通用爬虫"></a>通用爬虫</h3><p>通用网络爬虫 是 捜索引擎抓取系统（Baidu、Google、Yahoo等）的重要组成部分。主要目的是将互联网上的网页下载到本地，形成一个互联网内容的镜像备份。</p>
<h3 id="聚焦爬虫"><a href="#聚焦爬虫" class="headerlink" title="聚焦爬虫"></a>聚焦爬虫</h3><p>聚焦爬虫，是”面向特定主题需求”的一种网络爬虫程序，它与通用搜索引擎爬虫的区别在于： 聚焦爬虫在实施网页抓取时会对内容进行处理筛选，尽量保证只抓取与需求相关的网页信息。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/14/2053/" data-id="ckkfmdgaa002qvkcg7z36d4e1" data-title="对爬虫采集器的认知" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2052" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/14/2052/" class="article-date">
  <time class="dt-published" datetime="2020-12-14T02:25:18.000Z" itemprop="datePublished">2020-12-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/14/2052/">ES2020可选链(?.)的初步使用</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>吐槽：<br>前端开发过程中，大多数情况下会存在一个很“尴尬”的现象；访问对象属性（特别是深层次的访问obj的对象属性）时遇到undefined、报错等情况，让开发人员不得不去进行数据的判定，防止代码页面崩溃…很常见的一种就是在访问对象中某个不存在的属性，可能要进行多次的 &amp;&amp; 或者 if判断才能达到目的</p>
<p>结合场景：<br>最近一段时间在进行某个订单系统的开发，其中牵涉到很多对象属性访问，目前统一使用 &amp;&amp; 进行开发（存在访问重复属性字段），让人看起来很不舒服（开发过程中，对对象中不一定存在的属性进行访问，导致报错，页面崩了塞…）。</p>
<p>思考：有没有什么方法能快速、简捷的方式来实现对对象属性的判定访问呢？查阅资料…</p>
<p>目前我知道的解决方案有三种：<br>1、if<br>2、&amp;&amp;<br>3、**?.**  (<strong>可选链</strong>：是一种访问嵌套对象属性的安全的方式。即使中间的属性不存在，也不会出现错误。)</p>
<p>前两者大家都已经比较熟悉了，if &amp;&amp; 唯一不好的地方就是代码量太多，而且存在重复访问属性，不够<strong>优雅</strong>。<br><br /></p>
<p>这里以 &amp;&amp; 为例（xxx开发需求）：<br><code>user.[key1].[key2].[key3]... =&gt;user.[key1] &amp;&amp; user.[key1].[key2]&amp;&amp; user.[key1].[key2].[key3]...</code>无奈（这种方式代码逻辑是比较清晰的，逐个进行访问）</p>
<p>。。。那有没有更简洁的方式实现呢？下面让我们看一下使用<br> <strong>?.</strong>  是如何实现滴</p>
<p>最直接的表达方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;声明变量</span><br><span class="line">let userF &#x3D; &#123;&#125;</span><br><span class="line">let userS &#x3D; &#123;</span><br><span class="line">              name : &#123;</span><br><span class="line">                   firstName:&#39;合宙&#39;,</span><br><span class="line">                   secondName:&#39;NB&#39;,</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p>正常访问一个对象属性很常见：<code>userS .name.firstName</code>。。。</p>
<p>假如是个空对象进行访问呢。大家很清楚都能看到userF这就是一个空的对象，里面不存在任何属性，这个时候如果你进行属性访问会出现什么情况呢？可想而知：errror，例如：<code>userF .name.firstName </code>（开发会存在这种情况）</p>
<p>使用 ?. 进行访问：<code>userF .name ?.firstName</code> 这样就不会报错了（虽然）：<br><code>userF .name =&gt; undefined</code><br>ps: ?. 左边是undefined/null 时，不会再进行后面的运算（访问），同时并返回当前的值 <code>userF .name ?.firstName =&gt; undefined</code>（不会报错）</p>
<p>注意：<br>1、使用 ?. 时，运算符左边的变量必须是声明过的<br>2、?. 运算符，只会让左边的值设为可选值，并不会影响右边的值<br>3、不要滥用 ?.  很容易造成调试开发上的困难</p>
<p>其中 ?. 还存在两种不一样的变体：?.() |  ?.[]<br>?.() : 判定函数是否存在，存在则调用 不存在则返回undefined<br>?.[] : 访问对象的属性的一种方法（在前端访问对象属性时，普遍使用类似：obj.key 进行访问，也可通过【】进行访问，效果相同）</p>
<p><strong>空判断操作符</strong>(??)<br>简单解释一下：当使用  ??  运算符时，只要左边不是null/undefined，就会返回右边值；<br>比如：<br><code>&quot;&quot; ??  &quot;a&quot;   =====&gt;&quot;&quot;</code><br><code>0 ??  &quot;a&quot;   =====&gt;0</code><br><code>null ??  &quot;a&quot;   =====&gt;&quot;a&quot;</code><br><code>undefined ??  &quot;a&quot;   =====&gt;&quot;a&quot;</code><br>这个时候可能会有人问：什么情况下会用到这个 ?? 运算符呢？？？<br>场景：需要返回 <code>0 或 “”</code><br>ps:有兴趣的小伙伴可以了解一下 <code>?? 和 ||</code> 的不同点在哪！！！</p>
<p>运算扩展：<br>常用<strong>取整</strong>方式：（不知道大家对一下其中几种了解过呢）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;常见</span><br><span class="line">parseInt(&quot;1.5555&quot;) &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line">1.5555.toFixed(0)  &#x2F;&#x2F; &#x3D;&gt; &quot;2&quot;</span><br><span class="line">Math.ceil(1.5555) &#x2F;&#x2F; &#x3D;&gt; 2</span><br><span class="line">Math.floor(1.5555) &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line">Math.round(1.5555) &#x2F;&#x2F; &#x3D;&gt; 2</span><br><span class="line">Math.round(1.4999) &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line">Math.trunc(1.5555) &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;不常见</span><br><span class="line">双按位非取整</span><br><span class="line">&#x2F;&#x2F; 利用位运算取整</span><br><span class="line">~~1.5555 &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;按位运或取整</span><br><span class="line">1.5555 | 0  &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;按位异或取整</span><br><span class="line">1.5555^0  &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F;左移0位取整</span><br><span class="line">1.5555&lt;&lt;0 &#x2F;&#x2F; &#x3D;&gt; 1</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ps:其中按位运算，是进一步优化性能的操作（Math相关方法与位运算性能无异）</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/14/2052/" data-id="ckkfmdga9002nvkcgg7c3hfnx" data-title="ES2020可选链(?.)的初步使用" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2047" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/12/2047/" class="article-date">
  <time class="dt-published" datetime="2020-12-12T13:01:31.000Z" itemprop="datePublished">2020-12-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/12/2047/">Air302自定义编译ec固件教程</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Air302自定义编译ec固件教程"><a href="#Air302自定义编译ec固件教程" class="headerlink" title="Air302自定义编译ec固件教程"></a>Air302自定义编译ec固件教程</h1><h3 id="一、前述"><a href="#一、前述" class="headerlink" title="一、前述"></a>一、前述</h3><p>编译使用的是官方提供的SDK，但这个SDK不是C-SDK，只是可以自定义LuatOS的固件，不要搞混了！！！</p>
<p>如果你想精简或增加底层固件功能，才会需要这个教程，一般正常使用不需要自行编译，直接使用官方release出的正式固件即可。</p>
<h3 id="二、编译环境配置"><a href="#二、编译环境配置" class="headerlink" title="二、编译环境配置"></a>二、编译环境配置</h3><p>1、Keil5（版本不限吧，我用的5.29，只是用keil5的armcc工具）</p>
<p>2、windows系统 要64位 win7 win10都行</p>
<p>3、硬盘剩余空间大于2G</p>
<p>4、安装python3.7</p>
<h3 id="三、开始编译"><a href="#三、开始编译" class="headerlink" title="三、开始编译"></a>三、开始编译</h3><h4 id="1、下载LuatOS源码"><a href="#1、下载LuatOS源码" class="headerlink" title="1、下载LuatOS源码"></a>1、下载LuatOS源码</h4><p>首先保证你的电脑上有git，当然，下载zip文件解压也可以（就是很麻烦咯）。</p>
<p>在git命令窗口里面输入 git clone <a target="_blank" rel="noopener" href="https://gitee.com/openLuat/LuatOS.git">https://gitee.com/openLuat/LuatOS.git</a></p>
<p>运行完是这样的</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205606906_git.png" alt="git" title="git"></p>
<h4 id="2、下载release的sdk"><a href="#2、下载release的sdk" class="headerlink" title="2、下载release的sdk"></a>2、下载release的sdk</h4><p>这里以最新的V0004固件为例</p>
<p><a target="_blank" rel="noopener" href="https://gitee.com/openLuat/LuatOS/releases/v0004_air302">链接直达</a></p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205620507_release.png" alt="release" title="release"></p>
<p>这两个都下载下来（V0004固件是为了要里面的FlashToolCLI，SDK是要进行编译的文件）</p>
<h4 id="3、解压文件"><a href="#3、解压文件" class="headerlink" title="3、解压文件"></a>3、解压文件</h4><p>先进入源码路径  LuatOS/bsp/air302</p>
<p>把SDK和FlashToolCLI解压到这个文件夹中</p>
<p>解压完应该是这样的</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205640489_mulu.png" alt="mulu" title="mulu"></p>
<p>最后确定一下，目录结构</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205652676_mulu2.png" alt="mulu2" title="mulu2"></p>
<h4 id="4、修改配置文件"><a href="#4、修改配置文件" class="headerlink" title="4、修改配置文件"></a>4、修改配置文件</h4><p>1、在air302目录下新建local.ini文件</p>
<p>输入以下字样</p>
<p><code>[air302] PLAT_ROOT = air302_sdk\PLAT\</code></p>
<p>2、进入PLAT目录里面找到<code>KeilBuild.bat</code>，用你习惯的软件打开</p>
<p>修改第10行的keil目录为你的安装目录</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205730033_keil5.png" alt="keil5" title="keil5"></p>
<p>3、修改Makefile（在上面的结构图里能找到位置）</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205741061_Makefile%E4%BF%AE%E6%94%B9.png" alt="Makefile" title="Makefile"></p>
<p>第一个LUATOS_SRC为你下载到本地的仓库的地址</p>
<p>第二个LUATOS_XSRC为本地仓库的上层目录</p>
<p>截图为我的目录，仅供参考。</p>
<h4 id="5、执行编译操作"><a href="#5、执行编译操作" class="headerlink" title="5、执行编译操作"></a>5、执行编译操作</h4><p>回到air302目录下，按住shift右键，打开powershell或者cmd</p>
<p>输入指令<code>python air302.py build pkg</code></p>
<p>然后就会开始自动编译，成功后会显示pass</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205800733_%E7%BC%96%E8%AF%91%E5%AE%8C%E6%88%90.png" alt="undefined" title="undefined"></p>
<p>这样默认配置的编译就完成了，编译好的量产文件在air302目录下的量产文件目录里面，是个zip文件</p>
<p>打开是这样的</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205810591_ec.png" alt="undefined" title="undefined"></p>
<p>如果你想看编译直接出来的bin文件进入到<code>air302_sdk\PLAT\out\ec616_0h00\air302</code>目录就可以看到了</p>
<p>（PS：ec固件其实就是一个zip压缩文件，解压后会看见bin文件，至于为什么改成ec，应该是为了刷写工具好识别而为）</p>
<h3 id="四、自定义部分"><a href="#四、自定义部分" class="headerlink" title="四、自定义部分"></a>四、自定义部分</h3><p>打开air302目录下面的src文件夹，里面有一个<code>luat_air302_base.c</code>文件</p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205818587_c.png" alt="undefined" title="undefined"></p>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20201212205825581_c2.png" alt="undefined" title="undefined"></p>
<p>这些就是可以自己改的部分，可以选择精简或者增加模块</p>
<p>修改完之后在进行编译皆可获得自定义的固件了。</p>
<hr>
<p>这期教程到此结束了，本人能力有限，如有错误请在文章下面提出来，谢谢大家。</p>
<hr>
<p>作者：梦程MI</p>
<p><a target="_blank" rel="noopener" href="https://www.dreamcstudio.cn/">个人博客</a></p>
<p><a target="_blank" rel="noopener" href="https://space.bilibili.com/88809897">B站</a></p>
<p>2020.12.12</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/12/2047/" data-id="ckkfmdga9002mvkcgcuja43dq" data-title="Air302自定义编译ec固件教程" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2033" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2020/12/10/2033/" class="article-date">
  <time class="dt-published" datetime="2020-12-10T04:41:07.000Z" itemprop="datePublished">2020-12-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2020/12/10/2033/">17、RDA8910(4GCAT1)CSDK二次开发：一个简易的AT框架---可以实现自定义AT指令了</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44570083/article/details/104285283">点击这里查看所有博文</a></p>
<p>&emsp;&emsp;本系列博客所述资料<code>均来自合宙官方</code>，并不是本人原创（只有博客是自己写的），csdk只是得到了<code>口头的允许公开授权</code>。出于热心，本人将自己的所学笔记整理并推出相对应的使用教程，方面其他人学习。为国内的物联网事业发展尽自己的一份绵薄之力，<code>没有为自己谋取私利的想法</code>。若出现侵权现象，请告知本人，本人会立即停止更新，并删除相应的文章和代码。</p>
<p>&emsp;&emsp;本系列博客基于紫光展锐的<code>RDA8910  LTE Cat 1</code> bis芯片平台开发。理论上适用于合宙的Air720U、Air724U、广和通L610以及安信可的cat-01模块。</p>
<p>&emsp;&emsp;各个厂家的部分配置文件可能不一样，也许会导致设备出现奇怪的问题，其他的模块我也不确定能不能用，自行测试。但是有一点<code>编译下载和监视流程基本一样</code>，可供参考。</p>
<p>&emsp;&emsp;先不管支不支持，如果你用的模块是是紫光展锐的RDA8910，那都不妨一试，也许会有意外收获（<code>也有可能变砖，慎重！！！</code>）。</p>
<p>&emsp;&emsp;我使用的是<code>Air724UG</code>开发板，如果在其他模块上不能用，那也不要强怼，也许是开发包不兼容吧。这里的代码是没有问题的。例程仅供参考！</p>
<h1 id="一、前言"><a href="#一、前言" class="headerlink" title="一、前言"></a>一、前言</h1><p>&emsp;&emsp;很累啊，最近太忙了。一直没时间折腾CSDK，回头一看足足有三个月没写新东西了。太长时间不写感觉都有点手生，拿起键盘都不知道怎么才能下手。</p>
<p>&emsp;&emsp;这几天在CSDK上又折腾了下，搞了一个简易的AT引擎。合宙的CSDK默认也是支持一部分AT指令的，不是全部都支持，具体哪些不支持我也不是很清楚。</p>
<p>&emsp;&emsp;除了合宙现有的一些AT指令外，有的小伙伴可能还希望在AT版本上面实现其他更复杂的操作，实现自定义的一些功能。而一般平台商提供的AT指令都是通用的，一般不会提供定制功能。直接让模块厂家去添加特定的AT指令可能性不大。甚至可以说基本不可能。</p>
<p>&emsp;&emsp;比如有的小伙伴可能想要AT指令能够支持连接阿里云、腾讯云、百度云等等。而这些云平台一般都会有自己的鉴权算法，这些算法五花八门，并且还有可能会经常变动。合宙标准的AT指令也仅仅是提供了MQTT的连接命令，并没有针对这些平台提供具体的连接指令。这一类指令还好一点，受众挺广。以后可能会有，至于是什么时候谁都不知道，至少现在是没有的。</p>
<p>&emsp;&emsp;现在没有的情况下，需要使用自定义的AT指令进行交互怎么办？<br><img src="https://img-blog.csdnimg.cn/20201209213306637.png" alt="在这里插入图片描述"><br>&emsp;&emsp;看到这个表情应该知道是什么意思了吧，不急的话继续往下看↓。</p>
<h1 id="二、简介"><a href="#二、简介" class="headerlink" title="二、简介"></a>二、简介</h1><p>&emsp;&emsp;今天带来的文章带来了一个简易的AT引擎。该AT引擎可以实现自定义AT指令、可以实现对固件自带的AT指令实现重定向、可以直接使用固件自带的AT指令。<br><img src="https://img-blog.csdnimg.cn/20201209214445923.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDU3MDA4Mw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>&emsp;&emsp;第一类用法<code>自定义AT</code>：顾名思义自定义AT就是添加属于自己的AT。这个用法和底层的AT没关系。一般情况下AT指令会有四种用法，分别是测试(test)、查询(query)、设置(setup)、执行(exe)。上述是通用用法，但是有些AT指令只具备其中的一个或多个，并不是每个AT指令都会有上述四种用法。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">AT+TEST=?			<span class="comment">//测试指令。这一般情况下会返回该AT可以输入的参数取值范围</span></span><br><span class="line">AT+TEST?			<span class="comment">//查询指令。一般会返回AT指令之前设置的结果或者默认值</span></span><br><span class="line">AT+TEST=<span class="number">123456</span>		<span class="comment">//设置指令。设置参数，设置的值可以被查询指令查询</span></span><br><span class="line">AT+TEST				<span class="comment">//执行指令。根据设置的结果执行相应的动作</span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;第二类用法<code>重定向AT</code>：相当于给底层自带的AT起一个别名。本例中我将对<code>+WIMEI</code>命令进行重定向，使用<code>+REPWIMEI</code>命令来代替<code>+WIMEI</code>，用法是一摸一样的只是名字变了。不要担心，这个并不会影响到原来的AT，原来的AT还是可以正常使用的。</p>
<p>&emsp;&emsp;第三类用法<code>转发AT</code>，由于该模块默认串口1是AT口。我们实现自定义AT也是使用的串口1，这就会导致原来的AT通道不能正常使用。只能在AT引擎中将不匹配的AT通过VAT虚拟AT通道转发到底层处理。</p>
<h1 id="二、编写程序"><a href="#二、编写程序" class="headerlink" title="二、编写程序"></a>二、编写程序</h1><h2 id="2-1、main-c"><a href="#2-1、main-c" class="headerlink" title="2.1、main.c"></a>2.1、main.c</h2><p>&emsp;&emsp;demo非常简单，只需要调用<code>at_task_init();</code>我们的AT引擎就可以跑起来了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***************</span></span><br><span class="line"><span class="comment">	demo_at_engine</span></span><br><span class="line"><span class="comment">****************/</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;iot_debug.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;iot_os.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">appimg_enter</span><span class="params">(<span class="keyword">void</span> *param)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    iot_debug_print(<span class="string">&quot;[hello]appimg_enter&quot;</span>);</span><br><span class="line"></span><br><span class="line">    iot_debug_set_fault_mode(OPENAT_FAULT_HANG);</span><br><span class="line"></span><br><span class="line">    iot_vat_send_cmd(<span class="string">&quot;AT^TRACECTRL=0,1,1\r\n&quot;</span>, <span class="keyword">sizeof</span>(<span class="string">&quot;AT^TRACECTRL=0,1,1\r\n&quot;</span>));</span><br><span class="line">    at_task_init();<span class="comment">//初始化AT引擎</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">appimg_exit</span><span class="params">(<span class="keyword">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    iot_debug_print(<span class="string">&quot;[hello]appimg_exit&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;我们需要修改的内容在<code>app\at_engine</code>目录下，想要自定义命令需要修改三个文件，如果不修改的话默认也是可以跑的。<br><img src="https://img-blog.csdnimg.cn/20201209221121120.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80NDU3MDA4Mw==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="2-2、at-baseTable-h"><a href="#2-2、at-baseTable-h" class="headerlink" title="2.2、at_baseTable.h"></a>2.2、at_baseTable.h</h2><p>&emsp;&emsp;<code>at_baseTable.h</code>文件存放的是用户自定义AT以及重定向AT的一个表。At引擎运行的时候会到这个表中进行匹配。这个表实际上是一个结构体数组，一个结构体元素代表一个AT命令。每个AT都有7个成员，从左到右依次是<code>旧的AT指令</code>、<code>新的AT指令</code>、<code>新的AT指令长度</code>、<code>测试回调函数</code>、<code>查询回调函数</code>、<code>设置回调函数</code>、<code>执行回调函数</code>。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __AT_BASETABLE_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __AT_BASETABLE_H</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;at.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;at_baseCmd.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">at_funcationType at_fun[] = &#123;</span><br><span class="line">	&#123;<span class="literal">NULL</span>, <span class="string">&quot;+NEW&quot;</span>, <span class="number">4</span>, at_NEW_Cmdtest, at_NEW_Cmdquery, at_NEW_Cmdsetup, at_NEW_Cmdexe&#125;,</span><br><span class="line">	&#123;<span class="string">&quot;I&quot;</span>, <span class="string">&quot;+REPI&quot;</span>, <span class="number">5</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>&#125;,</span><br><span class="line">	&#123;<span class="string">&quot;+WIMEI&quot;</span>, <span class="string">&quot;+REPWIMEI&quot;</span>, <span class="number">9</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>&#125;,</span><br><span class="line">	&#123;<span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>&#125; &#125;;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;如果<code>旧的AT指令</code>存在，说明该条目是对底层AT进行重定向。这时候只需要在填入<code>新的AT指令</code>和<code>新的AT指令长度</code>即可，后面的四个回调都可以填<code>NULL</code>。实际填了也没用这并不会进入到这个回调中处理。</p>
<p>&emsp;&emsp;如果<code>旧的AT指令</code>不存在，说明该条目是一条自定义指令，那就需要填入后面的回调，按需填写。用到哪个就填哪个。简介中有介绍到AT的四种用法。</p>
<p>&emsp;&emsp;表中第1条：添加了一条<code>AT+NEW</code>指令，该条目是一个自定义指令，接下来还需要添加四个回调函数。<code>at_NEW_Cmdtest, at_NEW_Cmdquery, at_NEW_Cmdsetup, at_NEW_Cmdexe</code><br>&emsp;&emsp;表中第2条：使用<code>AT+REPI</code>指令完成对<code>ATI</code>的重定向。原始命令仍可正常使用。<br>&emsp;&emsp;表中第3条：使用<code>AT+REPWIMEI</code>指令完成对<code>AT+WIMEI</code>的重定向。原始命令仍可正常使用。</p>
<h2 id="2-3、at-baseCmd-h"><a href="#2-3、at-baseCmd-h" class="headerlink" title="2.3、at_baseCmd.h"></a>2.3、at_baseCmd.h</h2><p>&emsp;&emsp;<code>at_baseCmd.h</code>文件存放的是回调函数声明。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> __AT_BASECMD_H</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> __AT_BASECMD_H</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdtest</span><span class="params">(<span class="keyword">uint8_t</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdquery</span><span class="params">(<span class="keyword">uint8_t</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdsetup</span><span class="params">(<span class="keyword">uint8_t</span> id, <span class="keyword">char</span> *pPara)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdexe</span><span class="params">(<span class="keyword">uint8_t</span> id)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<h2 id="2-4、at-baseCmd-c"><a href="#2-4、at-baseCmd-c" class="headerlink" title="2.4、at_baseCmd.c"></a>2.4、at_baseCmd.c</h2><p>&emsp;&emsp;<code>at_baseCmd.c</code>文件存放的是回调函数的具体实现。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;at.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;at_baseCmd.h&quot;</span></span></span><br><span class="line"><span class="comment">//#include &quot;gsm.h&quot;</span></span><br><span class="line"><span class="comment">//执行AT命令</span></span><br><span class="line"><span class="comment">//存储数据</span></span><br><span class="line"><span class="comment">//上传</span></span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdtest</span><span class="params">(<span class="keyword">uint8_t</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> buf[] = <span class="string">&quot;AT+NEW TEST&quot;</span>;</span><br><span class="line">	at_uart_send(buf, <span class="keyword">sizeof</span>(buf) - <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> cmdResultOk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdquery</span><span class="params">(<span class="keyword">uint8_t</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> buf[] = <span class="string">&quot;AT+NEW QUERY&quot;</span>;</span><br><span class="line">	at_uart_send(buf, <span class="keyword">sizeof</span>(buf) - <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> cmdResultOk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdsetup</span><span class="params">(<span class="keyword">uint8_t</span> id, <span class="keyword">char</span> *pPara)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> *data = pPara + <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">char</span> buf[] = <span class="string">&quot;AT+NEW SETUP pPara is: &quot;</span>;</span><br><span class="line">	at_uart_send(buf, <span class="keyword">sizeof</span>(buf) - <span class="number">1</span>);</span><br><span class="line">	at_uart_send(data, <span class="built_in">strlen</span>(data) - <span class="number">2</span>);</span><br><span class="line">	<span class="keyword">return</span> cmdResultOk;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function">at_cmdResult <span class="title">at_NEW_Cmdexe</span><span class="params">(<span class="keyword">uint8_t</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> buf[] = <span class="string">&quot;AT+NEW EXE&quot;</span>;</span><br><span class="line">	at_uart_send(buf, <span class="keyword">sizeof</span>(buf) - <span class="number">1</span>);</span><br><span class="line">	<span class="keyword">return</span> cmdResultOk;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="三、下载验证"><a href="#三、下载验证" class="headerlink" title="三、下载验证"></a>三、下载验证</h1><p>&emsp;&emsp;<code>ATI</code>和<code>AT+REPI</code>测试，可以看到两条命令返回一样的结果。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">52</span>:<span class="number">45.110</span>]# SEND ASCII&gt;</span><br><span class="line">ATI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">52</span>:<span class="number">45.233</span>]# RECV ASCII&gt;</span><br><span class="line"></span><br><span class="line">CSDK_V301736_RDA8910</span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">52</span>:<span class="number">51.295</span>]# SEND ASCII&gt;</span><br><span class="line">AT+REPI</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">52</span>:<span class="number">51.426</span>]# RECV ASCII&gt;</span><br><span class="line">AT+REPI</span><br><span class="line"></span><br><span class="line">CSDK_V301736_RDA8910</span><br><span class="line"></span><br><span class="line">OK</span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>AT+REPWIMEI</code>和<code>AT+WIMEI</code>测试，分别查询结果都是一样的。使用<code>AT+WIMEI</code>设置的新IMEI也能被<code>AT+REPWIMEI</code>查询到。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">18.597</span>]# SEND ASCII&gt;</span><br><span class="line">AT+REPWIMEI?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">18.736</span>]# RECV ASCII&gt;</span><br><span class="line">AT+REPWIMEI?</span><br><span class="line"></span><br><span class="line">+WIMEI: <span class="number">866714049398888</span></span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">19.395</span>]# SEND ASCII&gt;</span><br><span class="line">AT+WIMEI?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">19.526</span>]# RECV ASCII&gt;</span><br><span class="line"></span><br><span class="line">+WIMEI: <span class="number">866714049398888</span></span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">24.068</span>]# SEND ASCII&gt;</span><br><span class="line">AT+WIMEI=<span class="number">123456789123456</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">24.257</span>]# RECV ASCII&gt;</span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">26.975</span>]# SEND ASCII&gt;</span><br><span class="line">AT+REPWIMEI?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">56</span>:<span class="number">27.110</span>]# RECV ASCII&gt;</span><br><span class="line">AT+REPWIMEI?</span><br><span class="line"></span><br><span class="line">+WIMEI: <span class="number">123456789123456</span></span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>&emsp;&emsp;<code>AT+NEW</code>测试，通过串口一日志看到AT的四种使用形式，测试(test)、查询(query)、设置(setup)、执行(exe)都被正常识别。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">12.083</span>]# SEND ASCII&gt;</span><br><span class="line">AT+NEW=?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">12.201</span>]# RECV ASCII&gt;</span><br><span class="line">AT+NEW=?</span><br><span class="line"></span><br><span class="line">AT+NEW TEST</span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">16.403</span>]# SEND ASCII&gt;</span><br><span class="line">AT+NEW?</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">16.525</span>]# RECV ASCII&gt;</span><br><span class="line">AT+NEW?</span><br><span class="line"></span><br><span class="line">AT+NEW QUERY</span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">23.541</span>]# SEND ASCII&gt;</span><br><span class="line">AT+NEW=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">23.697</span>]# RECV ASCII&gt;</span><br><span class="line">AT+NEW=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line">AT+NEW SETUP pPara is: <span class="number">123456</span></span><br><span class="line"></span><br><span class="line">OK</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">27.065</span>]# SEND ASCII&gt;</span><br><span class="line">AT+NEW</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[<span class="number">2020</span><span class="number">-12</span><span class="number">-10</span> <span class="number">11</span>:<span class="number">58</span>:<span class="number">27.179</span>]# RECV ASCII&gt;</span><br><span class="line">AT+NEW</span><br><span class="line"></span><br><span class="line">AT+NEW EXE</span><br><span class="line"></span><br><span class="line">OK</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不会下载的<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44570083/article/details/104285283">点击这里</a>，进去查看我的<code>RDA8910 CSDK二次开发入门教程</code>专题第一篇博文<code>1、RDA8910CSDK二次开发：环境搭建</code>里面讲了怎么下载<br>这里只是我的学习笔记，拿出来给大家分享，欢迎大家批评指正，本篇教程到此结束</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2020/12/10/2033/" data-id="ckkfmdga8002lvkcg581e8v0j" data-title="17、RDA8910(4GCAT1)CSDK二次开发：一个简易的AT框架---可以实现自定义AT指令了" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/6/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/8/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>