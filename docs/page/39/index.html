<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:type" content="website">
<meta property="og:title" content="Luat doc 社区文章静态页面镜像">
<meta property="og:url" content="https://doc.luatos.wiki/page/39/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-596" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/30/596/" class="article-date">
  <time class="dt-published" datetime="2019-07-30T07:56:16.000Z" itemprop="datePublished">2019-07-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/07/30/596/">如何利用RNDIS网卡设备收发AT指令</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p style=&quot;color: rgb(51, 51, 51);&quot;&gt;当你的linux系统直接使用合宙的4G 模块（通过rndis功能上网），想知道一些模块的信息，但是由于没有识别到模块的tty设备（想要识别模块 请看&lt;a style=&quot;background-color: rgb(255, 255, 255);&quot; href=&quot;http://oldask.openluat.com/article/37&quot;&gt;http://oldask.openluat.com/article/37&lt;/a&gt;&amp;nbsp;），可以通过rndis 和模块进行通信，&lt;br&gt;&lt;/p&gt;&lt;p style=&quot;color: rgb(51, 51, 51);&quot;&gt;通过 在linux 上命令行 发送&amp;nbsp; &amp;nbsp; &amp;nbsp;telnet 192.168.0.1 4321 就可和模块 进行AT 通信&lt;/p&gt;&lt;p&gt;&lt;b&gt;&lt;font color=&quot;#ff0000&quot; style=&quot;background-color: inherit;&quot;&gt;注意：对于AIR720系列模块，固件版本要大于V930才支持此功能。&lt;/font&gt;&lt;/b&gt;&lt;/p&gt;&lt;p style=&quot;color: rgb(51, 51, 51);&quot;&gt;常用 AT :&lt;/p&gt;&lt;p style=&quot;color: rgb(51, 51, 51);&quot;&gt;AT+CPIN?&amp;nbsp; 查看卡是否在位&lt;/p&gt;&lt;p style=&quot;color: rgb(51, 51, 51);&quot;&gt;AT+CEREG?&amp;nbsp; 查看是否注册上网络&lt;/p&gt;&lt;p style=&quot;color: rgb(51, 51, 51);&quot;&gt;AT+CESQ&amp;nbsp; &amp;nbsp; 查看信号值&lt;/p&gt;&lt;p style=&quot;color: rgb(51, 51, 51);&quot;&gt;ATI&amp;nbsp; 查看版本号&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/07/30/596/" data-id="ckkfmdgcg008jvkcg6gyg3e7b" data-title="如何利用RNDIS网卡设备收发AT指令" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-595" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/25/595/" class="article-date">
  <time class="dt-published" datetime="2019-07-25T07:01:31.000Z" itemprop="datePublished">2019-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/07/25/595/">如何排查linux使用RNDIS无法上网的问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p&gt;&lt;b&gt;一， 通过RNDIS 上网&lt;/b&gt;&lt;/p&gt;&lt;p&gt;一般情况下，不是特别精简的linux 已经支持rndis 功能，如果插上合宙的4G 模块，但是不能上网的话，需要注意以下几点&lt;br&gt;&lt;/p&gt;&lt;p&gt;1,能否检测到rndis 设备&lt;/p&gt;&lt;p&gt;    在命令行中输入 dmesg ,如此出现  rndis_host 1-1:1.0 eth1 这样的打印，则证明已经识别到了，(如果没有，可能是硬件问题，也可能是linux 真的不支持rndis &lt;a href=&quot;http://oldask.openluat.com/article/79&quot;&gt;http://oldask.openluat.com/article/79&lt;/a&gt;)&lt;/p&gt;&lt;p&gt;    此时查看ifconfig ,如果没有出现    rndis_host 1-1:1.0 eth1 中的 eth1 ，则发送ifconfig -a ,此时发现有eth1 但是 没有ip 地址，发送 udhcpc -i eh1  出现地址后，即可使用此网卡进行上网&lt;/p&gt;&lt;p&gt;2，出现设备网卡，但是无法上网&lt;/p&gt;&lt;p&gt;    这可能是由于模块没有注册上网络，请看通过tcp 和模块进行通信&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;b&gt;二 ， 通过 tcp 和 模块进行通信&lt;/b&gt;&lt;/p&gt;&lt;p&gt;当你的linux系统直接使用合宙的4G 模块（通过rndis功能上网），想知道一些模块的信息，但是由于没有识别到模块的tty设备（想要识别模块 请看&lt;a href=&quot;http://oldask.openluat.com/article/37&quot;&gt;http://oldask.openluat.com/article/37&lt;/a&gt; ），可以通过rndis 和模块进行通信，&lt;/p&gt;&lt;p&gt;通过 在linux 上命令行 发送     telnet 192.168.0.1 4321 就可和模块 进行AT 通信&lt;/p&gt;&lt;p&gt;常用 AT :&lt;/p&gt;&lt;p&gt;AT+CPIN?  查看卡是否在位&lt;/p&gt;&lt;p&gt;AT+CEREG?  查看是否注册上网络&lt;/p&gt;&lt;p&gt;AT+CESQ    查看信号值&lt;/p&gt;&lt;p&gt;ATI  查看版本号&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;
</code></pre>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/07/25/595/" data-id="ckkfmdgcg008ivkcg8oy2hn83" data-title="如何排查linux使用RNDIS无法上网的问题" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-594" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/25/594/" class="article-date">
  <time class="dt-published" datetime="2019-07-25T03:39:51.000Z" itemprop="datePublished">2019-07-25</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/07/25/594/">vscode入门推荐配置（lua开发使用）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h1><p>打开官网：<a target="_blank" rel="noopener" href="https://code.visualstudio.com/">https://code.visualstudio.com/</a></p>
<p>点击官网那个大大的绿色按键，下载</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_46271.png"></p>
<p>下载完后直接安装</p>
<p>安装时注意改一下这个选项</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_35254.jpg"></p>
<hr>
<h1 id="更改语言"><a href="#更改语言" class="headerlink" title="更改语言"></a>更改语言</h1><p>首先，我们要把软件改成中文的</p>
<p>在左侧点击<code>拓展</code>–<code>输入chinese</code>–<code>安装中文语言拓展</code></p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_21440.jpg"></p>
<p>安装后关掉软件，再打开软件，就是中文了</p>
<hr>
<h1 id="更改软件各项默认设置"><a href="#更改软件各项默认设置" class="headerlink" title="更改软件各项默认设置"></a>更改软件各项默认设置</h1><p>打开软件，在软件页面，按下快捷键<code>Ctrl</code>+<code>,</code>（逗号），打开设置页面</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_26311.jpg"></p>
<p>下面的设置就是按我的喜好来了，大家可以按自己的喜好采纳或尝试其他设置</p>
<h2 id="中文字体使用微软雅黑"><a href="#中文字体使用微软雅黑" class="headerlink" title="中文字体使用微软雅黑"></a>中文字体使用微软雅黑</h2><p><code>Editor: Font Family</code>内容改为如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Consolas, &#39;Microsoft Yahei UI Light&#39;,&#39;Courier New&#39;, monospace</span><br></pre></td></tr></table></figure>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_52118.jpg"></p>
<h2 id="空格和tab显示小点和箭头占位符"><a href="#空格和tab显示小点和箭头占位符" class="headerlink" title="空格和tab显示小点和箭头占位符"></a>空格和tab显示小点和箭头占位符</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_13626.jpg"></p>
<p>显示效果是这样</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_43246.jpg"></p>
<h2 id="关闭复制当前行功能"><a href="#关闭复制当前行功能" class="headerlink" title="关闭复制当前行功能"></a>关闭复制当前行功能</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_89967.jpg"></p>
<h2 id="自动猜测文件编码"><a href="#自动猜测文件编码" class="headerlink" title="自动猜测文件编码"></a>自动猜测文件编码</h2><p>这个可以准确识别大部分文件的编码，当然有时候还是会识别错误，但总比每次都要手动选好多了</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_56083.jpg"></p>
<h2 id="末尾自动插入新行"><a href="#末尾自动插入新行" class="headerlink" title="末尾自动插入新行"></a>末尾自动插入新行</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_56645.jpg"></p>
<h2 id="自动去除每行末尾多余的空格"><a href="#自动去除每行末尾多余的空格" class="headerlink" title="自动去除每行末尾多余的空格"></a>自动去除每行末尾多余的空格</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_90999.jpg"></p>
<hr>
<h1 id="推荐安装的拓展"><a href="#推荐安装的拓展" class="headerlink" title="推荐安装的拓展"></a>推荐安装的拓展</h1><blockquote>
<p>由于有很多重名插件，请仔细查看我截图所示的插件，<strong>保证作者相同</strong>再安装</p>
</blockquote>
<h2 id="Lua"><a href="#Lua" class="headerlink" title="Lua"></a>Lua</h2><p>Lua Language Server coded by Lua</p>
<p>自动补全、高亮、静态检查等功能的插件，国人出品<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_29944.jpg"></p>
<h2 id="LUAT"><a href="#LUAT" class="headerlink" title="LUAT"></a>LUAT</h2><p>LUAT接口代码自动补全</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_55360.jpg"></p>
<h2 id="indent-rainbow"><a href="#indent-rainbow" class="headerlink" title="indent-rainbow"></a>indent-rainbow</h2><p>缩进自动彩色，大大提高编程效率（前提是你按规范缩进了）<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_95966.jpg"></p>
<h2 id="Rainbow-Brackets"><a href="#Rainbow-Brackets" class="headerlink" title="Rainbow Brackets"></a>Rainbow Brackets</h2><p>括号彩色分组，防止你看错括号对<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_78209.jpg"></p>
<hr>
<h2 id="平常写项目时"><a href="#平常写项目时" class="headerlink" title="平常写项目时"></a>平常写项目时</h2><p>建议直接右键打开文件夹</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_19983.jpg"></p>
<p>同时时建议直接保存工作区，方便下次直接继续上次的进度：</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_24463.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/07/25/594/" data-id="ckkfmdgcg008hvkcgecmv3eui" data-title="vscode入门推荐配置（lua开发使用）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-593" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/18/593/" class="article-date">
  <time class="dt-published" datetime="2019-07-18T10:44:03.000Z" itemprop="datePublished">2019-07-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/07/18/593/">使用Lua脚本连接华为云物联网服务</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <blockquote>
<p>本教程代码在2G与4G模块上均可使用<br>如需查看AT命令方式连接方法，请查看：<a target="_blank" rel="noopener" href="http://oldask.openluat.com/article/902">教你用Air720 模块通过AT指令以MQTTS方式连接华为云（上篇）</a></p>
</blockquote>
<h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><p>打开华为云物联网后台（如果无账号，需要注册）：<br><a target="_blank" rel="noopener" href="https://iot-dev.huaweicloud.com/#/developer-overview">OceanConnect开发中心</a></p>
<p>新建项目，项目名称和行业按需求填写：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_18953.jpg"></p>
<p>记录下应用id与密钥，进入项目：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_56927.jpg"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">应用ID</span><br><span class="line">ackQwtMh2hnjQzMoJE4fTc3ZtVoa</span><br><span class="line">应用密钥</span><br><span class="line">4BdXiylWLCFHHlLin_fwzgwAJfoa</span><br></pre></td></tr></table></figure>
<p>点<code>产品开发</code>，<code>新建产品</code>，内容按需求填写，注意<code>接入应用层协议类型</code>要选择<code>MQTT</code>：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_16742.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_23971.jpg"></p>
<p>给这个产品添加Profile定义：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_78650.jpg"></p>
<p>按下图新建属性：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_37611.jpg"></p>
<p>按照下图，再添加两个命令（string长度图里应为4）：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_30386.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_71272.jpg"><br>保存设置。</p>
<p>左侧<code>设备管理</code>，<code>添加真实设备</code>，注意类型要选直连：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_19642.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_28688.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_64676.jpg"></p>
<p>设备信息记下来，后面会用到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">设备ID：</span><br><span class="line">355d812e-ad55-47a5-b811-760f760b63a1</span><br><span class="line">密钥：</span><br><span class="line">10f0a44d66a582b3ddee</span><br></pre></td></tr></table></figure>
<h1 id="模块连接实现"><a href="#模块连接实现" class="headerlink" title="模块连接实现"></a>模块连接实现</h1><blockquote>
<p>模块连接需要使用MQTT+SSL的方式，具体鉴权协议可以参考华为云的文档：<a target="_blank" rel="noopener" href="https://support.huaweicloud.com/api-IoT/iot_06_3009.html">MQTT CONNECT连接鉴权</a></p>
</blockquote>
<p>首先需要注意，由于上面定义了int类型，并且在华为云的int类型会带小数点的尾缀，所以我们需要使用SSL+FLOAT的固件，并且保证固件版本大于0034以确保可以使用HMACSHA256计算函数</p>
<p>首先准备一下mqtt的证书文件，保存下面的文本内容为<code>hw.crt</code>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIID4DCCAsigAwIBAgIJAK97nNS67HRvMA0GCSqGSIb3DQEBCwUAMFMxCzAJBgNV</span><br><span class="line">BAYTAkNOMQswCQYDVQQIEwJHRDELMAkGA1UEBxMCU1oxDzANBgNVBAoTBkh1YXdl</span><br><span class="line">aTELMAkGA1UECxMCQ04xDDAKBgNVBAMTA0lPVDAeFw0xNjA1MDQxMjE3MjdaFw0y</span><br><span class="line">NjA1MDIxMjE3MjdaMFMxCzAJBgNVBAYTAkNOMQswCQYDVQQIEwJHRDELMAkGA1UE</span><br><span class="line">BxMCU1oxDzANBgNVBAoTBkh1YXdlaTELMAkGA1UECxMCQ04xDDAKBgNVBAMTA0lP</span><br><span class="line">VDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJxM9fwkwvxeILpkvoAM</span><br><span class="line">Gdqq3x0G9o445F6Shg3I0xmmzu9Of8wYuW3c4jtQ&#x2F;6zscuIGyWf06ke1z&#x2F;&#x2F;AVZ&#x2F;o</span><br><span class="line">dp8LkuFbBbDXR5swjUJ6z15b6yaYH614Ty&#x2F;d6DrCM+RaU+FWmxmOon9W&#x2F;VELu2BB</span><br><span class="line">NXDQHJBSbWrLNGnZA2erk4JSMp7RhHrZ0QaNtT4HhIczFYtQ2lYF+sQJpQMrjoRn</span><br><span class="line">dSV9WB872Ja4DgcISU1+wuWLmS&#x2F;NKjIvOWW1upS79yu2I4Rxos2mFy9xxz311rGC</span><br><span class="line">Z3X65ejFNzCUrNgf6NEP1N7wB9hUu7u50aA+&#x2F;56D7EgjeI0gpFytC+a4f6JCPVWI</span><br><span class="line">Lr0CAwEAAaOBtjCBszAdBgNVHQ4EFgQUcGqy59oawLEgMl21&#x2F;&#x2F;7F5RyABpwwgYMG</span><br><span class="line">A1UdIwR8MHqAFHBqsufaGsCxIDJdtf&#x2F;+xeUcgAacoVekVTBTMQswCQYDVQQGEwJD</span><br><span class="line">TjELMAkGA1UECBMCR0QxCzAJBgNVBAcTAlNaMQ8wDQYDVQQKEwZIdWF3ZWkxCzAJ</span><br><span class="line">BgNVBAsTAkNOMQwwCgYDVQQDEwNJT1SCCQCve5zUuux0bzAMBgNVHRMEBTADAQH&#x2F;</span><br><span class="line">MA0GCSqGSIb3DQEBCwUAA4IBAQBgv2PQn66gRMbGJMSYS48GIFqpCo783TUTePNS</span><br><span class="line">tV8G1MIiQCpYNdk2wNw&#x2F;iFjoLRkdx4va6jgceht5iX6SdjpoQF7y5qVDVrScQmsP</span><br><span class="line">U95IFcOkZJCNtOpUXdT+a3N+NlpxiScyIOtSrQnDFixWMCJQwEfg8j74qO96UvDA</span><br><span class="line">FuTCocOouER3ZZjQ8MEsMMquNEvMHJkMRX11L5Rxo1pc6J&#x2F;EMWW5scK2rC0Hg91a</span><br><span class="line">Lod6aezh2K7KleC0V5ZlIuEvFoBc7bCwcBSAKA3BnQveJ8nEu9pbuBsVAjHOroVb</span><br><span class="line">8&#x2F;bL5retJigmAN2GIyFv39TFXIySw+lW0wlp+iSPxO9s9J+t</span><br><span class="line">-----END CERTIFICATE-----</span><br></pre></td></tr></table></figure>
<p>新建<code>main.lua</code>：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">PROJECT = <span class="string">&quot;HWMQTT&quot;</span></span><br><span class="line">VERSION = <span class="string">&quot;1.0.0&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--加载日志功能模块，并且设置日志输出等级</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">&quot;log&quot;</span></span><br><span class="line">LOG_LEVEL = <span class="built_in">log</span>.LOGLEVEL_TRACE</span><br><span class="line"><span class="built_in">require</span> <span class="string">&quot;sys&quot;</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">&quot;net&quot;</span></span><br><span class="line"><span class="comment">--每1分钟查询一次GSM信号强度</span></span><br><span class="line"><span class="comment">--每1分钟查询一次基站信息</span></span><br><span class="line">net.startQueryAll(<span class="number">60000</span>, <span class="number">60000</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--加载硬件看门狗功能模块</span></span><br><span class="line"><span class="comment">--require &quot;wdt&quot;</span></span><br><span class="line"><span class="comment">--wdt.setup(pio.P0_30, pio.P0_31)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--加载网络指示灯功能模块</span></span><br><span class="line"><span class="comment">--require &quot;netLed&quot;</span></span><br><span class="line"><span class="comment">--netLed.setup(true,pio.P1_1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--加载MQTT功能测试模块</span></span><br><span class="line"><span class="built_in">require</span> <span class="string">&quot;mqttTask&quot;</span></span><br><span class="line"><span class="comment">--启动系统框架</span></span><br><span class="line">sys.init(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">sys.run()</span><br></pre></td></tr></table></figure>
<p>新建<code>mqttTask.lua</code>：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">require</span> <span class="string">&quot;mqtt&quot;</span></span><br><span class="line"><span class="built_in">module</span>(..., <span class="built_in">package</span>.<span class="built_in">seeall</span>)</span><br><span class="line"><span class="comment">-- 这里请填写华为云后台对接信息所展示的设备信息MQTT接入方式信息</span></span><br><span class="line"><span class="keyword">local</span> host, port = <span class="string">&quot;49.4.93.24&quot;</span>, <span class="number">8883</span></span><br><span class="line"><span class="comment">--这里设置设备的device id和密钥，之前新建设备时得到的两个字符串</span></span><br><span class="line"><span class="comment">--实际使用中，这两个值可以存在SN中，在生产时一个个烧录进去</span></span><br><span class="line"><span class="keyword">local</span> device = <span class="string">&quot;355d812e-ad55-47a5-b811-760f760b63a1&quot;</span></span><br><span class="line"><span class="keyword">local</span> secret = <span class="string">&quot;10f0a44d66a582b3ddee&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--同步NTP时间，因为鉴权需要用到UTC时间</span></span><br><span class="line"><span class="built_in">require</span><span class="string">&quot;ntp&quot;</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">ntbcb</span><span class="params">(r)</span></span></span><br><span class="line">    <span class="keyword">if</span> r <span class="keyword">then</span></span><br><span class="line">        sys.publish(<span class="string">&quot;NTP_OK&quot;</span>)<span class="comment">--时间同步完成后，发送命令，开始mqtt连接</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        ntp.timeSync(<span class="literal">nil</span>,ntbcb)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">ntp.timeSync(<span class="literal">nil</span>,ntbcb)<span class="comment">--开始同步时间任务</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--此处参照华为云文档，生成连接时使用的密钥</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">keyGenerate</span><span class="params">(key)</span></span></span><br><span class="line">    <span class="keyword">local</span> clk = <span class="built_in">os</span>.<span class="built_in">date</span>(<span class="string">&quot;*t&quot;</span>,<span class="built_in">os</span>.<span class="built_in">time</span>()<span class="number">-3600</span>*<span class="number">8</span>)<span class="comment">--获取UTC时间的table</span></span><br><span class="line">    <span class="keyword">local</span> timeStr = <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%02d%02d%02d%02d&quot;</span>,clk.year,clk.month,clk.day,clk.hour)<span class="comment">--时间戳</span></span><br><span class="line">    <span class="keyword">local</span> result = crypto.hmac_sha256(key,timeStr):<span class="built_in">lower</span>()</span><br><span class="line">    <span class="built_in">log</span>.info(<span class="string">&quot;keyGenerate&quot;</span>,timeStr,key,result)</span><br><span class="line">    <span class="keyword">if</span> crypto.hmac_sha256 <span class="keyword">then</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">log</span>.<span class="built_in">error</span>(<span class="string">&quot;crypto.hmac_sha256&quot;</span>,<span class="string">&quot;please update your lod version, higher than 0034!&quot;</span>)</span><br><span class="line">        rtos.poweroff()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">socket.setSendMode(<span class="number">1</span>)</span><br><span class="line"><span class="comment">-- 测试MQTT的任务代码</span></span><br><span class="line">sys.taskInit(<span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">    sys.waitUntil(<span class="string">&quot;NTP_OK&quot;</span>)<span class="comment">--等待时间同步成功</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> socket.isReady() <span class="keyword">do</span> sys.wait(<span class="number">1000</span>) <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">local</span> clk = <span class="built_in">os</span>.<span class="built_in">date</span>(<span class="string">&quot;*t&quot;</span>,<span class="built_in">os</span>.<span class="built_in">time</span>()<span class="number">-3600</span>*<span class="number">8</span>)<span class="comment">--获取UTC时间的table</span></span><br><span class="line">        <span class="keyword">local</span> mqttc = mqtt.client(</span><br><span class="line">            device..<span class="string">&quot;_0_1_&quot;</span>..<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%02d%02d%02d%02d&quot;</span>,clk.year,clk.month,clk.day,clk.hour),<span class="comment">--时间戳鉴权模式</span></span><br><span class="line">            <span class="number">300</span>,</span><br><span class="line">            device,</span><br><span class="line">            keyGenerate(secret))</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">not</span> mqttc:connect(host, port, <span class="string">&quot;tcp_ssl&quot;</span>,&#123;caCert=<span class="string">&quot;hw.crt&quot;</span>&#125;) <span class="keyword">do</span> sys.wait(<span class="number">2000</span>) <span class="keyword">end</span></span><br><span class="line">        <span class="comment">--topic订阅规则详细请见华为云文档：https://support.huaweicloud.com/api-IoT/iot_06_3008.html#ZH-CN_TOPIC_0172230104</span></span><br><span class="line">        <span class="keyword">if</span> mqttc:subscribe(<span class="string">&quot;/huawei/v1/devices/&quot;</span>..device..<span class="string">&quot;/command/json&quot;</span>) <span class="keyword">then</span></span><br><span class="line">            <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">                <span class="keyword">local</span> r, data, param = mqttc:receive(<span class="number">120000</span>, <span class="string">&quot;pub_msg&quot;</span>)</span><br><span class="line">                <span class="keyword">if</span> r <span class="keyword">then</span></span><br><span class="line">                    <span class="built_in">log</span>.info(<span class="string">&quot;这是收到了服务器下发的消息:&quot;</span>, data.payload <span class="keyword">or</span> <span class="string">&quot;nil&quot;</span>)</span><br><span class="line">                    sys.publish(<span class="string">&quot;rev_msg&quot;</span>,data.payload)<span class="comment">--把收到的数据推送出去</span></span><br><span class="line">                <span class="keyword">elseif</span> data == <span class="string">&quot;pub_msg&quot;</span> <span class="keyword">then</span></span><br><span class="line">                    <span class="built_in">log</span>.info(<span class="string">&quot;这是收到了订阅的消息和参数显示:&quot;</span>, param)</span><br><span class="line">                    <span class="comment">--topic订阅规则详细请见华为云文档</span></span><br><span class="line">                    mqttc:publish(<span class="string">&quot;/huawei/v1/devices/&quot;</span>..device..<span class="string">&quot;/data/json&quot;</span>, param)</span><br><span class="line">                <span class="keyword">elseif</span> data == <span class="string">&quot;timeout&quot;</span> <span class="keyword">then</span></span><br><span class="line">                    <span class="comment">--等待超时，进行下一轮等待</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                <span class="keyword">end</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        mqttc:disconnect()</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">--接收到mqtt之后，对数据进行处理</span></span><br><span class="line">sys.subscribe(<span class="string">&quot;rev_msg&quot;</span>,<span class="function"><span class="keyword">function</span><span class="params">(data)</span></span></span><br><span class="line">    <span class="keyword">local</span> t,r,e = json.decode(data)<span class="comment">--解包收到的json数据，具体参考手册：https://support.huaweicloud.com/api-IoT/iot_06_3011.html</span></span><br><span class="line">    <span class="keyword">if</span> r <span class="keyword">and</span> <span class="built_in">type</span>(t)==<span class="string">&quot;table&quot;</span> <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;receive.msgType&quot;</span>,t.msgType)<span class="comment">--表示平台下发的请求，固定值“cloudReq”</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;receive.serviceId&quot;</span>,t.serviceId)<span class="comment">--设备服务的ID</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;receive.cmd&quot;</span>,t.cmd)<span class="comment">--服务的命令名，参见profile的服务命令定义</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;receive.mid&quot;</span>,t.mid)<span class="comment">--2字节无符号的命令id，平台内部分配（范围1-65535），设备命令响应平台时，需要返回该值</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> t.cmd == <span class="string">&quot;testcmd&quot;</span> <span class="keyword">then</span><span class="comment">--匹配上了之前写的cmd名称</span></span><br><span class="line">            <span class="built_in">log</span>.info(<span class="string">&quot;receive.paras.testControl&quot;</span>,t.paras.testControl)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">local</span> clk = <span class="built_in">os</span>.<span class="built_in">date</span>(<span class="string">&quot;*t&quot;</span>,<span class="built_in">os</span>.<span class="built_in">time</span>()<span class="number">-3600</span>*<span class="number">8</span>)<span class="comment">--获取UTC时间的table</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">--组包回复用的json，具体参考手册：https://support.huaweicloud.com/api-IoT/iot_06_3012.html</span></span><br><span class="line">            <span class="keyword">local</span> reply = &#123;</span><br><span class="line">                msgType = <span class="string">&quot;deviceRsp&quot;</span>,<span class="comment">--固定值“deviceRsp”，表示设备的应答消息</span></span><br><span class="line">                mid = t.mid,<span class="comment">--2字节无符号的命令ID，根据平台下发命令时的mid返回给平台。建议在消息中携带此参数</span></span><br><span class="line">                errcode = <span class="number">0</span>,<span class="comment">--请求处理的结果码。“0”表示成功。“1”表示失败</span></span><br><span class="line">                body = &#123;<span class="comment">--命令的应答，具体字段由profile定义</span></span><br><span class="line">                    testReply = <span class="string">&quot;done&quot;</span>,<span class="comment">--这是之前后台设置的那个</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sys.publish(<span class="string">&quot;pub_msg&quot;</span>,json.encode(reply))<span class="comment">--上报返回的报文</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">--组包上报用的json，具体参考手册：https://support.huaweicloud.com/api-IoT/iot_06_3010.html</span></span><br><span class="line">            <span class="keyword">local</span> upload = &#123;</span><br><span class="line">                msgType = <span class="string">&quot;deviceReq&quot;</span>,<span class="comment">--表示设备上报数据，固定值“deviceReq”</span></span><br><span class="line">                data = &#123;<span class="comment">--一组服务的数据（具体结构参考下表ServiceData定义表），当需要上传批量数据时，可在该字段中添加数据</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        serviceId = <span class="string">&quot;testServer&quot;</span>,<span class="comment">--设备服务的ID</span></span><br><span class="line">                        serviceData = &#123;<span class="comment">--一个服务的数据，具体字段在profile里定义</span></span><br><span class="line">                            testProperty = t.paras.testControl,<span class="comment">--把刚刚下发的东西，上报上去</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                        eventTime = <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%02d%02d%02d%02d%02d%02dZ&quot;</span>,<span class="comment">--设备采集数据UTC时间（格式：yyyyMMddTHHmmssZ）</span></span><br><span class="line">                                    clk.year,clk.month,clk.day,clk.hour,clk.<span class="built_in">min</span>,clk.sec)<span class="comment">--时间戳</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            sys.publish(<span class="string">&quot;pub_msg&quot;</span>,json.encode(upload))<span class="comment">--上报返回的报文</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;json.decode error&quot;</span>,e)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>
<p>烧录到设备里，以备测试</p>
<h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>后台下发数据，模块回复</p>
<p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_10125.jpg"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/07/18/593/" data-id="ckkfmdgcf008gvkcg08pb3zs5" data-title="使用Lua脚本连接华为云物联网服务" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-592" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/17/592/" class="article-date">
  <time class="dt-published" datetime="2019-07-17T14:45:57.000Z" itemprop="datePublished">2019-07-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/07/17/592/">教你用Air720 模块通过AT指令以MQTTS方式连接华为云（下篇）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://oldask.openluat.com/article/902">教你用Air720 模块通过AT指令以MQTTS方式连接华为云(上篇)</a></p>
<h1 id="生成MQTTS连接参数"><a href="#生成MQTTS连接参数" class="headerlink" title="生成MQTTS连接参数"></a>生成MQTTS连接参数</h1><p>上篇创建了真实测试设备，需要记录下设备ID和密匙，用于生成连接参数。<br><img src="/static/editormd/php/../uploads/5_34803.jpg" alt="![](/static/editormd/php/../uploads/5_49337.jpg)"><br>1.设备ID<br><code>9e352064-f339-45e3-842d-ab7b27616414</code><br>2.密匙<br><code>4aa2c87b6696ee37ce83</code></p>
<p>点击确定后进入在线调测页面<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_50453.jpg"></p>
<p>点击左侧菜单设备管理，可以看到设备列表中，刚创建的设备状态是离线。一会儿使用Air720连接成功后，就变成在线状态了。<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_40999.jpg"><br>点击左侧对接信息，可得到MQTT的连接ip和好、端口号<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_78142.jpg"></p>
<h2 id="MQTT连接参数"><a href="#MQTT连接参数" class="headerlink" title="MQTT连接参数"></a>MQTT连接参数</h2><p>根据文档<a target="_blank" rel="noopener" href="https://support.huaweicloud.com/api-IoT/iot_06_3009.html" title="MQTT CONNECT连接鉴权">MQTT CONNECT连接鉴权</a>，摘要如下：<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_39842.jpg"></p>
<p>cliendID=9e352064-f339-45e3-842d-ab7b27616414_0_0_2019071713<br>Username=9e352064-f339-45e3-842d-ab7b27616414<br>Password=162298e5d1aee9a239ea5b5fd711c31393d1a4b05e7cea5eba912e6c26b3305e</p>
<blockquote>
<p>上面的Password的值为使用“HMACSHA256”算法以时间戳为秘钥，对secret进行加密后的值。secret为注册设备时平台返回的secret，也就是上面创建设备时生成密匙。</p>
</blockquote>
<p>这里给出一段使用Python生成上述参数的代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="keyword">import</span> pytz</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">HMACSHA256</span>(<span class="params">message,key</span>):</span></span><br><span class="line">    <span class="keyword">return</span> hmac.new(key.encode(<span class="string">&#x27;utf-8&#x27;</span>),message.encode(<span class="string">&#x27;utf-8&#x27;</span>),hashlib.sha256).hexdigest()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 本地时间转换为UTC</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">local_to_utc</span>(<span class="params">local_ts, utc_format=<span class="string">&#x27;%Y%m%d%H&#x27;</span></span>):</span></span><br><span class="line">    local_tz = pytz.timezone(<span class="string">&#x27;Asia/Chongqing&#x27;</span>)</span><br><span class="line">    local_dt = local_tz.localize(local_ts)</span><br><span class="line">    utc_dt = local_dt.astimezone(pytz.utc)</span><br><span class="line">    <span class="keyword">return</span> utc_dt.strftime(utc_format)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_utc_timstamp</span>():</span></span><br><span class="line">    local_tz=pytz.timezone(<span class="string">&#x27;Asia/Shanghai&#x27;</span>)</span><br><span class="line">    local_dt=local_tz.localize(datetime.datetime.now())</span><br><span class="line">    utc_dt=local_dt.astimezone(pytz.utc)</span><br><span class="line">    <span class="keyword">return</span> utc_dt.strftime(<span class="string">&#x27;%Y%m%dT%H%M%SZ&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">	deviceId=<span class="string">&#x27;9e352064-f339-45e3-842d-ab7b27616414&#x27;</span></span><br><span class="line">    secret = <span class="string">&#x27;4aa2c87b6696ee37ce83&#x27;</span></span><br><span class="line">	utctimestamp = local_to_utc(datetime.datetime.now())</span><br><span class="line">    clientId = <span class="string">&#x27;_&#x27;</span>.join([deviceId , <span class="string">&#x27;0&#x27;</span> , <span class="string">&#x27;0&#x27;</span> , utctimestamp])</span><br><span class="line">    print(clientId)</span><br><span class="line">    password = HMACSHA256(secret , utctimestamp)</span><br><span class="line">    print(password)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>使用上述参数和地址及端口号，已经CA证书就可以成功连接到华为云了。<br>这时回到设备管理页面，可以看到设备状态已经变为在线。<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_59655.jpg"></p>
<h2 id="Topic订阅、发布"><a href="#Topic订阅、发布" class="headerlink" title="Topic订阅、发布"></a>Topic订阅、发布</h2><p>订阅和发布，参考文档说明<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_39029.jpg"><br>根据上面描述，<br>设备如果要从平台获取消息和数据，需要在登录成功后发起mqtt消息订阅topic<br>设备订阅：订阅消息topic格式为：“/huawei/v1/devices/9e352064-f339-45e3-842d-ab7b27616414/command/json”<br>设备如果要通过MQTT通道上报数据，需要发给指定的topic<br>上报消息的topic格式为：“/huawei/v1/devices/9e352064-f339-45e3-842d-ab7b27616414/data/json”</p>
<p>订阅上述topic后，进入设备调试页面<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_95641.jpg"><br>从应用模拟界面发toggle字段命令”ON”,点击发送<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_91475.jpg"><br>从sscom的Air720串口接收可以看到，模块收到华为云平台下发的JSON格式的命令。toggle的值是“ON”<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_75366.jpg"></p>
<h2 id="Air720数据上报"><a href="#Air720数据上报" class="headerlink" title="Air720数据上报"></a>Air720数据上报</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_80611.jpg"></p>
<p>根据这个说明，结合设备的Profile订阅，数据上报的格式为<br>MQTT Topic: /huawei/v1/devices/9e352064-f339-45e3-842d-ab7b27616414/data/json<br>Air720发送的payload：<br>{<br>    “msgType”: “deviceReq”,<br>    “data”: [<br>    {<br>        “serviceId”: “ServiceWin”,<br>        “serviceData”: {<br>            “Status”: 0<br>        },<br>        “eventTime”: “ 20170915T121603Z”<br>    }<br>    ]<br>}</p>
<p>设备发送后，在应用模拟端收到status数据0<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_33822.jpg"></p>
<p>通过上述内容，实现了一个MQTTS的连接，订阅，上报的过程，后续就可以根据业务需求具体实现一个物联网应用了。其他华为云的功能不再赘述，自己挖掘一下吧。</p>
<p>当然Air720模块还有其他很强大的功能，特别是支持Lua，强大的二次开发能力，实时技术支持，软件开源包括底层C代码，和Lua代码，值得我们去细细研究。</p>
<p><a target="_blank" rel="noopener" href="http://oldask.openluat.com/article/902">教你用Air720 模块通过AT指令以MQTTS方式连接华为云(上篇)</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/07/17/592/" data-id="ckkfmdgcf008fvkcgaqpw0w7z" data-title="教你用Air720 模块通过AT指令以MQTTS方式连接华为云（下篇）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-591" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/07/15/591/" class="article-date">
  <time class="dt-published" datetime="2019-07-15T15:35:09.000Z" itemprop="datePublished">2019-07-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/07/15/591/">教你用Air720 模块通过AT指令以MQTTS方式连接华为云（上篇）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="http://oldask.openluat.com/article/903">教你用Air720 模块通过AT指令以MQTTS方式连接华为云(下篇)</a></p>
<h1 id="Air720模块介绍"><a href="#Air720模块介绍" class="headerlink" title="Air720模块介绍"></a>Air720模块介绍</h1><blockquote>
<p>Air720模块是一款带分集接收功能的4G多模无线通信模块，其中Air720D支持LTE-TDD/GPRS双模，Air720H支持LTE-TDD/LTE-FDD/TD-SCDMA/WCDMA/GPRS五模，二者硬件封装和软件完全兼容，几乎能够满足所有的M2M的需求，包括汽车及个人追踪服务、无线POS机、智能计量、工业级PDA以及其它M2M的应用<br>##Air720支持两种开发模式</p>
<ol>
<li>传统的AT指令模式：MCU通过AT指令控制Air720H进行网络数据传输或其他各种应用；</li>
<li>合宙特有的Lua脚本二次开发模式：Air720H拥有丰富的硬件接口及GPIO，可以通过Lua脚本调用由合宙<br>官方提供的API接口对外设或GPIO进行编程设计，省掉主控MCU，极大的减少了客户的开发周期和成本</li>
</ol>
</blockquote>
<p>本文介绍一下如何使用AT指令模式连接华为云。</p>
<p>首先介绍一下涉及到的AT指令，AT指令固件从V1104版本增加了MQTT证书认证方式，而这也是华为云MQTT连接需要CA证书，正好可以使用Air720模块实现这个功能。</p>
<table>
<thead>
<tr>
<th>方向</th>
<th>AT命令</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>发</td>
<td>AT+CGATT?</td>
<td>查看当前GPRS附着状态</td>
</tr>
<tr>
<td>收</td>
<td>+CGATT: 1</td>
<td>state&gt;=1， 标明当前GPRS已经附着</td>
</tr>
<tr>
<td></td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td>发</td>
<td>AT+FSCREATE=”server.crt”</td>
<td>创建CA 证书文件</td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td>发</td>
<td>AT+FSWRITE=”server.crt”,0,1402,15</td>
<td>1402是华为云CA证书的实际长度，15是超时时间</td>
</tr>
<tr>
<td>收</td>
<td>&gt;</td>
<td>出现&gt;符号后输入CA证书文件的内容</td>
</tr>
<tr>
<td>发</td>
<td>CA证书文件的实际内容</td>
<td></td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td>证书接收完成</td>
</tr>
<tr>
<td>发</td>
<td>AT+SSLCFG=”cacert”,88,”server.crt”</td>
<td>设置CA证书证书文件名称， server.crt为CA证书文件名称</td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td>发</td>
<td>AT+MCONFIG=<clientid>,<username>,<password></td>
<td></td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td>发</td>
<td>AT+SSLMIPSTART=<svraddr>,<port></td>
<td></td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td>收</td>
<td>CONNECT OK</td>
<td>收到这条后发下面指令</td>
</tr>
<tr>
<td>发</td>
<td>AT+MCONNECT=1,60</td>
<td>建立mqtt会话</td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td>收</td>
<td>CONNACK OK</td>
<td>收到CONNACK OK后才能发布和订阅消息</td>
</tr>
<tr>
<td>发</td>
<td>AT+MSUB=”mqtt/topic”,0</td>
<td>订阅</td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td></td>
</tr>
<tr>
<td>收</td>
<td>SUBACK</td>
<td></td>
</tr>
<tr>
<td>发</td>
<td>AT+MPUB=”mqtt/topic”,0,0,”SSSSddddd”</td>
<td></td>
</tr>
<tr>
<td>收</td>
<td>+MSUB: “mqtt/topic”,9 byte,SSSSddddd</td>
<td></td>
</tr>
<tr>
<td>发</td>
<td>AT+MDISCONNECT</td>
<td>关闭MQTT连接</td>
</tr>
<tr>
<td>收</td>
<td>OK</td>
<td></td>
</tr>
</tbody></table>
<p><code>以上是涉及MQTTS连接的指令，具体指令参加官网AT命令手册</code></p>
<p>下面先用SSCOM以手动方式测试一下连接华为云的方法，其中的连接参数是我已经在华为云建立好的设备连接参数，后文会介绍如何在华为云建立产品和设备，并获取连接参数的方法。</p>
<hr>
<ol>
<li>华为云CA证书。把下面内容保存到一个文本文件中，命名为server.crt<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIID4DCCAsigAwIBAgIJAK97nNS67HRvMA0GCSqGSIb3DQEBCwUAMFMxCzAJBgNV</span><br><span class="line">BAYTAkNOMQswCQYDVQQIEwJHRDELMAkGA1UEBxMCU1oxDzANBgNVBAoTBkh1YXdl</span><br><span class="line">aTELMAkGA1UECxMCQ04xDDAKBgNVBAMTA0lPVDAeFw0xNjA1MDQxMjE3MjdaFw0y</span><br><span class="line">NjA1MDIxMjE3MjdaMFMxCzAJBgNVBAYTAkNOMQswCQYDVQQIEwJHRDELMAkGA1UE</span><br><span class="line">BxMCU1oxDzANBgNVBAoTBkh1YXdlaTELMAkGA1UECxMCQ04xDDAKBgNVBAMTA0lP</span><br><span class="line">VDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBAJxM9fwkwvxeILpkvoAM</span><br><span class="line">Gdqq3x0G9o445F6Shg3I0xmmzu9Of8wYuW3c4jtQ&#x2F;6zscuIGyWf06ke1z&#x2F;&#x2F;AVZ&#x2F;o</span><br><span class="line">dp8LkuFbBbDXR5swjUJ6z15b6yaYH614Ty&#x2F;d6DrCM+RaU+FWmxmOon9W&#x2F;VELu2BB</span><br><span class="line">NXDQHJBSbWrLNGnZA2erk4JSMp7RhHrZ0QaNtT4HhIczFYtQ2lYF+sQJpQMrjoRn</span><br><span class="line">dSV9WB872Ja4DgcISU1+wuWLmS&#x2F;NKjIvOWW1upS79yu2I4Rxos2mFy9xxz311rGC</span><br><span class="line">Z3X65ejFNzCUrNgf6NEP1N7wB9hUu7u50aA+&#x2F;56D7EgjeI0gpFytC+a4f6JCPVWI</span><br><span class="line">Lr0CAwEAAaOBtjCBszAdBgNVHQ4EFgQUcGqy59oawLEgMl21&#x2F;&#x2F;7F5RyABpwwgYMG</span><br><span class="line">A1UdIwR8MHqAFHBqsufaGsCxIDJdtf&#x2F;+xeUcgAacoVekVTBTMQswCQYDVQQGEwJD</span><br><span class="line">TjELMAkGA1UECBMCR0QxCzAJBgNVBAcTAlNaMQ8wDQYDVQQKEwZIdWF3ZWkxCzAJ</span><br><span class="line">BgNVBAsTAkNOMQwwCgYDVQQDEwNJT1SCCQCve5zUuux0bzAMBgNVHRMEBTADAQH&#x2F;</span><br><span class="line">MA0GCSqGSIb3DQEBCwUAA4IBAQBgv2PQn66gRMbGJMSYS48GIFqpCo783TUTePNS</span><br><span class="line">tV8G1MIiQCpYNdk2wNw&#x2F;iFjoLRkdx4va6jgceht5iX6SdjpoQF7y5qVDVrScQmsP</span><br><span class="line">U95IFcOkZJCNtOpUXdT+a3N+NlpxiScyIOtSrQnDFixWMCJQwEfg8j74qO96UvDA</span><br><span class="line">FuTCocOouER3ZZjQ8MEsMMquNEvMHJkMRX11L5Rxo1pc6J&#x2F;EMWW5scK2rC0Hg91a</span><br><span class="line">Lod6aezh2K7KleC0V5ZlIuEvFoBc7bCwcBSAKA3BnQveJ8nEu9pbuBsVAjHOroVb</span><br><span class="line">8&#x2F;bL5retJigmAN2GIyFv39TFXIySw+lW0wlp+iSPxO9s9J+t</span><br><span class="line">-----END CERTIFICATE-----</span><br></pre></td></tr></table></figure></li>
<li>连接参数</li>
</ol>
<p>-1.  <code>AT+MCONFIG=8598553f-1f3d-47e6-a7b4-bbdabce316ba_0_0_2019071115,8598553f-1f3d-47e6-a7b4-bbdabce316ba,36d37c72b6cb7f5eb04cc2499946d835121e22ae866783cf9792627b7ca59624</code><br>-2. <code>AT+SSLMIPSTART=49.4.93.24,8883</code><br>-3. <code>AT+MSUB=&quot;/huawei/v1/devices/8598553f-1f3d-47e6-a7b4-bbdabce316ba/command/json&quot;, 0</code><br>-4.<code>AT+MSUB=&quot;/huawei/v1/devices/8598553f-1f3d-47e6-a7b4-bbdabce316ba/data/json&quot;, 0</code><br>-5.<code>AT + MPUB = &quot;/huawei/v1/devices/8598553f-1f3d-47e6-a7b4-bbdabce316ba/data/json&quot;, 0,0,&quot;&#123;\22msgType\22:\22deviceReq\22,\22data\22: [&#123;\22serviceId\22: \22ServiceWin\22,\22serviceData\22:&#123;\22Status\22: &#125;,\22eventTime\22:\2220180915T121606Z\22&#125;]&#125;&quot;</code></p>
<p>3.连接过程和结果，按照下图命令顺序和上面给出的连接参数，可以看到连接，订阅，发布几个过程成功。<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_73562.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_58465.jpg"></p>
<hr>
<h1 id="华为云设置过程"><a href="#华为云设置过程" class="headerlink" title="华为云设置过程"></a>华为云设置过程</h1><h2 id="注册华为云账号，并完成实名认证。"><a href="#注册华为云账号，并完成实名认证。" class="headerlink" title="注册华为云账号，并完成实名认证。"></a>注册华为云账号，并完成实名认证。</h2><p>过程就不详述了。具体进入<a target="_blank" rel="noopener" href="https://developer.huaweicloud.com/iot" title="华为云IOT开发者注册">华为云IOT开发者注册链接</a>，按照提示一步步完成</p>
<h2 id="进入开发者中心"><a href="#进入开发者中心" class="headerlink" title="进入开发者中心"></a>进入开发者中心</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_39077.jpg" alt="点击免费体验" title="点击免费体验"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_65241.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_13351.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_78907.jpg"></p>
<h2 id="点击-，新建项目"><a href="#点击-，新建项目" class="headerlink" title="点击+，新建项目"></a>点击+，新建项目</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_14074.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_57252.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_80437.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_31978.jpg"><br>保存应用ID和密匙，这个在应用开发时需要用到，在MQTTS链接时不需要。</p>
<h2 id="进入新建项目，新建产品"><a href="#进入新建项目，新建产品" class="headerlink" title="进入新建项目，新建产品"></a>进入新建项目，新建产品</h2><p><img src="http://doc.openluat.com/api/static/editormd/uploads/5_37227.jpg"><br>点击产品开发<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_16380.jpg"><br>点击新建产品<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_85695.jpg"><br>选择自定义产品<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_37466.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_62749.jpg"><br>填写产品信息，其中协议类型选MQTT，数据格式选JSON<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_76915.jpg"><br>然后进入产品开发，选刚刚建立的产品，进入Profile定义，也就是定义数据点<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_80871.jpg"><br>参照下图进行profile定义，实际上是定义了一组Json数据格式<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_40313.jpg"><br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_80136.jpg"><br>进入在线调测，点击新增测试设备<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_97498.jpg"><br>选择真实设备，设备名和标识随便填，连接方式选直连<br><img src="http://doc.openluat.com/api/static/editormd/uploads/5_99369.jpg"><br>点击创建，生成的设备ID和密匙要记下来，一会儿需要用来生成MQTTS的连接参数。</p>
<p>写不下了，分成两篇，未完待续，见下篇。<br><a target="_blank" rel="noopener" href="http://oldask.openluat.com/article/903">教你用Air720 模块通过AT指令以MQTTS方式连接华为云(下篇)</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/07/15/591/" data-id="ckkfmdgcf008evkcgbd2hb53m" data-title="教你用Air720 模块通过AT指令以MQTTS方式连接华为云（上篇）" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-590" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/20/590/" class="article-date">
  <time class="dt-published" datetime="2019-06-20T10:00:24.000Z" itemprop="datePublished">2019-06-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/20/590/">安卓ril 无法上网初步分析</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;p style=&quot;margin:0cm;margin-bottom:.0001pt&quot;&gt;&lt;span style=&quot;font-size:20.0pt;
</code></pre>
<p>font-family:&quot;微软雅黑&quot;,sans-serif”&gt;初步分析安卓</span><span lang="EN-US" style="font-size:
20.0pt;font-family:&quot;Calibri Light&quot;,sans-serif">RIL LOG </span><span style="font-size:20.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">（客户支持）</span><span lang="EN-US" style="font-size:20.0pt;font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#767676">2019</span><span style="font-size:10.0pt;font-family:&quot;微软雅黑&quot;,sans-serif;color:#767676">年</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#767676">6</span><span style="font-size:10.0pt;font-family:&quot;微软雅黑&quot;,sans-serif;color:#767676">月</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#767676">20</span><span style="font-size:10.0pt;font-family:&quot;微软雅黑&quot;,sans-serif;color:#767676">日</span><span lang="EN-US" style="font-size:10.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#767676">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
10.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:#767676">16:09&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">一</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">安装</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">adb </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">驱动<span lang="EN-US">(</span>备用<span lang="EN-US">)</span></span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">1.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">设备管理器识别安卓设备后（图标可能是<span lang="EN-US">adb </span>设备，也可能是便携设备），输入<span lang="EN-US">adb logcat -b radio -v time &gt; d:log.txt (</span>抓取时间适当长点<span lang="EN-US">)</span></span><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">二<span lang="EN-US"> ,</span>设备驱动问题<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">1.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">在<span lang="EN-US">adb shell </span>登入安卓系统后，发送<span lang="EN-US">lsusb </span>查看 是否有<span lang="EN-US"> 1826:4e3d </span>的设备，如果没有，让客户确认是否已经支持我们的设备（客户需要根据</span><span lang="EN-US"><a target="_blank" rel="noopener" href="http://oldask.openluat.com/article/95">http://oldask.openluat.com/article/95</a></span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">修改<span lang="EN-US">linux<br></span>内核），如果确认已经支持，则查看硬件问题</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">三 </span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">,</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">网络环境问题</span><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">1.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">查看模块是否支持客户所用的卡</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">2.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">让客户在自己手机上测试该卡是否有效</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">3.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">搜索</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">log</span><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"> </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">中<span lang="EN-US">csq </span>和<span lang="EN-US"><br>cesq </span>是否正常 ，用来判断当地的信号，以及板子的问题（经常客户忘插天线要注意</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">!!!</span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">）</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">4.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">查看当地的频段是否在模块支持的频段范围内（通过手机安装</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">Cellular-Z&nbsp; </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">和正在使用的卡来看当前的频段</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">.</span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">这一步可以最后再做）</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&lt;o:p&gt;</o:p></span></p><table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" title="" summary="" style="border: none;"><br> <tbody><tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span style="color:windowtext">型号<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><br>  </td><br>  <td width="165" valign="top" style="width:123.75pt;border:solid #A3A3A3 1.0pt;
  border-left:none;mso-border-left-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">2G</span><span style="color:windowtext">频段支持<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><br>  </td><br>  <td width="149" valign="top" style="width:111.75pt;border:solid #A3A3A3 1.0pt;
  border-left:none;mso-border-left-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">3G</span><span style="color:windowtext">频段支持<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><br>  </td><br>  <td width="178" valign="top" style="width:133.65pt;border:solid #A3A3A3 1.0pt;
  border-left:none;mso-border-left-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">4G</span><span style="color:windowtext">频段支持<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><br>  </td><br> </tr><br> <tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  border-top:none;mso-border-top-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">720H&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="167" valign="top" style="width:125.15pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">GSM850/900/1800MHZ&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="151" valign="top" style="width:113.2pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">WCDMA:B1/B8&lt;o:p&gt;</o:p></span></p><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">TD-SCDMA:B34/B39&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="199" valign="top" style="width:149.2pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE TDD:B38,B39,B40,B41&lt;o:p&gt;</o:p></span></p><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE FDD:B1,B3,B5,B8&lt;o:p&gt;</o:p></span></p><br>  </td><br> </tr><br> <tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  border-top:none;mso-border-top-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">720D&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="165" valign="top" style="width:123.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">GSM900/1800MHZ&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="149" valign="top" style="width:111.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="199" valign="top" style="width:149.2pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE TDD:B38,B39,B40,B41&lt;o:p&gt;</o:p></span></p><br>  </td><br> </tr><br> <tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  border-top:none;mso-border-top-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">720G&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="165" valign="top" style="width:123.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="151" valign="top" style="width:113.2pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">WCDMA:B1/B8&lt;o:p&gt;</o:p></span></p><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">TD-SCDMA:B34/B39&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="199" valign="top" style="width:149.2pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE TDD:B38,B39,B40,B41&lt;o:p&gt;</o:p></span></p><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE FDD:B1,B3,B5,B8&lt;o:p&gt;</o:p></span></p><br>  </td><br> </tr><br> <tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  border-top:none;mso-border-top-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">720T&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="165" valign="top" style="width:123.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="149" valign="top" style="width:111.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="178" valign="top" style="width:133.65pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE FDD:B5&lt;o:p&gt;</o:p></span></p><br>  </td><br> </tr><br> <tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  border-top:none;mso-border-top-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">720U&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="165" valign="top" style="width:123.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="149" valign="top" style="width:111.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">WCDMA:B1/B8&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="189" valign="top" style="width:141.7pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE FDD:B1,B3,B5,B8&lt;o:p&gt;</o:p></span></p><br>  </td><br> </tr><br> <tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  border-top:none;mso-border-top-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">720GM&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="165" valign="top" style="width:123.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="151" valign="top" style="width:113.2pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">WCDMA:B1/B8&lt;o:p&gt;</o:p></span></p><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">TD-SCDMA:B34/B39&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="199" valign="top" style="width:149.2pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE TDD:B38,B39,B40,B41&lt;o:p&gt;</o:p></span></p><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE FDD:B8&lt;o:p&gt;</o:p></span></p><br>  </td><br> </tr><br> <tr><br>  <td width="64" valign="top" style="width:48.0pt;border:solid #A3A3A3 1.0pt;
  border-top:none;mso-border-top-alt:solid #A3A3A3 1.0pt;padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">720M&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="165" valign="top" style="width:123.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="149" valign="top" style="width:111.75pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif;color:windowtext">&nbsp;&lt;o:p&gt;</o:p></span></p><br>  </td><br>  <td width="178" valign="top" style="width:133.65pt;border-top:none;border-left:
  none;border-bottom:solid #A3A3A3 1.0pt;border-right:solid #A3A3A3 1.0pt;
  mso-border-top-alt:solid #A3A3A3 1.0pt;mso-border-left-alt:solid #A3A3A3 1.0pt;
  padding:4.0pt 4.0pt 4.0pt 4.0pt"><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE TDD:B39&lt;o:p&gt;</o:p></span></p><br>  <p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="color:windowtext">LTE FDD:B8&lt;o:p&gt;</o:p></span></p><br>  </td><br> </tr></p>
</tbody></table><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&nbsp;<o:p></o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><img src="http://oldask.openluat.com/image/show/attachments-2019-06-iL3g3c1C5d0b596d56a9c.jpg" class="img-responsive" style="width: 540px;"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif;mso-no-proof:yes"><span style="font-size: 11pt; font-family: 微软雅黑, sans-serif;"><br></span></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif;mso-no-proof:yes"><span style="font-size: 11pt; font-family: 微软雅黑, sans-serif;"><br></span></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif;mso-no-proof:yes"><span style="font-size: 11pt; font-family: 微软雅黑, sans-serif;">四</span><span lang="EN-US" style="font-size: 11pt;">:</span><span style="font-size: 11pt; font-family: 微软雅黑, sans-serif;">模块业务问题</span></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">1.</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">通过查看</span><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">cereg</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">&nbsp; </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">和<span lang="EN-US"> creg</span>来查看是注册上什么网<span lang="EN-US">(</span>注册上<span lang="EN-US">4G </span>是比较理想的<span lang="EN-US">)</span>，如果已经注册上</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">4G </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">则向下查看</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">&nbsp;1.1. </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">搜索</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">pppd_create_thread succ</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"> </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">，没有发现</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:27.0pt;
margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;Calibri&quot;,sans-serif">1.1.1&nbsp;&nbsp; </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">需要搜索客户的</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">apns-conf.xml
</span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">看下是否支持当前卡（通过radio 的log 搜索cops 就可以知道），如果没有，则添加，添加后删除<span lang="EN-US">telephony.db </span>后重启安卓板，具体位置可以通过命令行 </span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">find</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"> -name </span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">apns-conf.xml&nbsp; </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">和 </span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">find</span><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"> -name telephony.db</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&nbsp; </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">来搜索</span><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p><cite><span lang="EN-US" style="font-size:9.0pt;font-family:&quot;Calibri&quot;,sans-serif;
mso-bidi-font-family:宋体;color:#595959">&nbsp;</span></cite><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">&nbsp;
1.2.</span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">搜索</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">pppd_create_thread
succ</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">
</span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">，有发现</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:27.0pt;
margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;Calibri&quot;,sans-serif">1.2.1</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">&nbsp; </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">搜索</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">get_local_ip
</span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">查看是否 分配到<span lang="EN-US">ip</span></span><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:27.0pt;
margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;微软雅黑&quot;,sans-serif">&nbsp;&nbsp;&nbsp; </span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">1.2.1.1</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">&nbsp; </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">有分配</span><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,sans-serif">IP</span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">，则在命令行 输入<span lang="EN-US">ifconfig </span>查看是否出现<span lang="EN-US">ppp0 </span>网卡</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:54.0pt;
margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;Calibri&quot;,sans-serif">1.2.1.1.1&nbsp; </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">出现</span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">ppp </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">输入<span lang="EN-US"> ping
115.239.210.27</span></span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:54.0pt;
margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;微软雅黑&quot;,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">1.2.1.1.1.1&nbsp;&nbsp; </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">出现<span lang="EN-US"> connect:Networkis unreachable&nbsp; </span>则输入命令<span lang="EN-US">&nbsp; ip route add default dev ppp0 table ppp0 </span>，然后再<span lang="EN-US"> ping </span>，如果能<span lang="EN-US"> ping </span>通 这是路由问题，需要修改<span lang="EN-US">ip-up </span>文件</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif"><o:p></o:p></span></p><p style="margin-top:0cm;margin-right:0cm;margin-bottom:0cm;margin-left:54.0pt;
margin-bottom:.0001pt"><span lang="EN-US" style="font-size:11.0pt;font-family:
&quot;微软雅黑&quot;,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;Calibri&quot;,sans-serif">1.2.1.1.1.2&nbsp;&nbsp;&nbsp; </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">可以</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">ping </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">通 则输入<span lang="EN-US"> ping&nbsp; </span></span><span lang="EN-US"><a target="_blank" rel="noopener" href="http://www.baidu.com/"><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">www.baidu.com</span></a></span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"> ,</span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">如果出现<span lang="EN-US">&nbsp; pingunknown host&nbsp;</span></span><span lang="EN-US"><a target="_blank" rel="noopener" href="http://www.baidu.com/"><span style="font-size: 10.5pt; font-family: 微软雅黑, sans-serif; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">www.baidu.com</span></a></span><span lang="EN-US" style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"> </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">则 是<span lang="EN-US">dns </span>解析问题<span lang="EN-US"><o:p></o:p></span></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">五</span><span lang="EN-US" style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,sans-serif">:</span><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">RIL </span><span style="font-size:11.0pt;
font-family:&quot;微软雅黑&quot;,sans-serif">版本问题<span lang="EN-US"><o:p></o:p></span></span></p><p>





















































</p><p style="margin:0cm;margin-bottom:.0001pt"><span lang="EN-US" style="font-size:
11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif">在<span lang="EN-US">log </span>中搜索，<span lang="EN-US">ver&nbsp; </span>可以找到安卓<span lang="EN-US">ril </span>版本（老<span lang="EN-US">ril </span>版本没有版本号）和 模块 版本，最好都用最新</span></p><p style="margin:0cm;margin-bottom:.0001pt"><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"><br></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"><br></span></p><p style="margin:0cm;margin-bottom:.0001pt"><span style="font-size:11.0pt;font-family:&quot;微软雅黑&quot;,sans-serif"><br></span></p>


      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/06/20/590/" data-id="ckkfmdgf100e5vkcg2vzu9gen" data-title="安卓ril 无法上网初步分析" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-589" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/16/589/" class="article-date">
  <time class="dt-published" datetime="2019-06-16T13:41:54.000Z" itemprop="datePublished">2019-06-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/16/589/">关于2G模块HTTPS请求SSL握手失败的原因</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>按照官方给的DEMO里的Https请求我的服务器，结果发生如下错误：</p><p>提示SSL握手失败。</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-06-KU2ODW8v5d064622a6c42.png" class="img-responsive" style="width: 544px;"></p><p>解决办法：</p><p>因为2G模块ssl证书只支持RSA,cipherSuite只有AES128_SHA,AES128_SHA256,AES256_SHA,AES256_SHA256这4种算法，而我的服务器配置是这样的：</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-06-edwNWrRf5d0646b139736.png" class="img-responsive" style="width: 559.5px;">准备修改全局修改又怕影响我的其他网站，所以只修改了这个网站的配置，修改代码如下：</p><p><img src="http://oldask.openluat.com/image/show/attachments-2019-06-G39UDlOY5d064706dd6f0.png" class="img-responsive" style="width: 902px;">希望对你能有帮助！！！</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/06/16/589/" data-id="ckkfmdgce008dvkcgb3vd37mw" data-title="关于2G模块HTTPS请求SSL握手失败的原因" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-588" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/11/588/" class="article-date">
  <time class="dt-published" datetime="2019-06-11T06:44:37.000Z" itemprop="datePublished">2019-06-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/11/588/">luat i2c驱动 mpu6050 获取数据</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> i2cslaveaddr = <span class="number">0x68</span> <span class="comment">--mpu6050</span></span><br><span class="line"><span class="keyword">local</span> i2cid = <span class="number">2</span></span><br><span class="line"><span class="keyword">if</span> i2c.setup(i2cid,i2c.SLOW) ~= i2c.SLOW <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">log</span>.<span class="built_in">error</span>(<span class="string">&quot;testI2c.init&quot;</span>,<span class="string">&quot;fail&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">sys.taskInit(<span class="function"><span class="keyword">function</span> <span class="params">()</span></span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0X6b</span>,<span class="number">0x80</span>&#125;)<span class="comment">--复位</span></span><br><span class="line">    sys.wait(<span class="number">100</span>)</span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0X6b</span>,<span class="number">0x00</span>&#125;)<span class="comment">--唤醒</span></span><br><span class="line">    sys.wait(<span class="number">100</span>)</span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x1b</span>,<span class="number">0x80</span>&#125;)<span class="comment">--陀螺仪传感器±2000dps</span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x1c</span>,<span class="number">0x00</span>&#125;)<span class="comment">--加速度传感器±2g</span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x19</span>,<span class="number">19</span>&#125;)<span class="comment">--采样率50hz</span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x38</span>,<span class="number">0x00</span>&#125;)<span class="comment">--关闭所有中断</span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x6a</span>,<span class="number">0x00</span>&#125;)<span class="comment">--I2C主模式关闭</span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x23</span>,<span class="number">0x00</span>&#125;)<span class="comment">--关闭fifo</span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x37</span>,<span class="number">0x80</span>&#125;)<span class="comment">--int引脚低电平有效</span></span><br><span class="line">    i2c.send(i2cid,i2cslaveaddr,<span class="number">0x75</span>)<span class="comment">--读器件地址</span></span><br><span class="line">    <span class="keyword">local</span> revData = i2c.recv(i2cid,i2cslaveaddr,<span class="number">1</span>)</span><br><span class="line">    <span class="built_in">log</span>.info(<span class="string">&quot;i2c read&quot;</span>,revData:toHex())</span><br><span class="line">    <span class="keyword">if</span> revData:<span class="built_in">byte</span>() == <span class="number">0x68</span> <span class="keyword">then</span></span><br><span class="line">        i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x6b</span>,<span class="number">0x01</span>&#125;)<span class="comment">--设置x轴的pll为参考</span></span><br><span class="line">        i2c.send(i2cid,i2cslaveaddr,&#123;<span class="number">0x6c</span>,<span class="number">0x00</span>&#125;)<span class="comment">--加速度计与陀螺仪开启</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;i2c&quot;</span>,<span class="string">&quot;address not right&quot;</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="comment">--处理接收到的数据，变成正确数值</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">getTrueData</span><span class="params">(d)</span></span></span><br><span class="line">        i2c.send(i2cid,i2cslaveaddr,d)<span class="comment">--获取的地址</span></span><br><span class="line">        <span class="keyword">local</span> s = i2c.recv(i2cid,i2cslaveaddr,<span class="number">2</span>)<span class="comment">--获取2字节</span></span><br><span class="line">        <span class="keyword">return</span> s:<span class="built_in">byte</span>()*<span class="number">256</span> + s:<span class="built_in">byte</span>(<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span></span><br><span class="line">        sys.wait(<span class="number">50</span>)</span><br><span class="line">        <span class="keyword">local</span> gx = getTrueData(<span class="number">0x43</span>)/<span class="number">131</span></span><br><span class="line">        <span class="keyword">local</span> gy = getTrueData(<span class="number">0x44</span>)/<span class="number">131</span></span><br><span class="line">        <span class="keyword">local</span> gz = getTrueData(<span class="number">0x45</span>)/<span class="number">131</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;mpu6050.Gyroscope&quot;</span>,gx,gy,gz)</span><br><span class="line">        <span class="keyword">local</span> ax = getTrueData(<span class="number">0x3b</span>)/<span class="number">16</span></span><br><span class="line">        <span class="keyword">local</span> ay = getTrueData(<span class="number">0x3c</span>)/<span class="number">16</span></span><br><span class="line">        <span class="keyword">local</span> az = getTrueData(<span class="number">0x3d</span>)/<span class="number">16</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;mpu6050.Accelerometer&quot;</span>,ax,ay,az)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>)</span><br></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/06/11/588/" data-id="ckkfmdgce008cvkcg5jyaejxa" data-title="luat i2c驱动 mpu6050 获取数据" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-587" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/06/04/587/" class="article-date">
  <time class="dt-published" datetime="2019-06-04T02:19:18.000Z" itemprop="datePublished">2019-06-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2019/06/04/587/">GPS patch 天线调试应用误区说明</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>GPS patch天线非为标准件，天线频率偏移影响天线指标性能。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/06/04/587/" data-id="ckkfmdgce008bvkcgc2wpg8on" data-title="GPS patch 天线调试应用误区说明" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/38/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/37/">37</a><a class="page-number" href="/page/38/">38</a><span class="page-number current">39</span><a class="page-number" href="/page/40/">40</a><a class="page-number" href="/page/41/">41</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/40/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>