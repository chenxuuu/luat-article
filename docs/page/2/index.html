<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:type" content="website">
<meta property="og:title" content="Luat doc 社区文章静态页面镜像">
<meta property="og:url" content="https://doc.luatos.wiki/page/2/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="Luat doc 社区文章静态页面镜像">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-2388" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/23/2388/" class="article-date">
  <time class="dt-published" datetime="2021-01-23T08:13:30.000Z" itemprop="datePublished">2021-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/23/2388/">Mysql的一个并发问题</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="Mysql的一个并发问题"><a href="#Mysql的一个并发问题" class="headerlink" title="Mysql的一个并发问题"></a>Mysql的一个并发问题</h1><hr>
<h3 id="问题描述"><a href="#问题描述" class="headerlink" title="问题描述"></a>问题描述</h3><ul>
<li>有一个flask的http接口，会读取/更新一条记录，比如一个订单的状态。<br>那么必须锁定，不允许多个请求同时进行。<br>因为对mysql的锁了解不深，而且可能需要一次锁多个表的多个记录，所以借助外部的锁服务，在进行业务操作之前做一次性锁定。<br>发现还是会出现数据混乱。</li>
</ul>
<h3 id="查原因"><a href="#查原因" class="headerlink" title="查原因"></a>查原因</h3><ul>
<li>外部的锁服务是没问题的，业务操作确实是严格排队进行的，也就是原子的。</li>
<li>继续查，发现mysql读出来的数据概率性是老数据。虽然业务是严格排队进行的，前一个接口修改数据后已commit，后一个接口读mysql可能读出老数据。</li>
<li>这个就非常反常了。之前没仔细看mysql的文档，对事务相关的细节不清楚。</li>
<li>真正的原因是mysql的事务隔离和一致性读的机制。</li>
</ul>
<hr>
<h3 id="事务隔离级别"><a href="#事务隔离级别" class="headerlink" title="事务隔离级别"></a>事务隔离级别</h3><ul>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html">https://dev.mysql.com/doc/refman/5.7/en/innodb-transaction-isolation-levels.html</a><br>有四种隔离级别。mysql的innodb默认是<code>REPEATABLE READ</code>，我们默认也是用这个。先简单记住这个。</li>
</ul>
<h3 id="snapshot"><a href="#snapshot" class="headerlink" title="snapshot"></a>snapshot</h3><ul>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_snapshot">https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_snapshot</a><br>某个时间点的数据快照</li>
</ul>
<h3 id="consistent-read-一致性读"><a href="#consistent-read-一致性读" class="headerlink" title="consistent read 一致性读"></a>consistent read 一致性读</h3><ul>
<li><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_consistent_read">https://dev.mysql.com/doc/refman/5.7/en/glossary.html#glos_consistent_read</a><br>有两大类读，一致性读和带锁的读(我不知道有没有其他的说法)。<br>在<code>REPEATABLE READ</code>隔离级别下，一般的<code>select</code>默认都是一致性读。</li>
<li>一致性读，一定会借助一个<code>snapshot</code>，去读<code>snapshot</code>的数据。</li>
<li>在<code>REPEATABLE READ</code>隔离级别下，<code>snapshot</code>的时间点是事务开始后的第一个操作的时间点。</li>
<li>比如我起一个事务，随便读一次数据（不一定是后续实际要操作的数据），如果在这个时间点之后别的事务改了一个数据并<code>commit</code>，我再<code>select</code>是读不到最新值的，还是会返回第一次读到的老数据。这个就是问题的现象。</li>
<li>除非我<code>commit</code>一下，<code>commit</code>会刷新<code>snapshot</code>的时间点。这时再读就会返回新数据，可能是别的事务的更新，可能是我自己的更新。</li>
</ul>
<hr>
<h3 id="解决办法"><a href="#解决办法" class="headerlink" title="解决办法"></a>解决办法</h3><ul>
<li><p>总结一下就是多个请求涌入，在排队之前都操作了数据库(获取用户信息等准备动作)，得到了相似时间点(数据尚未修改)的snapshot。导致后续不论别的请求如何修改数据，自己还是会读到老数据。</p>
</li>
<li><p>文档提到可以commit更新snapshot，或者换隔离等级，或者用显式的锁。隔离等级我们就先不折腾了。</p>
</li>
<li><p>最简单的解法，在获得外部的业务锁之后，进入业务逻辑之前，我们commit一下mysql，就解决了问题。<br>也就是在接口排队成功时commit一下。之后读的数据一定是最新的且中途不会有重入。</p>
</li>
</ul>
<hr>
<h3 id="for-update的测试"><a href="#for-update的测试" class="headerlink" title="for update的测试"></a>for update的测试</h3><ul>
<li><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/5.7/en/innodb-locking-reads.html">https://dev.mysql.com/doc/refman/5.7/en/innodb-locking-reads.html</a></p>
</li>
<li><p>外部锁服务和<code>for update</code>其实是差不多的等级。因为对mysql的锁没有很深的理解所以最开始的策略是尽量把锁剥离出来，不显式用mysql的锁。</p>
</li>
<li><p>如果用<code>for update</code>实现的话。需要把用到的数据先用<code>for update</code>选一下。也要考虑顺序的问题。<code>select ... for update</code>成功后，一直到commit之前，别的<code>for update</code>/<code>lock in share mode</code>的请求都会卡住。普通select可以执行。</p>
</li>
<li><p>一些简单测试</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">request.mysqldb_session.query(Test2).filter(Test2.id &#x3D;&#x3D; 1)</span><br><span class="line">原始sql</span><br><span class="line"></span><br><span class="line">request.mysqldb_session.query(Test2).with_for_update().filter(Test2.id &#x3D;&#x3D; 1)</span><br><span class="line">后面跟 FOR UPDATE</span><br><span class="line"></span><br><span class="line">request.mysqldb_session.query(Test2).with_for_update(read &#x3D; True).filter(Test2.id &#x3D;&#x3D; 1)</span><br><span class="line">后面跟 LOCK IN SHARE MODE</span><br></pre></td></tr></table></figure>
<ul>
<li>超时情况<br>先FOR UPDATE，里面sleep久一点。<br>再请求一个 LOCK IN SHARE MODE或FOR UPDATE<br>会出<code>Lock wait timeout exceeded; try restarting transaction</code><br>默认50s<br>见 <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/mysql-errors/5.7/en/server-error-reference.html">https://dev.mysql.com/doc/mysql-errors/5.7/en/server-error-reference.html</a><br>貌似可以每次开始事务时设置一下innodb_lock_wait_timeout，略繁琐。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/23/2388/" data-id="ckkfmdgat0045vkcg9i1q9iuk" data-title="Mysql的一个并发问题" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2383" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/23/2383/" class="article-date">
  <time class="dt-published" datetime="2021-01-23T01:47:41.000Z" itemprop="datePublished">2021-01-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/23/2383/">Luat训练营-第5天</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>@<a href="Luat%E8%AE%AD%E7%BB%83%E8%90%A5-%E7%AC%AC5%E5%A4%A9">TOC</a></p>
<h2 id="第4天内容复习"><a href="#第4天内容复习" class="headerlink" title="第4天内容复习"></a>第4天内容复习</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2372/0">第4日内容</a></p>
<h2 id="第5天内容"><a href="#第5天内容" class="headerlink" title="第5天内容"></a>第5天内容</h2><h3 id="硬件介绍"><a href="#硬件介绍" class="headerlink" title="硬件介绍"></a>硬件介绍</h3><p><img src="https://img-blog.csdnimg.cn/20210123094652359.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODU3NzAw,size_16,color_FFFFFF,t_70#pic_center" alt="Air724"></p>
<p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/383/0">724详细介绍</a></p>
<h3 id="Lua-Tools上手教程"><a href="#Lua-Tools上手教程" class="headerlink" title="Lua Tools上手教程"></a>Lua Tools上手教程</h3><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/1719/0">文档链接</a></p>
<h2 id="第6天"><a href="#第6天" class="headerlink" title="第6天"></a>第6天</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2396/0">第6天</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/23/2383/" data-id="ckkfmdgas0044vkcg1cmxdml7" data-title="Luat训练营-第5天" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2378" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/22/2378/" class="article-date">
  <time class="dt-published" datetime="2021-01-22T06:45:47.000Z" itemprop="datePublished">2021-01-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/22/2378/">MIT 6.S081 操作系统课程系列3 Page tables</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="MIT-6-S081-操作系统课程系列3-Page-tables"><a href="#MIT-6-S081-操作系统课程系列3-Page-tables" class="headerlink" title="MIT 6.S081 操作系统课程系列3 Page tables"></a>MIT 6.S081 操作系统课程系列3 Page tables</h1><hr>
<p><a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.828/2020/labs/pgtbl.html">https://pdos.csail.mit.edu/6.828/2020/labs/pgtbl.html</a><br><a target="_blank" rel="noopener" href="https://pdos.csail.mit.edu/6.828/2020/xv6/book-riscv-rev1.pdf">https://pdos.csail.mit.edu/6.828/2020/xv6/book-riscv-rev1.pdf</a><br>本次实验需要读xv6手册第3章。看相关kernel代码。<br>理解页表的原理并实现一些相关功能。</p>
<hr>
<p>页表的作用是通过地址映射，使得每个进程看上去拥有自己独立的地址空间和内存，但实际是所有进程共用一套物理内存和地址。</p>
<h3 id="分页硬件"><a href="#分页硬件" class="headerlink" title="分页硬件"></a>分页硬件</h3><ul>
<li><p>riscv指令(user和kernel)都只操作虚拟地址。riscv硬件会把虚拟地址映射到实际地址。<br>xv6系统下，只会用到64bit的虚拟地址里的低39bit。页表逻辑上就是一个数组，包含pow(2, 27)=134217728个页表项(page table entries(<code>PTE</code>))。</p>
</li>
<li><p>看手册图3.1和3.2。<br>每个PTE为64bit，包含一个44bit的页号physical page number(PPN)，一些标志位，和一些备用的bit。<br>分页硬件用虚拟地址39bit里的高27bit查到一个PTE，再把PTE里的PPN(44bit)和原始虚拟地址的后12bit(39 - 27)拼起来组成一个56bit的物理地址。</p>
</li>
<li><p>分页的粒度常用<code>4096(4k)</code>字节。后续可以看到很多内存操作都会处理4k对齐，内存也是按页分配。</p>
</li>
<li><p>134217728(512 * 512 * 512)个PTE存在三级树形结构里，每层刚好512项。<br>上面说的用高27bit查PTE，即前9bit对应第一级的index，中9bit对应第二级的index，后9bit对应第三级的index。<br>只要有一级找不到，就会报page-fault异常，交给kernel处理。</p>
</li>
<li><p>PTE里有十个左右的各种标志位。<br><code>PTE_V</code> PTE是否存在<br><code>PTE_U</code> 如果开启，kernel下不允许读。<br><code>PTE_R</code> 是否允许读<br><code>PTE_W</code> 是否允许写<br><code>PTE_X</code> 是否允许执行</p>
</li>
</ul>
<hr>
<h3 id="kernel地址空间"><a href="#kernel地址空间" class="headerlink" title="kernel地址空间"></a>kernel地址空间</h3><ul>
<li><p>xv6给每个进程维护两个页表，一个用作user地址空间，一个kernel地址空间。<br>kernel会给自己的地址空间做详细的配置，比如哪些资源映射到哪些虚拟地址。见memlayout.h。</p>
</li>
<li><p>qemu<br>qemu是一个模拟软件。现在为我们的模拟的物理内存从0x80000000开始到0x88000000，一共128m(见memlayout.h，从<code>KERNBASE</code>到<code>PHYSTOP</code>)。<br>也会模拟io设备比如磁盘。qemu把设备接口做成内存映射(0x88000000以下)的寄存器暴露给软件。<br>kernel通过读写这些地址跟设备交互。</p>
</li>
<li><p>kernel获取设备地址是用的”直接映射”，即虚拟地址和实际地址一样。直接映射就省去了转换操作，很多场景会用到。</p>
</li>
<li><p>仔细看下手册图3.3，kernel的地址空间。<br><code>MAXVA</code>为0x4000000000(256G字节)。虚拟地址的寻址空间为0<del>(0x4000000000-1)<br><code>KERNBASE</code>为0x80000000(2G字节)。之前的都是kernel特殊使用。<br><code>PHYSTOP</code>为0x88000000，与<code>KERNBASE</code>之间的128M为实际的可用内存。<br>其中<code>KERNBASE</code>开始存kernel代码和数据。<br>kernel的代码和数据的末尾称为<code>end</code>(见kalloc.c)。<br><code>end</code>到<code>PHYSTOP</code>就是被内存管理系统控制(通过kalloc/kfree)的内存(见kalloc.c)。就是图中的freememory。<br>用户进程分配到的物理内存都是分布在freememory里。虽然寻址空间都是0</del>(0x4000000000-1)。</p>
</li>
</ul>
<hr>
<h3 id="创建地址空间"><a href="#创建地址空间" class="headerlink" title="创建地址空间"></a>创建地址空间</h3><ul>
<li><p>看页表相关代码vm.c<br>主要的数据pagetable_t是一个uint64 *(riscv.h)</p>
</li>
<li><p>看懂<code>walk</code>函数<br>pte_t *walk(pagetable_t pagetable, uint64 va, int alloc)<br>给一个pagetable头地址(L2页表地址)(物理地址)，一个虚拟地址va，一个alloc选项。<br>返回va的物理地址。</p>
</li>
<li><p>看图3.2<br>L2L1L0为上述三级PTE。<br>先有L2页表的地址。</p>
<pre><code>  1.拿L2的9bit(PX宏展开就是把va的对应级别的9bit拿出来)，可以得到L2中对应的PTE项，检查它的PTE_V标志。
      1.1如果PTE_V标识为0说明该PTE不存在，那么看alloc选项。
          1.1.1如果为0，函数返回0。
          1.1.2如果为1，用kalloc()分配一个页，并标记PTE_V有效。计算L1的页表地址(PTE2PA宏是把PTE的44bitPPN拿出来左移12bit)。
      1.2如果PTE_V标志为1说明该PTE有效，计算L1的页表地址。
</code></pre>
<p>  同样算法从L1得到L0的页表地址后，直接拿出L0数组里对应的PTE项，返回其地址。</p>
<p>  需要注意的是新的页表最开始只分配了一页的内存，只能支持一小部分的PTE，如果发现下一级的页表头不存在，说明还没给它分配内存，那么要根据alloc来分配内存。</p>
</li>
<li><p>页对齐<br>目的是方便兼容不同硬件和提高效率，不对齐会有额外的io开销。<br>两个计算对齐地址的宏:<br><code>PGROUNDDOWN</code>把地址往下对齐一页，不满一页的值抹掉，比如0x1003会变成0x1000。<br>  <code>PGROUNDUP</code>把地址往上对齐一页，只要超出1就会往上走一页，比如0x1001会变成0x2000。<br>  如果正好是对齐的地址比如0x1000，都不会发生改变。</p>
</li>
<li><p>看懂<code>mappages</code>函数<br>int mappages(pagetable_t pagetable, uint64 va, uint64 size, uint64 pa, int perm)<br>给一个pagetable头地址(L2页表地址)(物理地址)，一个虚拟地址va，一个数size，一个物理地址pa， 一个配置项perm。</p>
<p>  功能就是更新页表里的项，给定size，对于从va和pa开始的size个字节(以页分组)，va和pa地址一一对应，把映射关系安装到页表。<br>  把va和va+size对齐一下分别作为头尾。开始循环。</p>
<p>  对于其间的每个虚拟地址，调<code>walk</code>得到其PTE位置，再把物理地址pa转成PTE赋值到页表。每次循环va和pa都往后走一页。</p>
</li>
<li><p>kvmmap()用mappages把映射关系安装到kernel的页表。<br>在main()里kvminit()用kvmmap安装一系列硬件等映射。这个发生在页表使能之前，所以地址都是物理地址。</p>
</li>
</ul>
<hr>
<h3 id="物理地址的分配"><a href="#物理地址的分配" class="headerlink" title="物理地址的分配"></a>物理地址的分配</h3><p>见kalloc.c。上次lab已经看懂了它的原理，这里跳过。</p>
<hr>
<h3 id="进程地址空间"><a href="#进程地址空间" class="headerlink" title="进程地址空间"></a>进程地址空间</h3><ul>
<li><p>每个进程有独立的页表，当进程发生切换时也会切换页表。<br>见图2.3。进程的用户内存从0开始到<code>MAXVA</code>(riscv.h)，一共是256G字节大小。</p>
</li>
<li><p>进程向xv6内核请求更多内存时，xv6用kalloc分配物理页。然后往页表中插入PTE项(指向新分配的物理地址)(就是把映射关系装进页表)。</p>
</li>
<li><p>通过巧妙的设计，不同进程的虚拟地址会映射到不同的物理地址，不会相互干扰。进程自己可见的内存地址时连续的，虽然实际对应的物理地址是散乱的。</p>
</li>
</ul>
<hr>
<h3 id="sbrk"><a href="#sbrk" class="headerlink" title="sbrk"></a>sbrk</h3><ul>
<li><p>按linux手册的描述，sbrk改变program break的位置，改变了进程的数据段。program break变大的效果就是增大了进程的内存，反之减小。</p>
</li>
<li><p>看xv6的sbrk，直接调用growproc(n)来增减内存。<br>如果n大于0，用uvmalloc增加。<br>如果n小于0，用uvmdealloc减小。<br>相关的函数基本都建立在之前看过的kfree/kalloc/walk/mappages基础之上，</p>
</li>
<li><p>整理一下内存和分页相关的函数</p>
<table>
<thead>
<tr>
<th>函数</th>
<th>功能</th>
</tr>
</thead>
<tbody><tr>
<td>kalloc</td>
<td>分配一页4096字节物理内存</td>
</tr>
<tr>
<td>kfree</td>
<td>回收一页4096字节物理内存</td>
</tr>
<tr>
<td>freerange</td>
<td>用kfree回收范围内物理内存</td>
</tr>
<tr>
<td>walk</td>
<td>在页表中找虚拟地址对应的PTE地址(可选是否为未分配内存的PTE分配内存)</td>
</tr>
<tr>
<td>freewalk</td>
<td>递归形式。用kfree回收整个页表本身。</td>
</tr>
<tr>
<td>mappages</td>
<td>往页表中安装虚拟地址-物理地址的对应关系。如果PTE没分配内存，分配内存。</td>
</tr>
<tr>
<td>kvmmap</td>
<td>用mappages把地址对应关系安装到kernel的页表</td>
</tr>
<tr>
<td>uvmunmap</td>
<td>把页表里从虚拟地址va开始的n个page的对应关系删除(可选是否kfree物理地址)</td>
</tr>
<tr>
<td>uvmdealloc</td>
<td>给定新老内存size，用uvmunmap删除其间的va对应关系(可选是否回收内存)。</td>
</tr>
<tr>
<td>uvmalloc</td>
<td>给定新老内存size。遍历老size到新size之间的页，每个页先kalloc分配物理内存，再mappages安装到页表。</td>
</tr>
<tr>
<td>copyout</td>
<td>把数据从物理地址copy到虚拟地址对应的物理地址</td>
</tr>
<tr>
<td>copyin</td>
<td>把数据从虚拟地址对应的物理地址copy到物理地址</td>
</tr>
<tr>
<td>uvmcreate</td>
<td>用kalloc分配一页，创建一个空页表。</td>
</tr>
<tr>
<td>uvmfree</td>
<td>用uvmunmap删除页表中从0开始n个地址的对应关系(同时kfree每页的物理地址)。再freewalk删除页表本身。</td>
</tr>
<tr>
<td>uvmcopy</td>
<td>给定新老两个页表和size，把老页表0开始到size的虚拟地址的数据复制到新页表。从0开始的每一页虚拟地址，找到老表的PTE、物理地址，kalloc分配一页，把物理地址上的数据复制到新分配的页，再用mappages把虚拟地址和新分配的页安装到页表。</td>
</tr>
</tbody></table>
</li>
</ul>
<hr>
<h3 id="exec流程"><a href="#exec流程" class="headerlink" title="exec流程"></a>exec流程</h3><ul>
<li><p>ELF(Executable Linking Format)文件是广泛用于类unix系统的文件格式，xv6的应用程序就是用的elf文件。<br><a target="_blank" rel="noopener" href="https://wiki.osdev.org/ELF">https://wiki.osdev.org/ELF</a><br><a target="_blank" rel="noopener" href="https://elinux.org/Executable_and_Linkable_Format_(ELF)">https://elinux.org/Executable_and_Linkable_Format_(ELF)</a><br><a target="_blank" rel="noopener" href="https://linuxhint.com/understanding_elf_file_format/">https://linuxhint.com/understanding_elf_file_format/</a></p>
</li>
<li><p>格式定义见elf.h，有一个elf头elfhdr，一个program头proghdr。<br>每个proghdr定义一个需要加载到内存的应用程序。<br>每个xv6程序只包含一个proghdr，其他系统可能包含多个。</p>
</li>
<li><p>exec(exec.c)目的是运行一个程序(可执行的文件)。先用namei(fs.c)打开要执行的文件。再读elfhdr。检查ELF_MAGIC(elf.h)。<br>用proc_pagetable(exec.c)创建user页表。<br>对于每一个程序段，用uvmalloc分配内存，更新页表。用loadseg把程序段加载到指定地址。<br>再处理exec参数。设置寄存器以运行指定的程序。</p>
</li>
<li><p>其实细节很复杂。后续会不断更新理解。</p>
</li>
</ul>
<hr>
<h3 id="做题1-打印页表"><a href="#做题1-打印页表" class="headerlink" title="做题1.打印页表"></a>做题1.打印页表</h3><ul>
<li><p>vm.c里做一个函数vmprint，给定页表头和level，打印出页表所有非空的PTE和物理地址。插到exec函数返回前。<br>参考freewalk做一个递归打印每个PTE，依靠level填上前缀即可。</p>
</li>
<li><p>用make grade测试，测试通过会打印出：pte printout: OK</p>
</li>
</ul>
<hr>
<h3 id="做题2-每个进程独有的kernel页表"><a href="#做题2-每个进程独有的kernel页表" class="headerlink" title="做题2.每个进程独有的kernel页表"></a>做题2.每个进程独有的kernel页表</h3><ul>
<li><p>得反复看代码，了解进程的结构和工作流程，内存、页表的布局。</p>
</li>
<li><p>看proc.h，默认的代码下，每个进程有一个独立的用户页表pagetable。而kernel页表是所有进程共用(见vm.c)。</p>
</li>
<li><p>NPROC最大进程数为64(param.h)</p>
</li>
<li><p>TRAMPOLINE为MAXVA前一页，也就是整个虚拟地址空间的最后一页。</p>
</li>
<li><p>看proc.c<br><code>procinit</code><br>初始化进程表。给进程表每项分配一页作为kernel栈(kstack)，用KSTACK把每个kernel栈的虚拟地址顺序按排在TRAMPOLINE之前。<br>最后用kvminithart使能kernel页表。</p>
</li>
<li><p><code>allocproc</code><br>初始化一个进程。从进程表里找一个state为UNUSED的项，allocpid分配新的pid，为trapframe分配一页，proc_pagetable创建一个空的用户页表，初始化context结构体，context包含一批寄存器。切换进程的swith函数需要传入这个context。</p>
</li>
<li><p>allocproc在userinit和fork里用到。</p>
</li>
<li><p><code>userinit</code><br>在main函数里会调userinit，创建第一个user进程。<br>用allocproc分配一个进程，初始化，配置成initcode，也就是init.c的main，起sh程序(sh.c)。<br>进程的state设为RUNNABLE。<br>main最后会调scheduler()开始进程的调度，系统的进程就跑起来了。</p>
</li>
<li><p>scheduler<br>每个cpu都会起一个。会跑一个for的死循环，不会返回。<br>每次循环从进程表里找一个RUNNABLE的进程，设为RUNNING，用swtch()切换，执行找到的进程。</p>
</li>
<li><p>fork<br>用allocproc分配一个子进程，用uvmcopy复制一份页表到子进程，同时复制父进程user页表的数据到子进程。子进程状态设为RUNNABLE。</p>
</li>
</ul>
<h4 id="实现："><a href="#实现：" class="headerlink" title="实现："></a>实现：</h4><p>默认代码里只有唯一一个kernel页表(vm.c的kernel_pagetable)，现在要求做成每个进程自己维护一个kernel页表，进程运行时切换到自己的kernel页表。</p>
<ol>
<li>proc结构体添加一个kernel页表</li>
<li>目前allocproc函数里会创建用户页表，很自然可以把创建kernel页表加到此处。</li>
<li>做一个make_kernel_page_table函数。里面创建一个空页表作为每个进程的kernel页表。</li>
<li>make_kernel_page_table里把进程的kstack的映射安装到新页表(kstack默认在procinit里初始化过，所以只安装映射即可)</li>
<li>make_kernel_page_table里参考kvminit把映射安装到进程自己的kernel页表。</li>
<li>freeproc里free自己的kernel页表。</li>
<li>scheduler里swith之前要切换到进程的kernel页表。参考kvminithart。</li>
</ol>
<h4 id="Debug："><a href="#Debug：" class="headerlink" title="Debug："></a>Debug：</h4><h5 id="p-gt-sz问题"><a href="#p-gt-sz问题" class="headerlink" title="p-&gt;sz问题"></a>p-&gt;sz问题</h5><ul>
<li><p>出现panic: uvmunmap: walk<br>因为freeproc里我仿照uvmfree()删除自己的kernel页表，而size不明确，用p-&gt;sz是不对的，导致uvmunmap里walk找不到va的对应关系而出panic。<br>那么size到底是多少，这个非常值得追踪一下。</p>
</li>
<li><p>看一下进程的p-&gt;sz赋值情况(暂时找到这些)</p>
<ol>
<li>userinit。第一个进程。sz写死的PGSIZE。</li>
<li>exec。对每个程序段用uvmalloc扩大内存大小，最后再加2个page。比如echo执行时是12k(3页)。</li>
<li>growproc。直接扩大内存n字节。可以看出sz大小不是页对齐的。但映射永远是页对齐的。</li>
<li>fork。子进程直接设为父进程的sz。</li>
</ol>
</li>
<li><p>最后看下来kernel页表不会像user页表那么随意变化。原始代码对kernel_pagetable的操作只在kvminit里。<br>那么参考kvminit反向操作一下，unmap就行了，不用管p-&gt;sz。</p>
</li>
<li><p>另外kstack也需要处理。添加映射和删除映射要配对，否则容易出panic。</p>
</li>
</ul>
<h5 id="执行一个命令后shell无反应"><a href="#执行一个命令后shell无反应" class="headerlink" title="执行一个命令后shell无反应"></a>执行一个命令后shell无反应</h5><ul>
<li><p>原因是在用户进程switch那，我们做成了切换到进程自己的kernel页表，但如果没有进程了就出问题了，相当于没有kernel页表了。<br>课程主页也有提示，没有可执行的进程时得切换到原始的kernel页表。<br>在<code>found == 0</code>时要切换回默认的kernel页表。</p>
</li>
<li><p>make qemu进入系统测试一下常用命令<br>没问题后输usertests进行系统各项测试。可能会持续十几分钟。虚拟机的话多给点内存，否则可能卡住。<br>最后打印出ALL TESTS PASSED说明成功。</p>
</li>
</ul>
<hr>
<h3 id="做题3-简化copyin-copyinstr"><a href="#做题3-简化copyin-copyinstr" class="headerlink" title="做题3.简化copyin/copyinstr"></a>做题3.简化copyin/copyinstr</h3><ul>
<li><p>看懂copyin<br>给定页表，目标地址dst，起始地址va，长度len。把va开始的len长度的地址范围的数据复制到dst。<br>细节是头尾没页对齐的部分分别复制，中间对齐的部分整页整页地复制。</p>
</li>
<li><p>copyinstr<br>和copyin类似，给定最大长度，复制字符串。碰到0要停止。</p>
</li>
<li><p>lab2里用了copyout。总结一下。<br>copyout把物理地址的数据复制到目标虚拟地址转换后的物理地址。按课程的说法就是kernel的数据复制到user。<br>copyin 把虚拟地址转换后的物理地址的数据复制到目标物理地址。按课程的说法就是user的数据复制到kernel。<br>in就是进kernel。out就是出到user。<br>在exec流程里，user程序把参数地址(虚拟，用户只允许用虚拟地址)存进某个寄存器，再调用exec(system call)。<br>然后进入kernel程序，取user存的参数的虚拟地址，会用fetchaddr，最后用到copyin把虚拟地址的参数copy出来。</p>
</li>
<li><p>任务是简化copyin。用vmcopyin.c里的copyin_new代替原始的copyin。<br>copyin_new直接一个memmove复制数据，不用一页页做地址转换再复制。</p>
</li>
<li><p>这里卡了半天没懂他的意思。既然物理地址不一定连续，怎么可能用一个memmove复制连续物理地址上的大批数据呢？<br>后来反复看手册和代码，参考网上的信息顿悟。</p>
</li>
<li><p>这里有一个理解的缺失：kernel页表到底是用在哪的？<br>kernel_pagetable这个变量搜了所有代码，只有kvminithart里传进去，其他没有实质使用。</p>
</li>
<li><p>大胆总结：<br>kvminithart里是把kernel_pagetable喂给硬件分页了。<br>kvminit初始化时是把kernel data和freememory都线性映射到kernel_pagetable了(这里一直没仔细看)。<br>在一个较低的层面，可能是驱动或更下面，至少是memmove之下，硬件分页一定会按kernel_pagetable做一次转换的。<br>就是说memmove执行的时候会把地址按kernel_pagetable做一次转换。</p>
</li>
<li><p>这样就清楚了，需要事先把用户虚拟地址上的数据都做好映射，同步到进程自己的kernel页表，再喂给硬件分页。<br>硬件分页处理用户进程，默认是用了线性的映射，现在要改成处理user页表的映射。<br>本质上就是要把copyin里的一页页转换交给硬件分页处理，从而简化了copyin的代码。<br>地址的转换仍然是存在的。</p>
</li>
<li><p>需要把进程的user页表完全同步到kernel页表。<br>什么时候同步？user映射发生变化的时候。<br>仔细看代码会发现p-&gt;sz的变化总是伴随着user页表映射的变化。<br>刚好上边总结过p-&gt;sz的赋值情况。跟课程的提示完全一致。<br>那么p-&gt;sz发生变化的时候同步一下user页表就行了。</p>
</li>
</ul>
<h5 id="其他问题点"><a href="#其他问题点" class="headerlink" title="其他问题点"></a>其他问题点</h5><ul>
<li><p>页表、内存相关的边界处理一定要严谨，否则各种panic。必须看懂代码。</p>
</li>
<li><p>同步user页表时PTE_U要关掉。否则copyin_new时会panic，因为PTE_U打开时kernel不允许读。<br>这个非常坑，课程有提示，但是很难联系上。</p>
</li>
<li><p>需要同步user页表到kernel页表，但user地址空间是从0到MAXVA，与kvminit里kernel页表其他的初始化可能会冲突。<br>课程给的解法是把用户的最大虚拟地址定为kernel页表用到的最低的地址。课程说是PLIC，但看手册和代码最低是CLINT的0x2000000？？<br>growproc里扩大内存时先判断一下地址，如果大于PLIC返回-1。这样把虚拟地址控制在PLIC以下。<br>测试里的sbrkmuch会分配100m内存，如果限制在CLINT的话内存只有32m了，也会失败。</p>
</li>
<li><p>growproc里的同步<br>不能偷懒每次都unmap全部再map，这样太慢了。必须只更新扩大或缩小的部分，处理好边界和对齐问题。</p>
</li>
<li><p>卡死的问题<br>最后测试还是会卡死，也不报错，不知道原因。单个测试某项能通过。<br>把切换kernel页表和copyin/copyinstr替换关掉就没问题。看来代码还是有问题。<br>发现多次运行不存在的命令后shell会卡死，cpu跑满。<br>仔细看下sh和exec的流程。</p>
<p>  main-&gt;userinit-&gt;init.c的main<br>死循环里先fork，子进程exec运行sh，父进程等待这个sh的结果。<br>sh.c里main不断等输入，就是我们看到的shell界面。<br>输入命令后fork，子进程调exec运行命令。父进程sh等待子进程返回。</p>
<p>  基本就是切换结束时某个环节出了问题。<br>颠来倒去查了很久实在没辙了。<br>看别人代码发现切换kernel页表swtch之后要立马切换回来。如果等到found==0才切换，某些情况会有概率回不来，原因暂不深究了。<br>这样测试能通过了。有恶心到。</p>
</li>
<li><p>sbrk问题<br>测试里有一个分配所有内存的操作，不断地分配直到返回0xffffffffffffffffLL，其实是-1。<br>运行make grade时sbrkmuch会失败。但单独运行usertests sbrkmuch是好的。先搁置。</p>
</li>
<li><p>另一个卡死<br>exec里走到bad时不要回收kernel页表。在freeproc里回收就够了。</p>
</li>
</ul>
<hr>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>细节其实非常多，运气不好或者理解不够深就得花很多时间看代码和调试。<br>通过这次实验。研究了大量页表、内存分配和进程相关的底层代码。对内存操作有了很多新的认识。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/22/2378/" data-id="ckkfmdgeb00ckvkcg1v5m2sbq" data-title="MIT 6.S081 操作系统课程系列3 Page tables" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2374" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/21/2374/" class="article-date">
  <time class="dt-published" datetime="2021-01-21T13:58:57.000Z" itemprop="datePublished">2021-01-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/21/2374/">TypeScript的学习笔记</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="初识："><a href="#初识：" class="headerlink" title="初识："></a>初识：</h3><p>TypeScript可能对于部分人不是很熟悉，对JavaScript比较熟悉。那TypeScript是什么呢？它是Javascript的超集，也可以说ta建立在JavaScript之上，但最终是转为JavaScript的。</p>
<h3 id="环境（以下仅是个人安装环境）："><a href="#环境（以下仅是个人安装环境）：" class="headerlink" title="环境（以下仅是个人安装环境）："></a>环境（以下仅是个人安装环境）：</h3><p>node: 10.16.0<br>npm:   6.9.0<br>ts-node: 9.1.1(非必须)<br>工具：vscode</p>
<h3 id="安装命令"><a href="#安装命令" class="headerlink" title="安装命令"></a>安装命令</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;&#x2F;建议全局安装 typescript</span><br><span class="line">npm install -g typescript</span><br><span class="line">&#x2F;&#x2F;ts-node 用于直接运行ts文件</span><br><span class="line">npm install ts-node</span><br></pre></td></tr></table></figure>
<h3 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h3><p>如果未安装ts-node（ts文件不能直接运行，需要通过tsc xx.ts 命令执行转换成xx.js文件，再通过执行node xx.js方可执行）<br>运行命令：<code>tsc xx.ts                 node xx.js</code></p>
<p> 已安装ts-node<br>运行命令：<code>ts-node xx.ts</code>（即可）</p>
<h3 id="构建第一个TypeScript文件"><a href="#构建第一个TypeScript文件" class="headerlink" title="构建第一个TypeScript文件"></a>构建第一个TypeScript文件</h3><p>创建一个空文件，打开vscode，进到根目录下，创建空文件demo.ts（以 .ts 结尾文件名），内容如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">var message : string &#x3D; &quot;hello world&quot;</span><br><span class="line">console.log(message)</span><br></pre></td></tr></table></figure>
<p>这样就创建好了一个ts文件了（刚开始可能有点懵，但是不要慌…）<br>下面运行它：tsc demo.ts<br>这个时候应该就能看到终端上打印出来 <code>hello world</code> 了。</p>
<p>那么恭喜你，你成功了，你成功的成为了一名菜鸟…</p>
<h3 id="类型注解"><a href="#类型注解" class="headerlink" title="类型注解"></a>类型注解</h3><p>TypeScript里的类型注解是一种轻量级的为函数或变量添加约束的方式。就是变量的类型，类比JavaScript中变量声明类型（可能我们再js中也不写….）<br>在你创建的第一个demo.ts文件中的<code> var message : string = &quot;hello world&quot;</code> 的 <code>string</code> 就是类型注解。</p>
<h3 id="命名规则"><a href="#命名规则" class="headerlink" title="命名规则"></a>命名规则</h3><p>TypeScript 变量的命名规则：</p>
<p>变量名称可以包含数字和字母;<br>除了下划线 _ 和美元 $ 符号外，不能包含其他特殊字符，包括空格。<br>变量名不能以数字开头。<br>变量使用前必须先声明，我们可以使用 var 来声明变量。</p>
<p>格式：var [变量名]：[类型] = 值</p>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p><strong>数据类型大致</strong>： any(任意类型)，number(数字)，string(字符串)，boolean(布尔)<br>此外，还有数组、元组、枚举、void、null、undefined、never(ts/js没有整数类型o)<br>下面看一下如何进行声明定义的：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">let x:any &#x3D; 123;  &#x2F;&#x2F;是否设置初始值  可选</span><br><span class="line">x &#x3D; 1</span><br><span class="line">x &#x3D; &quot;sssss&quot;</span><br><span class="line">x &#x3D; true</span><br><span class="line"></span><br><span class="line">let y: number &#x3D; 999</span><br><span class="line">let z: string &#x3D; &quot;合宙&quot;</span><br><span class="line">let con: boolean &#x3D; true</span><br></pre></td></tr></table></figure>
<p>下面说一下数组的声明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">let arr: number[] &#x3D; [1,2,34]</span><br><span class="line">let arr1: any[] &#x3D; [1,true,&quot;asasdasdad&quot;]</span><br></pre></td></tr></table></figure>
<p>元组类型用来表示已知元素数量和类型的数组，各元素的类型不必相同，对应位置的类型需要相同。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">let yz: [string,number]   &#x2F;&#x2F;声明了一个变量，并没有给值</span><br><span class="line">yz &#x3D; [&quot;s&quot;,1]  &#x2F;&#x2F;success</span><br><span class="line">&#x2F;&#x2F; yz &#x3D; [1,&quot;sd&quot;] &#x2F;&#x2F;error</span><br></pre></td></tr></table></figure>
<p>函数返回值</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">function s() : void &#123;    &#x2F;&#x2F; void  用于标识函数的返回值类型，表示无返回值</span><br><span class="line">  console.log(&quot;合宙&quot;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其他：这里对never简单的进行一个声明</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">function getTotal(one: number,two: number):number&#123;  &#x2F;&#x2F;函数返回值类型确定防止出现未知问题</span><br><span class="line">  return one+two</span><br><span class="line">  &#x2F;&#x2F; return one+two+&quot;&quot;  &#x2F;&#x2F;这样写就会报错，指定了函数返回值是number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var total &#x3D; getTotal(1,2)</span><br><span class="line">console.log(typeof(total),total)</span><br><span class="line"></span><br><span class="line">function forEver():never&#123;</span><br><span class="line">  while(true)&#123;&#125;</span><br><span class="line">  console.log(&#39;111111&#39;)</span><br><span class="line">&#125;</span><br><span class="line">forEver()</span><br><span class="line"></span><br><span class="line">function errFunc():never&#123;</span><br><span class="line">  throw new Error()</span><br><span class="line">  console.log(&quot;33333333&quot;)</span><br><span class="line">&#125;</span><br><span class="line">errFunc()</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">null:对象缺失</span><br><span class="line">undefined:初始化未定义的变量值</span><br><span class="line">never: 是其它类型（包括 null 和 undefined）的子类型，代表从不会出现的值。</span><br><span class="line">null&#x2F;undefined 是其它所有类型的子类型  当一个类型变量可能会出先现null&#x2F;undefined情况，可以使用 | 进行连接</span><br><span class="line"></span><br><span class="line">let ss : number | null | undefined</span><br><span class="line"></span><br><span class="line">ss &#x3D; 1</span><br><span class="line">ss &#x3D; null</span><br><span class="line">ss &#x3D; undefined</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 总结：声明一个基础变量再变量名后 加上  :   后面跟上类型即可</span><br></pre></td></tr></table></figure>
<h3 id="对象数组"><a href="#对象数组" class="headerlink" title="对象数组"></a>对象数组</h3><p>实际开发过项目的同学，应该很清除，最常见的格式就是数组中是对象的：[{},{},…]</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var arr &#x3D; [&#123;name: &#39;lalalal&#39;, age: 9999&#125;, &#123;name: &#39;lalalal2&#39;, age: 99998&#125;]</span><br></pre></td></tr></table></figure>

<p>如何实现呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">var arr1: &#123;name: string, age:number&#125;[] &#x3D; [&#123;name: &#39;lalalal&#39;, age: 9999&#125;, &#123;name: &#39;lalalal2&#39;, age: 99998&#125;]</span><br></pre></td></tr></table></figure>
<p>上述形式看起来可能有点麻烦，假如有多个类似的数组，那岂不是要写很多次么？</p>
<p>TypeScript 为我们准备了一个概念，叫做类型别名(type alias)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">type user &#x3D; &#123;name: string, age: number&#125;</span><br><span class="line"></span><br><span class="line">var arr2: user[] &#x3D; [&#123;name: &#39;lalalal&#39;, age: 9999&#125;, &#123;name: &#39;lalalal2&#39;, age: 99998&#125;]</span><br></pre></td></tr></table></figure>
<p>思考，那能不能用类进行一个定义呢？yes</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">class UserH &#123;</span><br><span class="line">  name: string;</span><br><span class="line">  age: number</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">var arr3: UserH[] &#x3D; [&#123;name: &#39;lalalal&#39;, age: 9999&#125;, &#123;name: &#39;lalalal2&#39;, age: 99998&#125;]</span><br></pre></td></tr></table></figure>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>函数参数为对象时，如何进行传递和声明，下面先用js写两个简单的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function test(&#123;one&#125;)&#123;</span><br><span class="line">    return &quot;这是哥测试&quot;+one</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">test(&#123;one:1&#125;)</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; function add(&#123; one, two &#125;) &#123;</span><br><span class="line">&#x2F;&#x2F;   return one + two;</span><br><span class="line">&#x2F;&#x2F; &#125;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; const total &#x3D; add(&#123; one: 1, two: 2 &#125;);</span><br></pre></td></tr></table></figure>
<p>如何使用ts进行编写实现呢？</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;* 错误写法：</span><br><span class="line">function add(&#123; one: number, two: number &#125;): number &#123;  &#x2F;&#x2F;编译器会报错</span><br><span class="line">  return one + two;</span><br><span class="line">&#125;</span><br><span class="line">const total &#x3D; add(&#123; one: 1, two: 2 &#125;);</span><br><span class="line">*&#x2F;</span><br><span class="line"></span><br><span class="line">&#x2F;&#x2F; 正确写法：</span><br><span class="line">function add(&#123; one, two &#125;: &#123; one: number, two: number &#125;): number &#123;</span><br><span class="line">  return one + two;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const total &#x3D; add(&#123; one: 1, two: 2 &#125;);</span><br></pre></td></tr></table></figure>
<h3 id="接口"><a href="#接口" class="headerlink" title="接口"></a>接口</h3><p>interface</p>
<p>待续》》》…</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/21/2374/" data-id="ckkfmdgas0043vkcgce128au9" data-title="TypeScript的学习笔记" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2373" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/21/2373/" class="article-date">
  <time class="dt-published" datetime="2021-01-21T11:05:25.000Z" itemprop="datePublished">2021-01-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/21/2373/">合宙air800进行串口Json解析</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>@<a href="%E5%90%88%E5%AE%99air800%E8%BF%9B%E8%A1%8C%E4%B8%B2%E5%8F%A3Json%E8%A7%A3%E6%9E%90">TOC</a><br>本篇博文主要记叙合宙air800的json数据解析，语言使用luat，IDE使用VScode。<br>STM32进行JSON数据解析和打包请移步我的上一篇博文。</p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

<h1 id="合宙AIR800部分"><a href="#合宙AIR800部分" class="headerlink" title="合宙AIR800部分"></a>合宙AIR800部分</h1><p>合宙官方提供的例程中已经提供了JSON数据的解析代码，但是并未通过串口进行接收，因此本博文的合宙AIR800部分我会从以下两部分介绍：①Air800的串口接收②串口接收的数据进行JSON解析</p>
<h2 id="Air800的串口接收"><a href="#Air800的串口接收" class="headerlink" title="Air800的串口接收"></a>Air800的串口接收</h2><p>首先是进行串口的配置和接收、发送函数的回调。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--保持系统处于唤醒状态，此处只是为了测试需要，所以此模块没有地方调用pm.sleep(&quot;testUart&quot;)休眠，不会进入低功耗休眠状态</span></span><br><span class="line"><span class="comment">--在开发“要求功耗低”的项目时，一定要想办法保证pm.wake(&quot;testUart&quot;)后，在不需要串口时调用pm.sleep(&quot;testUart&quot;)</span></span><br><span class="line">pm.wake(<span class="string">&quot;testUart&quot;</span>)</span><br><span class="line"><span class="comment">--注册串口的数据接收函数，串口收到数据后，会以中断方式，调用read接口读取数据</span></span><br><span class="line">uart.on(UART_ID,<span class="string">&quot;receive&quot;</span>,<span class="built_in">read</span>)</span><br><span class="line"><span class="comment">--注册串口的数据发送通知函数</span></span><br><span class="line">uart.on(UART_ID,<span class="string">&quot;sent&quot;</span>,writeOk)</span><br><span class="line"></span><br><span class="line"><span class="comment">--配置并且打开串口</span></span><br><span class="line">uart.setup(UART_ID,<span class="number">115200</span>,<span class="number">8</span>,uart.PAR_NONE,uart.STOP_1)</span><br></pre></td></tr></table></figure>
<p>其次是将串口接收到的数据进行储存</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">函数名：read</span></span><br><span class="line"><span class="comment">功能  ：读取串口接收到的数据</span></span><br><span class="line"><span class="comment">参数  ：无</span></span><br><span class="line"><span class="comment">返回值：无</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> data = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment">--底层core中，串口收到数据时：</span></span><br><span class="line">    <span class="comment">--如果接收缓冲区不为空，则会以中断方式通知Lua脚本收到了新数据；</span></span><br><span class="line">    <span class="comment">--如果接收缓冲器为空，则不会通知Lua脚本</span></span><br><span class="line">    <span class="comment">--所以Lua脚本中收到中断读串口数据时，每次都要把接收缓冲区中的数据全部读出，这样才能保证底层core中的新数据中断上来，此read函数中的while语句中就保证了这一点</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">true</span> <span class="keyword">do</span> <span class="comment">--当且仅当允许接收时才接收数据</span></span><br><span class="line">        data = uart.<span class="built_in">read</span>(UART_ID, <span class="string">&quot;*l&quot;</span>)<span class="comment">--将串口所有数据取出</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> data <span class="keyword">or</span> <span class="built_in">string</span>.<span class="built_in">len</span>(data) == <span class="number">0</span> <span class="keyword">then</span> <span class="comment">--如果没有数据就跳出</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        json_analysis(data)<span class="comment">--json解析</span></span><br><span class="line">        data = <span class="string">&quot;&quot;</span> <span class="comment">--清空字符串</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="串口接收的数据进行JSON解析"><a href="#串口接收的数据进行JSON解析" class="headerlink" title="串口接收的数据进行JSON解析"></a>串口接收的数据进行JSON解析</h2><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">函数名：json_analysis</span></span><br><span class="line"><span class="comment">功能  ：JSON格式解析数据</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">json_analysis</span><span class="params">(data)</span></span></span><br><span class="line">    <span class="keyword">local</span> tjsondata, result, errinfo = json.decode(data)</span><br><span class="line">    <span class="keyword">if</span> result <span class="keyword">and</span> <span class="built_in">type</span>(tjsondata) == <span class="string">&quot;table&quot;</span> <span class="keyword">then</span> <span class="comment">--正确解析</span></span><br><span class="line">        <span class="comment">--调试输出</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;testJson.decode status &quot;</span>, tjsondata[<span class="string">&quot;status&quot;</span>])</span><br><span class="line"></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;status type is &quot;</span>, <span class="built_in">type</span>(<span class="built_in">status</span>))</span><br><span class="line"></span><br><span class="line">        <span class="built_in">status</span> = tjsondata[<span class="string">&quot;status&quot;</span>]<span class="comment">--灯的状态</span></span><br><span class="line">        <span class="built_in">write</span>(<span class="string">&quot;&#123;\&quot;status\&quot;:&quot;</span> .. <span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%s&quot;</span>, <span class="built_in">tostring</span>(<span class="built_in">status</span>)) .. <span class="string">&quot;&#125;&quot;</span>)<span class="comment">--串口输出Json字符串</span></span><br><span class="line">    <span class="keyword">else</span> <span class="comment">--错误解析</span></span><br><span class="line">        <span class="built_in">log</span>.info(<span class="string">&quot;testJson.decode error&quot;</span>, errinfo)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="STM32进行JSON数据发送"><a href="#STM32进行JSON数据发送" class="headerlink" title="STM32进行JSON数据发送"></a>STM32进行JSON数据发送</h2><p><a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1PT4y1K7Dg">AIR800代码资源</a></p>
<hr style=" border:solid; width:100px; height:1px;" color=#000000 size=1">

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/21/2373/" data-id="ckkfmdgas0042vkcg6k517lwf" data-title="合宙air800进行串口Json解析" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2372" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/21/2372/" class="article-date">
  <time class="dt-published" datetime="2021-01-21T06:07:07.000Z" itemprop="datePublished">2021-01-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/21/2372/">Luat训练营-第4天</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>@<a href="Luat%E8%AE%AD%E7%BB%83%E8%90%A5-%E7%AC%AC4%E5%A4%A9">TOC</a></p>
<h2 id="第3天内容复习"><a href="#第3天内容复习" class="headerlink" title="第3天内容复习"></a>第3天内容复习</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2360/0">第3日内容</a></p>
<h2 id="第4天内容"><a href="#第4天内容" class="headerlink" title="第4天内容"></a>第4天内容</h2><h3 id="模块化编程"><a href="#模块化编程" class="headerlink" title="模块化编程"></a>模块化编程</h3><p>module 将文件声明为模块，写法 module(…, package.seeall)<br>require 引入一个文件包</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">module</span>(..., <span class="built_in">package</span>.<span class="built_in">seeall</span>) <span class="comment">--使得文件中的函数在何处都可调用</span></span><br><span class="line"><span class="built_in">require</span><span class="string">&quot;pins&quot;</span> <span class="comment">--用到了pin库，该库为luatask专用库，需要进行引用</span></span><br></pre></td></tr></table></figure>
<h3 id="跨文件调用-Lua5-1"><a href="#跨文件调用-Lua5-1" class="headerlink" title="跨文件调用 Lua5.1"></a>跨文件调用 Lua5.1</h3><p>新建一个文件叫tools.lua，把这个函数放进去</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--使这个代码在哪个文件里都能被调用</span></span><br><span class="line"><span class="built_in">module</span>(..., <span class="built_in">package</span>.<span class="built_in">seeall</span>)</span><br><span class="line"><span class="comment">---函数功能：</span></span><br><span class="line"><span class="comment">-- 生成从1-max的table</span></span><br><span class="line"><span class="comment">-- @输入值：table的最大值</span></span><br><span class="line"><span class="comment">-- @返回： table结果</span></span><br><span class="line"><span class="comment">-- @例子： local list = getNumberList(10)</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getNumberList</span><span class="params">(max)</span></span></span><br><span class="line">    <span class="keyword">local</span> t = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">1</span>,<span class="built_in">max</span> <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">table</span>.<span class="built_in">insert</span>(t,i)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>封装的这个函数就能在其他文件里调用</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--引用tools.lua文件，并加载</span></span><br><span class="line"><span class="built_in">require</span><span class="string">&quot;tools&quot;</span></span><br><span class="line"><span class="keyword">local</span> list = tools.getNumberList(<span class="number">12</span>)</span><br></pre></td></tr></table></figure>
<h3 id="跨文件调用-Lua5-3"><a href="#跨文件调用-Lua5-3" class="headerlink" title="跨文件调用 Lua5.3"></a>跨文件调用 Lua5.3</h3><p>新建一个文件叫tools.lua，把这个函数放进去</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">---函数功能：</span></span><br><span class="line"><span class="comment">-- 生成从1-max的table</span></span><br><span class="line"><span class="comment">-- @输入值：table的最大值</span></span><br><span class="line"><span class="comment">-- @返回： table结果</span></span><br><span class="line"><span class="comment">-- @例子： local list = getNumberList(10)</span></span><br><span class="line"><span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">getNumberList</span><span class="params">(max)</span></span></span><br><span class="line">    <span class="keyword">local</span> t = &#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i=<span class="number">1</span>,<span class="built_in">max</span> <span class="keyword">do</span></span><br><span class="line">        <span class="built_in">table</span>.<span class="built_in">insert</span>(t,i)</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">return</span> t</span><br><span class="line"><span class="keyword">end</span> <span class="comment">--手动返回一个table，包含了上面的函数</span></span><br><span class="line"><span class="keyword">return</span> &#123;</span><br><span class="line">    getNumberList = getNumberList,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>封装的这个函数就能在其他文件里调用</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--引用tools.lua文件，并加载</span></span><br><span class="line"><span class="built_in">require</span><span class="string">&quot;tools&quot;</span></span><br><span class="line"><span class="keyword">local</span> list = tools.getNumberList(<span class="number">12</span>)</span><br></pre></td></tr></table></figure>
<h3 id="※string库"><a href="#※string库" class="headerlink" title="※string库"></a>※string库</h3><h4 id="字符串长度"><a href="#字符串长度" class="headerlink" title="字符串长度"></a>字符串长度</h4><p><code>string.len</code>接收一个字符串，返回它的长度。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;hello lua&quot;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">len</span>(a))<span class="comment">--空格也算</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串大小写转换"><a href="#字符串大小写转换" class="headerlink" title="字符串大小写转换"></a>字符串大小写转换</h4><p><code>string.upper(s)</code>接收一个字符串 s，返回一个把所有小写字母变成大写字母的字符串。<br><code>string.lower(s)</code>接收一个字符串 s，返回一个把所有大写字母变成小写字母的字符串。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;hello lua&quot;</span></span><br><span class="line">a = <span class="built_in">string</span>.<span class="built_in">upper</span>(a)<span class="comment">--大写a</span></span><br><span class="line"><span class="built_in">print</span>(a)<span class="comment">--打印a </span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">lower</span>(a))<span class="comment">--小写a</span></span><br></pre></td></tr></table></figure>
<h4 id="字符串索引"><a href="#字符串索引" class="headerlink" title="字符串索引"></a>字符串索引</h4><p><code>string.sub(s, i [, j])</code>返回字符串 s 中，从索引 i 到索引 j 之间的子字符串。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="string">&quot;123456789&quot;</span></span><br><span class="line">dout = <span class="built_in">string</span>.<span class="built_in">sub</span>(d,<span class="number">4</span>,<span class="number">6</span>) <span class="comment">-- 打印从4-6</span></span><br><span class="line"><span class="built_in">print</span>(dout)</span><br></pre></td></tr></table></figure>
<h4 id="字符串编码"><a href="#字符串编码" class="headerlink" title="字符串编码"></a>字符串编码</h4><p><code>string.char (...)</code>接收 0 个或更多的整数（整数范围：0~255），返回这些整数所对应的 ASCII 码字符组成的字符串。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 抄大佬的</span></span><br><span class="line">t=&#123;<span class="number">0x79</span>,<span class="number">0x6F</span>,<span class="number">0x75</span>,<span class="number">0x20</span>,<span class="number">0x61</span>,<span class="number">0x72</span>,<span class="number">0x65</span>,<span class="number">0x20</span>,<span class="number">0x72</span>,<span class="number">0x69</span>,<span class="number">0x67</span>,<span class="number">0x68</span>,<span class="number">0x74</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;真正的字符串内容：&quot;</span>)</span><br><span class="line">m=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> k,vinipairs(t) <span class="keyword">do</span></span><br><span class="line">    m=m..<span class="built_in">string</span>.<span class="built_in">char</span>(t[k])</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="built_in">print</span>(m)</span><br></pre></td></tr></table></figure>
<p><code>string.byte</code>返回字符 s[i]、s[i + 1]、s[i + 2]、······、s[j] 所对应的 ASCII 码。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&quot;123&quot;</span></span><br><span class="line">b = <span class="built_in">string</span>.<span class="built_in">byte</span>(a)</span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>


<p><code>string.format(formatstring, ...)</code>按照格式化参数formatstring，返回后面…内容的格式化版本。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%.4f&quot;</span>, <span class="number">3.1415926</span>)) <span class="comment">-- 保留4位小数</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%d %x %o&quot;</span>, <span class="number">31</span>, <span class="number">31</span>, <span class="number">31</span>))<span class="comment">-- 十进制数31转换成不同进制 d,m,y = 29,7,2015</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">string</span>.<span class="built_in">format</span>(<span class="string">&quot;%s %02d/%02d/%d&quot;</span>, <span class="string">&quot;today is:&quot;</span>, d, m, y))</span><br></pre></td></tr></table></figure>
<h3 id="luat框架"><a href="#luat框架" class="headerlink" title="luat框架"></a>luat框架</h3><p>Lua 协同程序(coroutine)与线程比较类似：拥有独立的堆栈，独立的局部变量，独立的指令指针，同时又与其它协同程序共享全局变量和其它大部分东西。协同是非常强大的功能，但是用起来也很复杂。</p>
<p>线程与协同程序的主要区别在于，一个具有多个线程的程序可以同时运行几个线程，而协同程序却需要彼此协作的运行。在任一指定时刻只有一个协同程序在运行，并且这个正在运行的协同程序只有在明确的被要求挂起的时候才会被挂起。协同程序有点类似同步的多线程，在等待同一个线程锁的几个线程有点类似协同。<br><a target="_blank" rel="noopener" href="https://www.w3cschool.cn/lua/lua-coroutine.html">协同程序更详细介绍</a></p>
<h3 id="Air724UG介绍"><a href="#Air724UG介绍" class="headerlink" title="Air724UG介绍"></a>Air724UG介绍</h3><p><a target="_blank" rel="noopener" href="http://www.openluat.com/product_center/product_detail?id=13">724UG</a></p>
<h2 id="第5天"><a href="#第5天" class="headerlink" title="第5天"></a>第5天</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2383/0">第五天</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/21/2372/" data-id="ckkfmdgar0041vkcghfsd3b29" data-title="Luat训练营-第4天" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2360" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/20/2360/" class="article-date">
  <time class="dt-published" datetime="2021-01-20T06:11:45.000Z" itemprop="datePublished">2021-01-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/20/2360/">Luat训练营-第3天</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>@<a href="Luat%E8%AE%AD%E7%BB%83%E8%90%A5-%E7%AC%AC3%E5%A4%A9">TOC</a></p>
<h2 id="第2天内容复习"><a href="#第2天内容复习" class="headerlink" title="第2天内容复习"></a>第2天内容复习</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2353/0">第二日内容</a></p>
<h2 id="第3天内容"><a href="#第3天内容" class="headerlink" title="第3天内容"></a>第3天内容</h2><h3 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h3><p>数组，使用一个变量名，存储一系列的值</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 纯数字</span></span><br><span class="line">table1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>&#125; <span class="comment">-- 注意：lua数组不是从0开始的</span></span><br><span class="line"><span class="built_in">print</span>(table1[<span class="number">1</span>]) <span class="comment">-- 打印第一个值</span></span><br><span class="line"><span class="built_in">print</span>(table2[<span class="number">5</span>]) <span class="comment">-- 打印第五个值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 带字符</span></span><br><span class="line">table2 = &#123;<span class="string">&quot;sas&quot;</span>,<span class="number">24</span>,<span class="string">&quot;asda&quot;</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(table2[<span class="number">1</span>]) <span class="comment">-- 打印第一个值</span></span><br><span class="line"><span class="built_in">print</span>(table2[<span class="number">2</span>]) <span class="comment">-- 打印第二个值</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 带方法（函数）</span></span><br><span class="line">table3 =</span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;123&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">     <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;456&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">     <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;789&quot;</span>)</span><br><span class="line">    <span class="keyword">end</span>,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">table3[<span class="number">1</span>]() <span class="comment">-- 执行函数数组的第一个函数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 下标</span></span><br><span class="line">table4 = &#123;</span><br><span class="line">    [<span class="number">1</span>] = <span class="number">6</span>,</span><br><span class="line">    [<span class="number">3</span>] = <span class="number">7</span>,</span><br><span class="line">    [<span class="number">4</span>] = <span class="number">8</span>,</span><br><span class="line">    [<span class="number">5</span>] = <span class="number">9</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(table4[<span class="number">1</span>]) <span class="comment">-- 打印第一个值</span></span><br><span class="line"><span class="built_in">print</span>(table4[<span class="number">2</span>]) <span class="comment">-- 打印第二个值 nil类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 下标进阶</span></span><br><span class="line">table5 = &#123;</span><br><span class="line">    lua = <span class="number">1</span>,</span><br><span class="line">    uu = <span class="number">3</span>,</span><br><span class="line">    [<span class="string">&quot;uyu&quot;</span>] = <span class="number">321</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(table5.lua)</span><br><span class="line"><span class="built_in">print</span>(table5.uyu)</span><br><span class="line"></span><br><span class="line">table5[<span class="string">&quot;yy&quot;</span>] = <span class="number">123</span></span><br><span class="line"><span class="built_in">print</span>(table5.yy)</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 全局变量标出</span></span><br><span class="line">a = <span class="number">1</span> <span class="comment">-- 全局变量</span></span><br><span class="line"><span class="built_in">_G</span>.b = <span class="number">2</span> <span class="comment">-- 全局变量的声明</span></span><br><span class="line"><span class="built_in">_G</span>.<span class="built_in">print</span>(<span class="number">123</span>) <span class="comment">-- 全局打印</span></span><br></pre></td></tr></table></figure>
<h3 id="课堂测试"><a href="#课堂测试" class="headerlink" title="课堂测试"></a>课堂测试</h3><p>请新建一个名为t的table，满足以下要求<br>t[10]可获得number类型数据100<br>t.num可获得number类型数据12<br>t.abc[3]可获得string类型数据abcd<br>t.a.b.c可获得number类型数据789</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--请补全代码</span></span><br><span class="line">t = &#123;</span><br><span class="line">	[<span class="number">10</span>] = <span class="number">100</span>,</span><br><span class="line">	num = <span class="number">12</span>,</span><br><span class="line">	abc =</span><br><span class="line">	&#123;</span><br><span class="line">		[<span class="number">3</span>] = <span class="string">&quot;abcd&quot;</span></span><br><span class="line">	&#125;,</span><br><span class="line">	a =</span><br><span class="line">	&#123;</span><br><span class="line">		b =</span><br><span class="line">		&#123;</span><br><span class="line">			c = <span class="number">789</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t[10]可获得number类型数据100:&quot;</span>,t[<span class="number">10</span>],<span class="built_in">type</span>(t[<span class="number">10</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t.num可获得number类型数据12:&quot;</span>,t.num,<span class="built_in">type</span>(t.num))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t.abc[3]可获得string类型数据abcd:&quot;</span>,t.abc[<span class="number">3</span>],<span class="built_in">type</span>(t.abc[<span class="number">3</span>]))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;t.a.b.c可获得number类型数据789:&quot;</span>,t.a.b.c,<span class="built_in">type</span>(t.a.b.c))</span><br></pre></td></tr></table></figure>
<h3 id="编译器出现乱码问题"><a href="#编译器出现乱码问题" class="headerlink" title="编译器出现乱码问题"></a>编译器出现乱码问题</h3><p>编译运行过程中出现乱码：</p>
<p><img src="https://img-blog.csdnimg.cn/20210120141301537.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODU3NzAw,size_16,color_FFFFFF,t_70#pic_center" alt="乱码"></p>
<p>1.解决办法1<br>检查一下插件：<br><img src="https://img-blog.csdnimg.cn/20210120141310657.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODU3NzAw,size_16,color_FFFFFF,t_70#pic_center" alt="插件"></p>
<p>2.解决办法2：<br>更改编码格式：<br><img src="https://img-blog.csdnimg.cn/20210120141340521.png#pic_center" alt="编码"></p>
<h2 id="第4天"><a href="#第4天" class="headerlink" title="第4天"></a>第4天</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2372/0">第4天</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/20/2360/" data-id="ckkfmdgar0040vkcgecvjgbee" data-title="Luat训练营-第3天" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2354" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/19/2354/" class="article-date">
  <time class="dt-published" datetime="2021-01-19T08:35:48.000Z" itemprop="datePublished">2021-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/19/2354/">Air820UG开发板封装原理图</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p><a href="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/attachment/20210119163547476_Air820UG开发板原理图&amp;PCB_PADS9.5格式.rar" target="_blank">Air820UG开发板原理图&amp;PCB_PADS9.5格式.rar</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/19/2354/" data-id="ckkfmdgar003zvkcg7evggsxy" data-title="Air820UG开发板封装原理图" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2353" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/19/2353/" class="article-date">
  <time class="dt-published" datetime="2021-01-19T08:23:07.000Z" itemprop="datePublished">2021-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/19/2353/">Luat训练营-第2天</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>@<a href="Luat%E8%AE%AD%E7%BB%83%E8%90%A5-%E7%AC%AC2%E5%A4%A9">TOC</a></p>
<h2 id="第1天内容复习"><a href="#第1天内容复习" class="headerlink" title="第1天内容复习"></a>第1天内容复习</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2351/0">第一天内容</a></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 单行内容注释</span></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">多行内容注释</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line">a = <span class="number">1</span> <span class="comment">-- 变量赋值</span></span><br><span class="line">b = <span class="number">2</span> <span class="comment">-- 变量赋值</span></span><br><span class="line">s,d,f = <span class="number">11</span>,<span class="string">&quot;123fghf&quot;</span>,<span class="number">213</span><span class="comment">-- 多变量赋值</span></span><br><span class="line">c = <span class="literal">nil</span> <span class="comment">-- nil类型</span></span><br><span class="line"><span class="built_in">print</span>(a,b,s,d,f,c)<span class="comment">-- 打印</span></span><br></pre></td></tr></table></figure>
<h2 id="第2天内容"><a href="#第2天内容" class="headerlink" title="第2天内容"></a>第2天内容</h2><h3 id="提要"><a href="#提要" class="headerlink" title="提要"></a>提要</h3><p><img src="https://img-blog.csdnimg.cn/20210119160520483.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODU3NzAw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<h3 id="加减乘除取余乘方"><a href="#加减乘除取余乘方" class="headerlink" title="加减乘除取余乘方"></a>加减乘除取余乘方</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 加法</span></span><br><span class="line">a = <span class="number">22</span></span><br><span class="line">b = <span class="number">56</span></span><br><span class="line">c = a + b</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- print(a+b)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 减法</span></span><br><span class="line">c = a - b</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- print( a-b)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 乘法</span></span><br><span class="line">c = a * b</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- print(a*b)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--除法</span></span><br><span class="line">c = a / b <span class="comment">--注意不是反斜杠</span></span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- print(a/b)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--取余</span></span><br><span class="line">c = b % a</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- print(b%a)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--乘方</span></span><br><span class="line">c = a ^ b</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- print(a^b)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--四则运算</span></span><br><span class="line">c = (a+b)*a</span><br><span class="line"><span class="built_in">print</span>(c) <span class="comment">-- print((a+b)*a)</span></span><br></pre></td></tr></table></figure>
<h3 id="转义字符"><a href="#转义字符" class="headerlink" title="转义字符"></a>转义字符</h3><p>课上内容：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\\&quot;</span>) <span class="comment">-- 打印反斜杠</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\0&quot;</span>) <span class="comment">-- 打印null</span></span><br></pre></td></tr></table></figure>
<p>课下拓展：</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;\\&#x27;</span>);    <span class="comment">-- 单斜杠</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\&quot;&quot;</span>);    <span class="comment">-- 双引号</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\&quot;\&quot;&quot;</span>);  <span class="comment">--  双引号</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;\&#x27;&quot;</span>);    <span class="comment">--  单引号</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&#x27;&#x27;&quot;</span>);    <span class="comment">-- 单引号</span></span><br></pre></td></tr></table></figure>
<h3 id="拼接字符串"><a href="#拼接字符串" class="headerlink" title="拼接字符串"></a>拼接字符串</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;i&quot;</span>..<span class="string">&quot; am&quot;</span>..<span class="string">&quot; lua&quot;</span>)<span class="comment">-- 字符串拼接</span></span><br></pre></td></tr></table></figure>
<h3 id="数字与字符串互转"><a href="#数字与字符串互转" class="headerlink" title="数字与字符串互转"></a>数字与字符串互转</h3><p>函数 转为字符串 <code>tostring</code><br>函数 转为数字 <code>tonumber</code></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 字符串转换</span></span><br><span class="line">n = <span class="number">1</span> <span class="comment">--数字类型</span></span><br><span class="line">m = <span class="string">&quot;m&quot;</span> <span class="comment">-- 字符类型</span></span><br><span class="line">h = <span class="built_in">tostring</span>(n)..m <span class="comment">-- 转换 拼接</span></span><br><span class="line"><span class="built_in">print</span>(h) <span class="comment">-- 打印</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--数字转换</span></span><br><span class="line">a = <span class="number">123</span> <span class="comment">-- 数字</span></span><br><span class="line">s = <span class="string">&quot;555&quot;</span> <span class="comment">-- 字符串</span></span><br><span class="line">d = a .. <span class="built_in">tonumber</span>(s) <span class="comment">-- 转换 拼接</span></span><br><span class="line"><span class="built_in">print</span>(d) <span class="comment">-- 打印</span></span><br></pre></td></tr></table></figure>

<h2 id="其他内容"><a href="#其他内容" class="headerlink" title="其他内容"></a>其他内容</h2><p>参考：<a target="_blank" rel="noopener" href="https://wiki.openluat.com/doc/luaStart/">LUAT 让无线通信更优雅</a></p>
<h3 id="布尔型和比较运算"><a href="#布尔型和比较运算" class="headerlink" title="布尔型和比较运算"></a>布尔型和比较运算</h3><p>布尔型（boolean）只有两个可选值：true（真） 和 false（假）<br>Lua 把 false 和 nil 看作是false，其他的都为true（包括0这个值，也是相当于true）</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">12</span></span><br><span class="line">b = <span class="number">23</span></span><br><span class="line"><span class="built_in">print</span>(a == b) <span class="comment">-- 判断相等  f</span></span><br><span class="line"><span class="built_in">print</span>(a ~= b) <span class="comment">-- 判断不相等 t</span></span><br><span class="line"><span class="built_in">print</span>(a &gt; b) <span class="comment">-- 判断大于 f</span></span><br><span class="line"><span class="built_in">print</span>(a &lt; b) <span class="comment">-- 判断小于 t</span></span><br><span class="line"><span class="built_in">print</span>(a &gt;= b) <span class="comment">-- 判断大于等于 f</span></span><br><span class="line"><span class="built_in">print</span>(a &lt;= b) <span class="comment">-- 判断小于等于 t</span></span><br></pre></td></tr></table></figure>
<h3 id="逻辑运算符"><a href="#逻辑运算符" class="headerlink" title="逻辑运算符"></a>逻辑运算符</h3><p>and逻辑与操作符。 若 A 为 false，则返回 A，否则返回 B<br>or逻辑或操作符。 若 A 为 true，则返回 A，否则返回 B<br>not逻辑非操作符。与逻辑运算结果相反，如果条件为 true，逻辑非为 false</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">-- 逻辑与</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">and</span> <span class="literal">true</span>) <span class="comment">-- t</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">and</span> <span class="literal">false</span>) <span class="comment">-- f</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">false</span> <span class="keyword">and</span> <span class="literal">false</span>) <span class="comment">-- f</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 逻辑或</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">or</span> <span class="literal">true</span>) <span class="comment">-- t</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">true</span> <span class="keyword">or</span> <span class="literal">false</span>) <span class="comment">-- t</span></span><br><span class="line"><span class="built_in">print</span>(<span class="literal">false</span> <span class="keyword">or</span> <span class="literal">false</span>) <span class="comment">-- f</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 逻辑非</span></span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">not</span> <span class="literal">true</span>) <span class="comment">-- f</span></span><br><span class="line"><span class="built_in">print</span>(<span class="keyword">not</span> <span class="literal">false</span>) <span class="comment">-- t</span></span><br></pre></td></tr></table></figure>
<h3 id="条件判断"><a href="#条件判断" class="headerlink" title="条件判断"></a>条件判断</h3><p>if 条件1 then<br>    符合条件1后执行的代码<br>elseif 条件2 then<br>    符合条件2后执行的代码<br>else<br>    其他条件执行的代码<br>end</p>
<p>while 判断依据 do  满足做什么 end</p>
<p>for 临时变量名=开始值,结束值,步长 do 循环的代码 end</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> a &lt; <span class="number">10</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;a&quot;</span>,a)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- 需要注意的： 0这个值，也是相当于true</span></span><br><span class="line"><span class="keyword">if</span> <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--false 和 0</span></span><br><span class="line"><span class="keyword">if</span> <span class="literal">false</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;1&quot;</span>)</span><br><span class="line"><span class="keyword">elseif</span> <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;2&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- nil</span></span><br><span class="line"><span class="keyword">if</span> <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;123&quot;</span>)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- while 判断依据 do  满足做什么 end</span></span><br><span class="line">a = <span class="number">10</span></span><br><span class="line"><span class="keyword">while</span> a&gt;<span class="number">1</span> <span class="keyword">do</span></span><br><span class="line">    a = a - <span class="number">1</span> <span class="comment">-- 每次循环减一</span></span><br><span class="line">    <span class="built_in">print</span>(a) <span class="comment">-- 打印下a</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">-- for</span></span><br><span class="line"><span class="keyword">for</span> i = <span class="number">1</span>,<span class="number">10</span>,<span class="number">1</span> <span class="keyword">do</span> <span class="comment">-- 从1加到10  每次步长为1</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h3 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h3><p>函数是指一段在一起的、可以做某一件事儿的程序，也叫做子程序。在前面的内容中，我们已经接触过了函数的调用，这个函数就是前面用到了很多次的print(…)。调用函数只需要按下面的格式即可：函数名(参数1,参数2,参数3,……)为何要使用函数？因为很多事情都是重复性操作，我们使用函数，可以快速完成这些操作<br>基础函数</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--函数原型</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span><span class="params">()</span></span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;hello lua&quot;</span>)<span class="comment">-- 打印</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--函数调用</span></span><br><span class="line">hello() <span class="comment">--</span></span><br></pre></td></tr></table></figure>
<p>局部变量 loacal<br>使用local创建一个局部变量，与全局变量不同，局部变量只在被声明的那个代码块内有效。</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span><span class="params">()</span></span></span><br><span class="line">    <span class="keyword">local</span> a = <span class="number">1</span></span><br><span class="line">    <span class="built_in">print</span>(a)<span class="comment">-- 打印</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">--函数调用</span></span><br><span class="line"><span class="built_in">print</span>(a) <span class="comment">-- 函数外打印</span></span><br><span class="line">hello() <span class="comment">--</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210119160536238.png#pic_center" alt="在这里插入图片描述"></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">add</span><span class="params">(num1,num2,num3)</span></span></span><br><span class="line">   <span class="keyword">local</span> a  = num1+ num2 +num3 <span class="comment">-- 全加</span></span><br><span class="line">   <span class="keyword">local</span> b  = num1* num2  <span class="comment">-- 乘法</span></span><br><span class="line">   <span class="keyword">return</span> a,b,num3  <span class="comment">--多变量返回</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">x1,x2,x3 = add(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>( x1,x2,x3) <span class="comment">-- 打印</span></span><br></pre></td></tr></table></figure>
<h2 id="第3天"><a href="#第3天" class="headerlink" title="第3天"></a>第3天</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2360/0">第3天</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/19/2353/" data-id="ckkfmdgaq003yvkcgc99o377n" data-title="Luat训练营-第2天" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-2351" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/19/2351/" class="article-date">
  <time class="dt-published" datetime="2021-01-19T08:20:40.000Z" itemprop="datePublished">2021-01-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2021/01/19/2351/">Luat训练营-第1天</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <p>@<a href="Luat%E8%AE%AD%E7%BB%83%E8%90%A5-%E7%AC%AC1%E5%A4%A9">TOC</a></p>
<h2 id="相关事宜"><a href="#相关事宜" class="headerlink" title="相关事宜"></a>相关事宜</h2><p>1.福利很多板子、优惠券！！（优秀作业、优秀案例）<br>2.训练营进行中回放可以在腾讯课堂回看，训练营结束后可以在哔哩哔哩 UID:88809897中查看</p>
<h2 id="课程内容"><a href="#课程内容" class="headerlink" title="课程内容"></a>课程内容</h2><h3 id="配置环境"><a href="#配置环境" class="headerlink" title="配置环境"></a>配置环境</h3><p>1.使用Visual Studio Code(群文件-&gt; 学习工具/自行下载)<br>2.安装插件：chinese(中文环境)<br>                lua(环境插件)<br>                luat(环境插件)</p>
<p>3.调试：①在线调试（doc.openluat.com/java）<br>          ②本地调试（需要安装lua环境）<br>          ③Visual Studio Code安装插件，安装后点击右上角三角即可运行（code runner插件）</p>
<h3 id="hello-world"><a href="#hello-world" class="headerlink" title="hello world"></a>hello world</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello lua&quot;</span>)<span class="comment">--控制台打印输出</span></span><br></pre></td></tr></table></figure>
<h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">air = <span class="string">&quot;hello world&quot;</span><span class="comment">--字符串变量赋值</span></span><br><span class="line"><span class="built_in">print</span>(air)<span class="comment">--打印变量</span></span><br><span class="line">air2 = <span class="number">6</span><span class="comment">--数字变量赋值</span></span><br><span class="line"><span class="built_in">print</span>(air2)<span class="comment">--打印变量</span></span><br></pre></td></tr></table></figure>
<h3 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--这是一个单行注释</span></span><br><span class="line"></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">这是一个多行注释</span></span><br><span class="line"><span class="comment">]]</span></span><br></pre></td></tr></table></figure>
<h3 id="多变量赋值"><a href="#多变量赋值" class="headerlink" title="多变量赋值"></a>多变量赋值</h3><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">air,air2 = <span class="string">&quot;hw&quot;</span>,<span class="number">6</span> <span class="comment">--按次序赋值</span></span><br><span class="line"><span class="built_in">print</span>(air)<span class="comment">--打印</span></span><br><span class="line"><span class="built_in">print</span>(air2)<span class="comment">--打印</span></span><br></pre></td></tr></table></figure>
<h3 id="nil"><a href="#nil" class="headerlink" title="nil"></a>nil</h3><p><code>nil</code>表示没有任何有效值，只要是没有声明的值，它就是<code>nil</code>.</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(a)<span class="comment">--a没有声明，直接打印就会是nil类型</span></span><br><span class="line">b = <span class="literal">nil</span> <span class="comment">--将变量声明为nil类型</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br></pre></td></tr></table></figure>
<h3 id="作业"><a href="#作业" class="headerlink" title="作业"></a>作业</h3><p>使用Day1讲的用法，写一个自己的程序。<br>要求<br>1、禁止抄袭<br>2、代码量不少于10行<br><img src="https://img-blog.csdnimg.cn/20210119144738946.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzQ0ODU3NzAw,size_16,color_FFFFFF,t_70#pic_center" alt="在这里插入图片描述"></p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&quot;hello lua !!&quot;</span>)<span class="comment">--打印</span></span><br><span class="line">num = <span class="number">10</span><span class="comment">--变量赋值</span></span><br><span class="line">num1,num2 = <span class="number">5</span>,<span class="literal">nil</span> <span class="comment">--多变量赋值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;the num is &quot;</span>,num)<span class="comment">--打印</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;the num1 is &quot;</span>,num1)<span class="comment">--打印</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;the num2 is &quot;</span>,num2)<span class="comment">--打印</span></span><br><span class="line"><span class="comment">--[[</span></span><br><span class="line"><span class="comment">进行变量赋值</span></span><br><span class="line"><span class="comment">]]</span></span><br><span class="line">num,num1 = num1,num2<span class="comment">--多变量赋值</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;changed the num is &quot;</span>,num)<span class="comment">--打印</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;changed the num1 is &quot;</span>,num1)<span class="comment">--打印</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;the num2 is &quot;</span>,num2)<span class="comment">--打印</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="第2天"><a href="#第2天" class="headerlink" title="第2天"></a>第2天</h2><p><a target="_blank" rel="noopener" href="http://doc.openluat.com/article/2353/0#_219">第二天</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2021/01/19/2351/" data-id="ckkfmdgaq003xvkcg3nhoewt0" data-title="Luat训练营-第1天" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; 上一页</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/59/">59</a><a class="extend next" rel="next" href="/page/3/">下一页 &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>