<!DOCTYPE html>

<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <title>Air724UG LTE Cat.1 通信模块开发应用手册（未完 [ Luat doc 社区文章静态页面镜像 ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/iLiKE.css">
    
  
  
  
<meta name="generator" content="Hexo 5.3.0"></head>
<body>
    <div class="header">
        <div class="container">
    <div class="menu">
      <div class="menu-left">
        <a href="/">
          <img src="https://iot.openluat.com/assets/img/logo.jpg"></img>
        </a>
      </div>
      <div class="menu-right">
        
          
          
          
          
          
          
          <a href="/">首页</a>
        
          
          
          
          
          
          
          <a href="/archives">归档</a>
        
          
          
          
          
          
          
          <a href="/about">关于</a>
        
      </div>
    </div>
</div>
    </div>
    <div class="container">
        <h1 class="post-title">Air724UG LTE Cat.1 通信模块开发应用手册（未完</h1>
<article class="post markdown-style">
  <h1 id="1-目录"><a href="#1-目录" class="headerlink" title="1. 目录"></a>1. 目录</h1><ul>
<li><strong>1. 目录</strong></li>
<li><strong>[2. 综述](#2. 综述)</strong><ul>
<li><strong>2.1 [概述](#2.1 概述)</strong></li>
<li><strong>2.2 [主要特点](#2.2 主要特点)</strong></li>
<li><strong>2.3 [功能框图](#2.3 功能框图)</strong></li>
<li><strong>2.4 [管脚描述](#2.4 管脚描述)</strong></li>
<li><strong>2.5 [机械尺寸](#2.5 机械尺寸)</strong></li>
<li><strong>2.6 [PCB封装](#2.6 PCB封装)</strong></li>
</ul>
</li>
<li><strong>[3. 硬件接口功能描述](#3. 硬件接口功能描述)</strong><ul>
<li><strong>3.1 [电源供电](#3.1 电源供电)</strong></li>
<li><strong>3.2 [开关机](#3.2 开关机)</strong></li>
<li><strong>3.3 [省电模式](#3.3 省电模式)</strong></li>
<li><strong>3.4 [串口](#3.4 串口)</strong></li>
<li><strong>3.5 [USB接口](#3.5 USB接口)</strong></li>
<li><strong>3.6 [SIM卡接口](#3.6 SIM卡接口)</strong></li>
<li><strong>3.7 [网络状态指示](#3.7 网络状态指示)</strong></li>
<li><strong>3.8 [模拟语音接口](#3.8 模拟语音接口)</strong></li>
<li><strong>3.9 [数字语音接口](#3.9 数字语音接口)</strong></li>
<li><strong>3.10 [I2C接口](#3.10 I2C接口)</strong></li>
<li><strong>3.11 [LCD SPI接口](#3.11 LCD SPI接口)</strong></li>
<li><strong>3.12 [通用SPI接口](#3.12 通用SPI接口)</strong></li>
<li><strong>3.13 [Camera接口](#3.13 Camera接口)</strong></li>
<li><strong>3.14 [SDIO接口](#3.14 SDIO接口)</strong></li>
<li><strong>3.15 [键盘接口](#3.15 键盘接口)</strong></li>
<li><strong>3.16 [LDO接口](#3.16 LDO接口)</strong></li>
<li><strong>3.17 [PWM](#3.17 PWM)</strong></li>
<li><strong>3.18 [GPIO](#3.18 GPIO)</strong></li>
<li><strong>3.19 [ADC接口](#3.19 ADC接口)</strong></li>
<li><strong>3.20 [蓝牙BLE](#3.20 蓝牙BLE)</strong></li>
<li><strong>3.21 [Wifi扫描](#3.21 Wifi扫描)</strong></li>
<li><strong>3.22 [天线接口](#3.22 天线接口)</strong></li>
</ul>
</li>
<li><strong>4. [软件功能描述](#4. 软件功能描述)</strong><ul>
<li><strong>4.1 [网络协议](#4.1 网络协议)</strong><ul>
<li><strong>4.1.1 [TCP/UDP](#4.1.1 TCP/UDP)</strong></li>
<li><strong>4.1.2 [HTTP/HTTPS](#4.1.2 HTTP/HTTPS)</strong></li>
<li><strong>4.1.3 [FTP/FTPS](#4.1.3 FTP/FTPS)</strong></li>
<li><strong>4.1.4 [MQTT](#4.1.4 MQTT)</strong></li>
<li><strong>4.1.5 [SSL](#4.1.5 SSL)</strong></li>
<li><strong>4.1.6 [PING](#4.1.6 PING)</strong></li>
<li><strong>4.1.7 [FILE](#4.1.7 FILE)</strong></li>
<li><strong>4.1.8 [RNDIS](#4.1.8 RNDIS)</strong></li>
<li><strong>4.1.9 [PPP](#4.1.9 PPP)</strong></li>
<li><strong>4.1.10 [ECM](#4.1.10 ECM)</strong></li>
<li><strong>4.1.11 [CMUX](#4.1.11 CMUX)</strong></li>
</ul>
</li>
<li><strong>4.2 [阿里云](#4.2 阿里云)</strong></li>
<li><strong>4.3 [基站定位](#4.3 基站定位)</strong></li>
<li><strong>4.4 [时间同步](#4.4 时间同步)</strong></li>
<li><strong>4.5 [文件系统操作](#4.5 文件系统操作)</strong></li>
<li><strong>4.6 [通话语音](#4.6 通话语音)</strong></li>
<li><strong>4.7 [短信](#4.7 短信)</strong></li>
<li><strong>4.8 [录音](#4.8 录音)</strong></li>
<li><strong>4.9 [TTS](#4.9 TTS)</strong></li>
<li><strong>4.10 [远程升级](#4.10 远程升级)</strong></li>
</ul>
</li>
<li><strong>5. [API](#5. API)</strong></li>
<li><strong>6. [调试相关](#6. 调试相关)</strong><ul>
<li><strong>6.1 [固件升级](#6.1 固件升级)</strong></li>
<li><strong>6.2 [开发调试](#6.2 开发调试)</strong></li>
</ul>
</li>
<li><strong>7. [电气特性](#7. 电气特性)</strong><ul>
<li><strong>7.1 [绝对最大值](#7.1 绝对最大值)</strong></li>
<li><strong>7.2 [推荐工作条件](#7.2 推荐工作条件)</strong></li>
<li><strong>7.3 [工作温度](#7.3 工作温度)</strong></li>
<li><strong>7.4 [射频参数](#7.4 射频参数)</strong></li>
<li><strong>7.5 [功耗](#7.5 功耗)</strong></li>
</ul>
</li>
<li><strong>8. [存储和生产](#8. 存储和生产)</strong></li>
</ul>
<h1 id="2-综述"><a href="#2-综述" class="headerlink" title="2. 综述"></a>2. 综述</h1><ul>
<li>本文档为Air724UG模组的应用开发指导文档。描述了Air724UG模组的硬件功能接口，相关软件API，相关控制AT指令，以及升级调试。以便让您更快速的了解模块的功能接口，电气特性，性能指标，软件控制方式等细节。能够容易的用Air724UG模组进行各种应用设计。</li>
<li>由于Air724UG有两种应用开发方式：标准AT指令和LUAT opencpu 二次开发方式。本文会分别以两种开发方式来介绍，每个功能模块的应用方法。</li>
</ul>
<h2 id="2-1-概述"><a href="#2-1-概述" class="headerlink" title="2.1 概述"></a>2.1 概述</h2><ul>
<li>Air724UG 是一款超小型的单LTE Cat.1 bis 模块，采用紫光展锐的UIS8910平台，支持 LTE 3GPP Rel.13 技术，支持LTE-TDD/LTE-FDD，最大下行速率10Mbps，最大上行速率5Mbps。同时支持语音通话，多媒体，BLE等功能，满足各种物联网通信应用需求。</li>
</ul>
<h2 id="2-2-主要特点"><a href="#2-2-主要特点" class="headerlink" title="2.2 主要特点"></a>2.2 主要特点</h2><ul>
<li><h5 id="处理器："><a href="#处理器：" class="headerlink" title="处理器："></a>处理器：</h5><ul>
<li>500Mhz Cortex A5 处理器</li>
<li>32KB ICache , 32KB DCache</li>
</ul>
</li>
<li><h5 id="存储器："><a href="#存储器：" class="headerlink" title="存储器："></a>存储器：</h5><ul>
<li>64Mb SPI Nor Flash</li>
<li>128Mb PSRAM</li>
</ul>
</li>
<li><h5 id="Modem-特性："><a href="#Modem-特性：" class="headerlink" title="Modem 特性："></a>Modem 特性：</h5><ul>
<li>3GPP R13</li>
<li>LTE-TDD:B38/B39/B40/B41</li>
<li>LTE-FDD:B1/B3/B5/B8</li>
<li>支持1.4/3/5/10/15/20MHz射频带宽</li>
<li>LTE-FDD速率： DL 10Mbps/ UL 5Mbps</li>
<li>LTE-TDD速率：上下行配比2：DL 8Mbps/ UL 2Mbps</li>
<li>LTE-TDD速率：上下行配比1：DL 6Mbps/ UL 4Mbps</li>
<li>支持 VoLTE</li>
</ul>
</li>
<li><h5 id="网路协议特性："><a href="#网路协议特性：" class="headerlink" title="网路协议特性："></a>网路协议特性：</h5><ul>
<li>TCP/UDP/PPP/FTP/HTTP/NITZ/CMUX/NDIS/NTP/HTTPS/PING/FTPS/FILE</li>
</ul>
</li>
<li><h5 id="USIM卡接口："><a href="#USIM卡接口：" class="headerlink" title="USIM卡接口："></a>USIM卡接口：</h5><ul>
<li>支持USIM/SIM卡：1.8V和3V</li>
</ul>
</li>
<li><h5 id="显示接口："><a href="#显示接口：" class="headerlink" title="显示接口："></a>显示接口：</h5><ul>
<li>支持 SPI 3 线或 4 线模式 </li>
<li>最大支持QVGA @ 30fps</li>
</ul>
</li>
<li><h5 id="视频特性："><a href="#视频特性：" class="headerlink" title="视频特性："></a>视频特性：</h5><ul>
<li>支持 MJPEQ格式 @ 15fps</li>
<li>支持 H.264, H.263, MPEG4, MJPG HVGA格式 @ 25fps</li>
</ul>
</li>
<li><h5 id="外围接口："><a href="#外围接口：" class="headerlink" title="外围接口："></a>外围接口：</h5><ul>
<li>1路USB2.0</li>
<li>2路模拟输入</li>
<li>2路模拟输出</li>
<li>3路UART接口</li>
<li>1路通用SPI接口</li>
<li>1路LCD专用接口</li>
<li>1路SPI Camera接口</li>
<li>1路SDIO接口</li>
<li>6X6矩阵键盘</li>
<li>2路12bit ADC</li>
<li>BLE/WIFI天线接口</li>
</ul>
</li>
<li><h5 id="温度特性："><a href="#温度特性：" class="headerlink" title="温度特性："></a>温度特性：</h5><ul>
<li>正常工作温度：-35°C～+70°C</li>
<li>极限工作温度：-40°C～+85°C</li>
</ul>
</li>
<li><h5 id="封装："><a href="#封装：" class="headerlink" title="封装："></a>封装：</h5><ul>
<li>LCC+LGA  117PIN</li>
</ul>
</li>
</ul>
<h2 id="2-3-功能框图"><a href="#2-3-功能框图" class="headerlink" title="2.3 功能框图"></a>2.3 功能框图</h2><h2 id="2-4-管脚描述"><a href="#2-4-管脚描述" class="headerlink" title="2.4 管脚描述"></a>2.4 管脚描述</h2><ul>
<li>模块采用LCC+LGA封装，117个SMT焊盘管脚</li>
</ul>
<p><img src="http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200510214420522_AIR720UG.png"></p>
<p><strong>表格1：管脚描述</strong></p>
<table>
<thead>
<tr>
<th>管脚名</th>
<th>管脚</th>
<th>上电默认状态</th>
<th>描述</th>
<th>备注</th>
</tr>
</thead>
<tbody><tr>
<td>VBAT</td>
<td>57,58,59,60</td>
<td></td>
<td>模块主电源</td>
<td>VBAT=3.3V~4.3V</td>
</tr>
<tr>
<td>V_GLOBAL_1V8</td>
<td>7</td>
<td></td>
<td>io参考电压输出</td>
<td>最大电流50mA（电压不可调）</td>
</tr>
<tr>
<td>VMMC</td>
<td>24</td>
<td></td>
<td>输出1.6-3.2V，默认电压是3.1V</td>
<td>给MMC供电</td>
</tr>
<tr>
<td>VCC_CAMA</td>
<td>79</td>
<td></td>
<td>输出1.6-3.2V，默认是1.8V</td>
<td>给Camera 提供模拟电压</td>
</tr>
<tr>
<td>VCC_CAMD</td>
<td>80</td>
<td></td>
<td>输出1.4-2.1V，默认是1.8V</td>
<td>给Camera 提供数字电压</td>
</tr>
<tr>
<td>VCC_LCD</td>
<td>81</td>
<td></td>
<td>输出1.6-3.3V，默认电压是1.8V</td>
<td>给LCD供电</td>
</tr>
<tr>
<td>GND</td>
<td>参考管脚图</td>
<td></td>
<td>模块参考地</td>
<td></td>
</tr>
<tr>
<td>PWRKEY</td>
<td>68</td>
<td></td>
<td>开机/关机控制关机，拉低有效</td>
<td>VBAT电压域</td>
</tr>
<tr>
<td>VCC_CAMA</td>
<td>79</td>
<td></td>
<td>输出1.6-3.2V，，默认是1.8V</td>
<td>给Camera 提供模拟电压</td>
</tr>
<tr>
<td>VCC_CAMA</td>
<td>79</td>
<td></td>
<td>输出1.6-3.2V，，默认是1.8V</td>
<td>给Camera 提供模拟电压</td>
</tr>
<tr>
<td>VCC_CAMA</td>
<td>79</td>
<td></td>
<td>输出1.6-3.2V，，默认是1.8V</td>
<td>给Camera 提供模拟电压</td>
</tr>
</tbody></table>
<h2 id="2-5-机械尺寸"><a href="#2-5-机械尺寸" class="headerlink" title="2.5 机械尺寸"></a>2.5 机械尺寸</h2><h2 id="2-6-PCB封装"><a href="#2-6-PCB封装" class="headerlink" title="2.6 PCB封装"></a>2.6 PCB封装</h2><h1 id="3-硬件接口功能描述"><a href="#3-硬件接口功能描述" class="headerlink" title="3. 硬件接口功能描述"></a>3. 硬件接口功能描述</h1><h2 id="3-1-电源供电"><a href="#3-1-电源供电" class="headerlink" title="3.1 电源供电"></a>3.1 电源供电</h2><h2 id="3-2-开关机"><a href="#3-2-开关机" class="headerlink" title="3.2 开关机"></a>3.2 开关机</h2><h2 id="3-3-省电模式"><a href="#3-3-省电模式" class="headerlink" title="3.3 省电模式"></a>3.3 省电模式</h2><h2 id="3-4-串口"><a href="#3-4-串口" class="headerlink" title="3.4 串口"></a>3.4 串口</h2><h2 id="3-5-USB接口"><a href="#3-5-USB接口" class="headerlink" title="3.5 USB接口"></a>3.5 USB接口</h2><h2 id="3-6-SIM卡接口"><a href="#3-6-SIM卡接口" class="headerlink" title="3.6 SIM卡接口"></a>3.6 SIM卡接口</h2><h2 id="3-7-网络状态指示"><a href="#3-7-网络状态指示" class="headerlink" title="3.7 网络状态指示"></a>3.7 网络状态指示</h2><h2 id="3-8-模拟语音接口"><a href="#3-8-模拟语音接口" class="headerlink" title="3.8 模拟语音接口"></a>3.8 模拟语音接口</h2><h2 id="3-9-数字语音接口"><a href="#3-9-数字语音接口" class="headerlink" title="3.9 数字语音接口"></a>3.9 数字语音接口</h2><h2 id="3-10-I2C接口"><a href="#3-10-I2C接口" class="headerlink" title="3.10 I2C接口"></a>3.10 I2C接口</h2><h2 id="3-11-LCD-SPI接口"><a href="#3-11-LCD-SPI接口" class="headerlink" title="3.11 LCD SPI接口"></a>3.11 LCD SPI接口</h2><h2 id="3-12-通用SPI接口"><a href="#3-12-通用SPI接口" class="headerlink" title="3.12 通用SPI接口"></a>3.12 通用SPI接口</h2><h2 id="3-13-Camera接口"><a href="#3-13-Camera接口" class="headerlink" title="3.13 Camera接口"></a>3.13 Camera接口</h2><h2 id="3-14-SDIO接口"><a href="#3-14-SDIO接口" class="headerlink" title="3.14 SDIO接口"></a>3.14 SDIO接口</h2><h2 id="3-15-键盘接口"><a href="#3-15-键盘接口" class="headerlink" title="3.15 键盘接口"></a>3.15 键盘接口</h2><h2 id="3-16-LDO接口"><a href="#3-16-LDO接口" class="headerlink" title="3.16 LDO接口"></a>3.16 LDO接口</h2><h2 id="3-17-PWM"><a href="#3-17-PWM" class="headerlink" title="3.17 PWM"></a>3.17 PWM</h2><h2 id="3-18-GPIO"><a href="#3-18-GPIO" class="headerlink" title="3.18 GPIO"></a>3.18 GPIO</h2><h2 id="3-19-ADC接口"><a href="#3-19-ADC接口" class="headerlink" title="3.19 ADC接口"></a>3.19 ADC接口</h2><h2 id="3-20-蓝牙BLE"><a href="#3-20-蓝牙BLE" class="headerlink" title="3.20 蓝牙BLE"></a>3.20 蓝牙BLE</h2><h2 id="3-21-Wifi扫描"><a href="#3-21-Wifi扫描" class="headerlink" title="3.21 Wifi扫描"></a>3.21 Wifi扫描</h2><h2 id="3-22-天线接口"><a href="#3-22-天线接口" class="headerlink" title="3.22 天线接口"></a>3.22 天线接口</h2><h1 id="4-软件功能描述"><a href="#4-软件功能描述" class="headerlink" title="4. 软件功能描述"></a>4. 软件功能描述</h1><h2 id="4-1-网络协议"><a href="#4-1-网络协议" class="headerlink" title="4.1 网络协议"></a>4.1 网络协议</h2><h3 id="4-1-1-TCP-UDP"><a href="#4-1-1-TCP-UDP" class="headerlink" title="4.1.1 TCP/UDP"></a>4.1.1 TCP/UDP</h3><h3 id="4-1-2-HTTP-HTTPS"><a href="#4-1-2-HTTP-HTTPS" class="headerlink" title="4.1.2 HTTP/HTTPS"></a>4.1.2 HTTP/HTTPS</h3><h3 id="4-1-3-FTP-FTPS"><a href="#4-1-3-FTP-FTPS" class="headerlink" title="4.1.3 FTP/FTPS"></a>4.1.3 FTP/FTPS</h3><h3 id="4-1-4-MQTT"><a href="#4-1-4-MQTT" class="headerlink" title="4.1.4 MQTT"></a>4.1.4 MQTT</h3><h3 id="4-1-5-SSL"><a href="#4-1-5-SSL" class="headerlink" title="4.1.5 SSL"></a>4.1.5 SSL</h3><h3 id="4-1-6-PING"><a href="#4-1-6-PING" class="headerlink" title="4.1.6 PING"></a>4.1.6 PING</h3><h3 id="4-1-7-FILE"><a href="#4-1-7-FILE" class="headerlink" title="4.1.7 FILE"></a>4.1.7 FILE</h3><h3 id="4-1-8-RNDIS"><a href="#4-1-8-RNDIS" class="headerlink" title="4.1.8 RNDIS"></a>4.1.8 RNDIS</h3><h3 id="4-1-9-PPP"><a href="#4-1-9-PPP" class="headerlink" title="4.1.9 PPP"></a>4.1.9 PPP</h3><h3 id="4-1-10-ECM"><a href="#4-1-10-ECM" class="headerlink" title="4.1.10 ECM"></a>4.1.10 ECM</h3><h3 id="4-1-11-CMUX"><a href="#4-1-11-CMUX" class="headerlink" title="4.1.11 CMUX"></a>4.1.11 CMUX</h3><h2 id="4-2-阿里云"><a href="#4-2-阿里云" class="headerlink" title="4.2 阿里云"></a>4.2 阿里云</h2><h2 id="4-3-基站定位"><a href="#4-3-基站定位" class="headerlink" title="4.3 基站定位"></a>4.3 基站定位</h2><h2 id="4-4-时间同步"><a href="#4-4-时间同步" class="headerlink" title="4.4 时间同步"></a>4.4 时间同步</h2><h2 id="4-5-文件系统操作"><a href="#4-5-文件系统操作" class="headerlink" title="4.5 文件系统操作"></a>4.5 文件系统操作</h2><h2 id="4-6-通话语音"><a href="#4-6-通话语音" class="headerlink" title="4.6 通话语音"></a>4.6 通话语音</h2><h2 id="4-7-短信"><a href="#4-7-短信" class="headerlink" title="4.7 短信"></a>4.7 短信</h2><h2 id="4-8-录音"><a href="#4-8-录音" class="headerlink" title="4.8 录音"></a>4.8 录音</h2><h2 id="4-9-TTS"><a href="#4-9-TTS" class="headerlink" title="4.9 TTS"></a>4.9 TTS</h2><h2 id="4-10-远程升级"><a href="#4-10-远程升级" class="headerlink" title="4.10 远程升级"></a>4.10 远程升级</h2><h1 id="5-API"><a href="#5-API" class="headerlink" title="5. API"></a>5. API</h1><h1 id="6-调试相关"><a href="#6-调试相关" class="headerlink" title="6. 调试相关"></a>6. 调试相关</h1><h2 id="6-1-固件升级"><a href="#6-1-固件升级" class="headerlink" title="6.1 固件升级"></a>6.1 固件升级</h2><h2 id="6-2-开发调试"><a href="#6-2-开发调试" class="headerlink" title="6.2 开发调试"></a>6.2 开发调试</h2><h1 id="7-电气特性"><a href="#7-电气特性" class="headerlink" title="7. 电气特性"></a>7. 电气特性</h1><h2 id="7-1-绝对最大值"><a href="#7-1-绝对最大值" class="headerlink" title="7.1 绝对最大值"></a>7.1 绝对最大值</h2><h2 id="7-2-推荐工作条件"><a href="#7-2-推荐工作条件" class="headerlink" title="7.2 推荐工作条件"></a>7.2 推荐工作条件</h2><h2 id="7-3-工作温度"><a href="#7-3-工作温度" class="headerlink" title="7.3 工作温度"></a>7.3 工作温度</h2><h2 id="7-4-射频参数"><a href="#7-4-射频参数" class="headerlink" title="7.4 射频参数"></a>7.4 射频参数</h2><h2 id="7-5-功耗"><a href="#7-5-功耗" class="headerlink" title="7.5 功耗"></a>7.5 功耗</h2><h1 id="8-存储和生产"><a href="#8-存储和生产" class="headerlink" title="8. 存储和生产"></a>8. 存储和生产</h1>
</article>

    <div class="pagenator post-pagenator">
    
    
        <a class="extend prev post-prev" href="/277/">上一篇</a>
    

    
    <p>上次更新 2021-01-28</p>
    
    
        <a class="extend next post-next" href="/731/">下一篇</a>
    
    </div>

    </div>
    <div class="footer">
        <div class="container">
    <div class="social">
	<ul class="social-list">
		
			
		
			
		
			
		
			
		
			
		
			
		
			
				
				<li>
					<a href="https://github.com/openluat" title="github" target="_self">
					<i class="fa fa-github"></i>
					</a>
				</li>
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	</ul>
</div>
    <div class="copyright">
        <span>
            
            
            
                © chenxuuu 2017 - 2021
            
        </span>
    </div>
    <div class="power">
        <span>
            Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/CaiChenghan/iLiKE">iLiKE Theme</a>
        </span>
    </div>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
    <!--page counter part-->
<script>
function addCount (Counter) {
    url=$('.article-date').attr('href').trim();
    title = $('.article-title').text().trim();
    var query = new AV.Query(Counter);
    //use url as unique idnetfication
    query.equalTo("url",url);
    query.find({
        success: function(results) {
            if (results.length>0) {
                var counter=results[0];
                counter.fetchWhenSave(true); //get recent result
                counter.increment("time");
                counter.save();
            } else {
                var newcounter=new Counter();
                newcounter.set("title",title);
                newcounter.set("url",url);
                newcounter.set("time",1);
                newcounter.save(null,{
                    success: function(newcounter) {
                        //alert('New object created');
                    }, error: function(newcounter,error) {
                        alert('Failed to create');
                    }
                })
            }
        },
        error: function(error) {
            //find null is not a error
            alert('Error:'+error.code+" "+error.message);
        }
    });
}
$(function() {
    var Counter=AV.Object.extend("Counter");
    //only increse visit counting when intering a page
    if ($('.article-title').length == 1) {
       addCount(Counter);
    }
    var query=new AV.Query(Counter);
    query.descending("time");
    // the sum of popular posts
    query.limit(10); 
    query.find({
        success: function(results) {
                for(var i=0;i<results.length;i++) {
                    var counter=results[i];
                    title=counter.get("title");
                    url=counter.get("url");
                    time=counter.get("time");
                    // add to the popularlist widget
                    showcontent=title+" ("+time+")";
                    //notice the "" in href
                    $('.popularlist').append('<li><a href="'+url+'">'+showcontent+'</a></li>');
                }
            },
        error: function(error) {
            alert("Error:"+error.code+" "+error.message);
        }
    });
});
</script>
</div>
    </div>
</body>
</html>
