<!DOCTYPE html>

<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <title>Air208在西安某地区连接服务器失败问题分析过程 [ Luat doc 社区文章静态页面 ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/iLiKE.css">
    
  
  
  
<meta name="generator" content="Hexo 5.3.0"></head>
<body>
    <div class="header">
        <div class="container">
    <div class="menu">
      <div class="menu-left">
        <a href="/">
          <img src="https://iot.openluat.com/assets/img/logo.jpg"></img>
        </a>
      </div>
      <div class="menu-right">
        
          
          
          
          
          
          
          <a href="/">首页</a>
        
          
          
          
          
          
          
          <a href="/archives">归档</a>
        
          
          
          
          
          
          
          <a href="">关于</a>
        
      </div>
    </div>
</div>
    </div>
    <div class="container">
        <h1 class="post-title">Air208在西安某地区连接服务器失败问题分析过程</h1>
<article class="post markdown-style">
  <pre><code>                        &lt;h2 style=&quot;text-align: center; font-family: &quot; helvetica=&quot;&quot; neue&quot;,=&quot;&quot; helvetica,=&quot;&quot; arial,=&quot;&quot; &quot;pingfang=&quot;&quot; sc&quot;,=&quot;&quot; &quot;hiragino=&quot;&quot; sans=&quot;&quot; gb&quot;,=&quot;&quot; &quot;wenquanyi=&quot;&quot; micro=&quot;&quot; hei&quot;,=&quot;&quot; &quot;microsoft=&quot;&quot; yahei&quot;,=&quot;&quot; sans-serif;=&quot;&quot; color:=&quot;&quot; rgb(0,=&quot;&quot; 0,=&quot;&quot; 0);&quot;=&quot;&quot;&gt;Air208在西安某地区连接服务器失败问题分析过程&lt;/h2&gt;&lt;p class=&quot;MsoListParagraph&quot; style=&quot;margin-left:21.0pt;text-indent:-21.0pt;
</code></pre>
<p>mso-char-indent-count:0;mso-list:l0 level1 lfo1”&gt;<!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-family:等线;mso-bidi-theme-font:
minor-fareast">一、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">问题描述<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp; &nbsp; &nbsp;</span></span><span style="font-size:12.0pt">西安某地区连接<span lang="EN-US" style="background-color: rgb(255, 255, 0);">TCP</span>服务器失败，重连两次均失败。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">当地<span lang="EN-US">CSQ</span>在<span lang="EN-US">15</span>左右<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">3.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">TCP</span><span style="font-size:12.0pt">服务器正常、<span lang="EN-US">SIM</span>卡无欠费。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">4.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">发送<span lang="EN-US">CIPSHUT</span>（去激活<span lang="EN-US">PDP</span>命令）后恢复正常<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-family:等线;mso-bidi-theme-font:
minor-fareast">二、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">协议分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l3 level1 lfo3"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">TCP</span><span style="font-size:12.0pt">层分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">连接<span lang="EN-US">TCP</span>服务器需要经过三次握手。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">从<span lang="EN-US">log</span>中看，当模块发出第一次握手信息后，未收到服务器发出的第二次握手信息，因此开始重发第一次握手信息。重发了<span lang="EN-US">6</span>次之后，始终未收到服务器的第二次握手信息，因此连接失败。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l3 level1 lfo3"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">RLC</span><span style="font-size:12.0pt">（无线链接路层）分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">TCP</span><span style="font-size:
12.0pt">层的数据到达协议栈后，需要经过<span lang="EN-US">RLC(</span>无线链接路层<span lang="EN-US">)</span>发送给基站。<span lang="EN-US">RLC</span>与<span lang="EN-US">TCP</span>层类似，同样有滑窗机制、确认机制。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">经过<span lang="EN-US">LOG</span>分析，<span lang="EN-US">RLC</span>上行数据成功发送给了基站，并且收到了基站的<span lang="EN-US">ACK</span>。也就是说<span style="color:red">基站成功的收到了<span lang="EN-US">RLC</span>完整、准确的数据包，而且模块也收到了基站</span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt"><span style="color:red">的确认数据。表明：模块与基站之间的信道通信是正常的。</span><span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l3 level1 lfo3"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">3.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">TBF</span><span style="font-size:12.0pt">分配情况分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">TBF</span><span style="font-size:
12.0pt">的意思是</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">Temporary Block Flow </span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">临时块流。</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">TBF</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">是</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">GPRS</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">通信中基站分配的信道资源的基本单位，所有</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">GPRS</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">通信都建立上</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">TBF</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">的基础之上。</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&lt;o:p&gt;</o:p></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">由<span lang="EN-US">RLC</span>层分析的结果来看，<span lang="EN-US">RLC</span>上行数据成功发送给了基站，表明上行<span lang="EN-US">TBF</span>没有任何问题，我们重点要关注下行<span lang="EN-US">TBF</span>的情况。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l1 level1 lfo4"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">1）&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">下行<span lang="EN-US">TBF</span>的分配触发机制<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">当核心网有下行<span lang="EN-US">GPRS</span>数据要发送给模块时，触发基站分配下行<span lang="EN-US">TBF</span>资源给模块。模块在这个过程中完全是被动的，无法参与其中的分配过程，因为无需和模块进行协商。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l1 level1 lfo4"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">2）&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">下行<span lang="EN-US">TBF</span>的两种分配方式</span></p><p class="MsoNormal"><br></p><p class="MsoNormal" style="text-indent:32.0pt;mso-char-indent-count:2.0;
line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">&nbsp; &nbsp; &nbsp; &nbsp;a.</span><span style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt">在<span lang="EN-US">CCCH</span>上建立下行<span lang="EN-US">TBF</span></span></p><p class="MsoNormal" style="text-indent:32.0pt;mso-char-indent-count:2.0;
line-height:150%"><img src="http://oldask.openluat.com/image/show/attachments-2019-08-GZL5hPy05d4b826dd99c0.png" class="img-responsive" style="width: 100%;"><span style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt"><span lang="EN-US"><br></span></span></p><p class="MsoNormal" style="text-indent:32.0pt;mso-char-indent-count:2.0;
line-height:150%"><span style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt"><span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt;mso-no-proof:yes">&lt;v:shapetype id=”_x0000_t75” coordsize=”21600,21600” o:spt=”75” o:preferrelative=”t” path=”m@4@5l@4@11@9@11@9@5xe” filled=”f” stroked=”f”&gt;<br> &lt;v:stroke joinstyle=”miter”&gt;<br> &lt;v:formulas&gt;<br>  &lt;v:f eqn=”if lineDrawn pixelLineWidth 0”&gt;<br>  &lt;v:f eqn=”sum @0 1 0”&gt;<br>  &lt;v:f eqn=”sum 0 0 @1”&gt;<br>  &lt;v:f eqn=”prod @2 1 2”&gt;<br>  &lt;v:f eqn=”prod @3 21600 pixelWidth”&gt;<br>  &lt;v:f eqn=”prod @3 21600 pixelHeight”&gt;<br>  &lt;v:f eqn=”sum @0 0 1”&gt;<br>  &lt;v:f eqn=”prod @6 1 2”&gt;<br>  &lt;v:f eqn=”prod @7 21600 pixelWidth”&gt;<br>  &lt;v:f eqn=”sum @8 21600 0”&gt;<br>  &lt;v:f eqn=”prod @7 21600 pixelHeight”&gt;<br>  &lt;v:f eqn=”sum @10 21600 0”&gt;<br> </v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:formulas><br> &lt;v:path o:extrusionok=”f” gradientshapeok=”t” o:connecttype=”rect”&gt;<br> &lt;o:lock v:ext=”edit” aspectratio=”t”&gt;<br></o:lock></v:path></v:stroke></v:shapetype>&lt;v:shape id=”图片_x0020_163” o:spid=”_x0000_i1028” type=”#_x0000_t75” style=”width:391.9pt;height:194.65pt;visibility:visible;mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI<del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image001.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 在没有上行<span lang="EN-US">TBF</span>存活的情况下，基站通过立即分配的的方式通知模块建立下行<span lang="EN-US">TBF</span>。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 在正常情况下，我们的模块能收到立即分配的指令，并正常建立下行<span lang="EN-US">TBF. </span>如下图所示。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" align="left"><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
mso-font-kerning:0pt;mso-no-proof:yes">&lt;v:shape id=”图片_x0020_195” o:spid=”_x0000_i1027” type=”#_x0000_t75” style=”width:415.5pt;height:96pt;visibility:visible;<br> mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI</del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;mso-font-kerning:0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span><span style="font-size: 12pt; letter-spacing: 2pt;">&nbsp;</span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><img src="http://oldask.openluat.com/image/show/attachments-2019-08-jtihFFeM5d4b825a6a979.png" class="img-responsive" style="width: 100%;"></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt">b. </span><span style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">在上行<span lang="EN-US">TBF</span>上进行下行<span lang="EN-US">TBF</span>的分配<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt;mso-no-proof:yes">&lt;v:shape id=”图片_x0020_193” o:spid=”_x0000_i1026” type=”#_x0000_t75” style=”width:390.4pt;height:202.9pt;visibility:visible;<br> mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI<del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image003.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span><img src="http://oldask.openluat.com/image/show/attachments-2019-08-Xnwro9XT5d4b8284908ea.png" class="img-responsive" style="width: 100%;"></p><p class="MsoNormal">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;在正常情况下，我们的模块能收到<span lang="EN-US">Downlink</span>分配的指令，并正常建立下行<span lang="EN-US">TBF. </span>如下图所示。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" align="left"><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
mso-font-kerning:0pt;mso-no-proof:yes">&lt;v:shape id=”图片_x0020_196” o:spid=”_x0000_i1025” type=”#_x0000_t75” style=”width:415.5pt;height:169.5pt;visibility:visible;<br> mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI</del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;mso-font-kerning:0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal" style="line-height:150%"><span lang="EN-US" style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span><img src="http://oldask.openluat.com/image/show/attachments-2019-08-ukHQtF0j5d4b828ad9ca9.png" class="img-responsive" style="width: 100%;"></p><p class="MsoNormal" style="line-height:150%"><br></p><p class="MsoNoSpacing">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp;而在<span lang="EN-US">TCP</span>服务器连接失败的情况下，我们并没有在<span lang="EN-US">LOG</span>中看到上述任意一种下行<span lang="EN-US">TBF</span>的分配。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNoSpacing">&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:<br>“ microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;三、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;综合分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;由此，我们可以确认，<span lang="EN-US">TCP</span>服务器连接失败的原因是没有收到任何下行<span lang="EN-US">TBF</span>的分配。可能性有以下几种：<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l5 level1 lfo5"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;TCP</span>&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;服务器没有响应。</span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l5 level1 lfo5"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;网关侧没有把<span lang="EN-US">TCP</span>服务器的下行数据发过来。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l5 level1 lfo5"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;3.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;基站侧没有足够的下行<span lang="EN-US">TBF</span>可以分配。<span lang="EN-US"><br><br></span><span style="color:red">结合发送<span lang="EN-US">CIPSHUT</span>（去激活<span lang="EN-US">PDP</span>命令）后恢复正常的情况来看，第<span lang="EN-US">2</span>点的可能性最大</span>。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" style="margin-left:21.0pt"><span lang="EN-US">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;四、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;结论<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;西安某地区连接服务器失败问题，我们分析结论如下：<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l2 level1 lfo6"><!--[if !supportLists]--><span lang="EN-US">1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;模块侧与基站的通信一切正常。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l2 level1 lfo6"><!--[if !supportLists]--><span lang="EN-US">2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;问题可能是因为网关侧的临时性故障。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]--><span lang="EN-US" style=""><font face="Microsoft YaHei UI Light, sans-serif"><span style="font-size: 12pt;">五、</span></font>&lt;span style=”font-family: “ times=”” new=”” roman”;=”” font-size:=”” 7pt;=”” font-variant-numeric:=”” normal;=”” font-variant-east-asian:=”” font-stretch:=”” line-height:=”” normal;”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: normal; font-size: 16px;"><font face="Microsoft YaHei UI Light, sans-serif">解决办法</font></span></span></p><p></p>
</p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt;font-family:" microsoft="" yahei="" ui="" light",sans-serif"="">在<span lang="EN-US">TCP</span>服务器连接失败后，发送<span lang="EN-US">AT+CIPSHUT</span>指令再重试。<span lang="EN-US"><o:p></o:p></span></span></p>
                        
</article>

    <div class="pagenator post-pagenator">
    
    
        <a class="extend prev post-prev" href="/602/">上一篇</a>
    

    
    <p>上次更新 2021-01-28</p>
    
    
        <a class="extend next post-next" href="/600/">下一篇</a>
    
    </div>

    </div>
    <div class="footer">
        <div class="container">
    <div class="social">
	<ul class="social-list">
		
			
		
			
		
			
		
			
		
			
		
			
		
			
				
				<li>
					<a href="https://github.com/openluat" title="github" target="_self">
					<i class="fa fa-github"></i>
					</a>
				</li>
			
		
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	</ul>
</div>
    <div class="copyright">
        <span>
            
            
            
                © 仅供搜索引擎收录使用 2017 - 2021
            
        </span>
    </div>
    <div class="power">
        <span>
            Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/CaiChenghan/iLiKE">iLiKE Theme</a>
        </span>
    </div>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
    <!--page counter part-->
<script>
function addCount (Counter) {
    url=$('.article-date').attr('href').trim();
    title = $('.article-title').text().trim();
    var query = new AV.Query(Counter);
    //use url as unique idnetfication
    query.equalTo("url",url);
    query.find({
        success: function(results) {
            if (results.length>0) {
                var counter=results[0];
                counter.fetchWhenSave(true); //get recent result
                counter.increment("time");
                counter.save();
            } else {
                var newcounter=new Counter();
                newcounter.set("title",title);
                newcounter.set("url",url);
                newcounter.set("time",1);
                newcounter.save(null,{
                    success: function(newcounter) {
                        //alert('New object created');
                    }, error: function(newcounter,error) {
                        alert('Failed to create');
                    }
                })
            }
        },
        error: function(error) {
            //find null is not a error
            alert('Error:'+error.code+" "+error.message);
        }
    });
}
$(function() {
    var Counter=AV.Object.extend("Counter");
    //only increse visit counting when intering a page
    if ($('.article-title').length == 1) {
       addCount(Counter);
    }
    var query=new AV.Query(Counter);
    query.descending("time");
    // the sum of popular posts
    query.limit(10); 
    query.find({
        success: function(results) {
                for(var i=0;i<results.length;i++) {
                    var counter=results[i];
                    title=counter.get("title");
                    url=counter.get("url");
                    time=counter.get("time");
                    // add to the popularlist widget
                    showcontent=title+" ("+time+")";
                    //notice the "" in href
                    $('.popularlist').append('<li><a href="'+url+'">'+showcontent+'</a></li>');
                }
            },
        error: function(error) {
            alert("Error:"+error.code+" "+error.message);
        }
    });
});
</script>
</div>
    </div>
</body>
</html>
