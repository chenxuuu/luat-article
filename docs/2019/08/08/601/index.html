<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Air208在西安某地区连接服务器失败问题分析过程 | Luat doc 社区文章静态页面镜像</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="&lt;h2 style&#x3D;&quot;text-align: center; font-family: &quot; helvetica&#x3D;&quot;&quot; neue&quot;,&#x3D;&quot;&quot; helvetica,&#x3D;&quot;&quot; arial,&#x3D;&quot;&quot; &quot;pingfang&#x3D;&quot;&amp;quo">
<meta property="og:type" content="article">
<meta property="og:title" content="Air208在西安某地区连接服务器失败问题分析过程">
<meta property="og:url" content="https://doc.luatos.wiki/2019/08/08/601/index.html">
<meta property="og:site_name" content="Luat doc 社区文章静态页面镜像">
<meta property="og:description" content="&lt;h2 style&#x3D;&quot;text-align: center; font-family: &quot; helvetica&#x3D;&quot;&quot; neue&quot;,&#x3D;&quot;&quot; helvetica,&#x3D;&quot;&quot; arial,&#x3D;&quot;&quot; &quot;pingfang&#x3D;&quot;&amp;quo">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://oldask.openluat.com/image/show/attachments-2019-08-GZL5hPy05d4b826dd99c0.png">
<meta property="og:image" content="http://oldask.openluat.com/image/show/attachments-2019-08-jtihFFeM5d4b825a6a979.png">
<meta property="og:image" content="http://oldask.openluat.com/image/show/attachments-2019-08-Xnwro9XT5d4b8284908ea.png">
<meta property="og:image" content="http://oldask.openluat.com/image/show/attachments-2019-08-ukHQtF0j5d4b828ad9ca9.png">
<meta property="article:published_time" content="2019-08-08T02:08:04.000Z">
<meta property="article:modified_time" content="2021-01-27T16:09:27.359Z">
<meta property="article:author" content="chenxuuu">
<meta property="article:tag" content="lua">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://oldask.openluat.com/image/show/attachments-2019-08-GZL5hPy05d4b826dd99c0.png">
  
    <link rel="alternate" href="/atom.xml" title="Luat doc 社区文章静态页面镜像" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Luat doc 社区文章静态页面镜像</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://doc.luatos.wiki"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-601" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2019/08/08/601/" class="article-date">
  <time class="dt-published" datetime="2019-08-08T02:08:04.000Z" itemprop="datePublished">2019-08-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="p-name article-title" itemprop="headline name">
      Air208在西安某地区连接服务器失败问题分析过程
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <pre><code>                        &lt;h2 style=&quot;text-align: center; font-family: &quot; helvetica=&quot;&quot; neue&quot;,=&quot;&quot; helvetica,=&quot;&quot; arial,=&quot;&quot; &quot;pingfang=&quot;&quot; sc&quot;,=&quot;&quot; &quot;hiragino=&quot;&quot; sans=&quot;&quot; gb&quot;,=&quot;&quot; &quot;wenquanyi=&quot;&quot; micro=&quot;&quot; hei&quot;,=&quot;&quot; &quot;microsoft=&quot;&quot; yahei&quot;,=&quot;&quot; sans-serif;=&quot;&quot; color:=&quot;&quot; rgb(0,=&quot;&quot; 0,=&quot;&quot; 0);&quot;=&quot;&quot;&gt;Air208在西安某地区连接服务器失败问题分析过程&lt;/h2&gt;&lt;p class=&quot;MsoListParagraph&quot; style=&quot;margin-left:21.0pt;text-indent:-21.0pt;
</code></pre>
<p>mso-char-indent-count:0;mso-list:l0 level1 lfo1”&gt;<!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-family:等线;mso-bidi-theme-font:
minor-fareast">一、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">问题描述<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp; &nbsp; &nbsp;</span></span><span style="font-size:12.0pt">西安某地区连接<span lang="EN-US" style="background-color: rgb(255, 255, 0);">TCP</span>服务器失败，重连两次均失败。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">当地<span lang="EN-US">CSQ</span>在<span lang="EN-US">15</span>左右<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">3.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">TCP</span><span style="font-size:12.0pt">服务器正常、<span lang="EN-US">SIM</span>卡无欠费。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l4 level1 lfo2"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">4.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">发送<span lang="EN-US">CIPSHUT</span>（去激活<span lang="EN-US">PDP</span>命令）后恢复正常<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-family:等线;mso-bidi-theme-font:
minor-fareast">二、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">协议分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l3 level1 lfo3"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">TCP</span><span style="font-size:12.0pt">层分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">连接<span lang="EN-US">TCP</span>服务器需要经过三次握手。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">从<span lang="EN-US">log</span>中看，当模块发出第一次握手信息后，未收到服务器发出的第二次握手信息，因此开始重发第一次握手信息。重发了<span lang="EN-US">6</span>次之后，始终未收到服务器的第二次握手信息，因此连接失败。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l3 level1 lfo3"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">RLC</span><span style="font-size:12.0pt">（无线链接路层）分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">TCP</span><span style="font-size:
12.0pt">层的数据到达协议栈后，需要经过<span lang="EN-US">RLC(</span>无线链接路层<span lang="EN-US">)</span>发送给基站。<span lang="EN-US">RLC</span>与<span lang="EN-US">TCP</span>层类似，同样有滑窗机制、确认机制。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">经过<span lang="EN-US">LOG</span>分析，<span lang="EN-US">RLC</span>上行数据成功发送给了基站，并且收到了基站的<span lang="EN-US">ACK</span>。也就是说<span style="color:red">基站成功的收到了<span lang="EN-US">RLC</span>完整、准确的数据包，而且模块也收到了基站</span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt"><span style="color:red">的确认数据。表明：模块与基站之间的信道通信是正常的。</span><span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l3 level1 lfo3"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">3.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]--><span lang="EN-US" style="font-size:12.0pt">TBF</span><span style="font-size:12.0pt">分配情况分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">TBF</span><span style="font-size:
12.0pt">的意思是</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">Temporary Block Flow </span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">临时块流。</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">TBF</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">是</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">GPRS</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">通信中基站分配的信道资源的基本单位，所有</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">GPRS</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">通信都建立上</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">TBF</span><span style="font-size: 12pt; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">的基础之上。</span><span lang="EN-US" style="font-size: 12pt; font-family: Arial, sans-serif; color: rgb(51, 51, 51); background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">&lt;o:p&gt;</o:p></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">由<span lang="EN-US">RLC</span>层分析的结果来看，<span lang="EN-US">RLC</span>上行数据成功发送给了基站，表明上行<span lang="EN-US">TBF</span>没有任何问题，我们重点要关注下行<span lang="EN-US">TBF</span>的情况。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l1 level1 lfo4"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">1）&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">下行<span lang="EN-US">TBF</span>的分配触发机制<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt">当核心网有下行<span lang="EN-US">GPRS</span>数据要发送给模块时，触发基站分配下行<span lang="EN-US">TBF</span>资源给模块。模块在这个过程中完全是被动的，无法参与其中的分配过程，因为无需和模块进行协商。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:0cm;mso-char-indent-count:
0"><span lang="EN-US" style="font-size:12.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:57.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l1 level1 lfo4"><!--[if !supportLists]--><span lang="EN-US" style="font-size:12.0pt;mso-fareast-font-family:等线;mso-fareast-theme-font:
minor-latin;mso-bidi-font-family:等线;mso-bidi-theme-font:minor-latin">2）&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;<br></span></span><!--[endif]--><span style="font-size:12.0pt">下行<span lang="EN-US">TBF</span>的两种分配方式</span></p><p class="MsoNormal"><br></p><p class="MsoNormal" style="text-indent:32.0pt;mso-char-indent-count:2.0;
line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">&nbsp; &nbsp; &nbsp; &nbsp;a.</span><span style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt">在<span lang="EN-US">CCCH</span>上建立下行<span lang="EN-US">TBF</span></span></p><p class="MsoNormal" style="text-indent:32.0pt;mso-char-indent-count:2.0;
line-height:150%"><img src="http://oldask.openluat.com/image/show/attachments-2019-08-GZL5hPy05d4b826dd99c0.png" class="img-responsive" style="width: 100%;"><span style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt"><span lang="EN-US"><br></span></span></p><p class="MsoNormal" style="text-indent:32.0pt;mso-char-indent-count:2.0;
line-height:150%"><span style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt"><span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt;mso-no-proof:yes">&lt;v:shapetype id=”_x0000_t75” coordsize=”21600,21600” o:spt=”75” o:preferrelative=”t” path=”m@4@5l@4@11@9@11@9@5xe” filled=”f” stroked=”f”&gt;<br> &lt;v:stroke joinstyle=”miter”&gt;<br> &lt;v:formulas&gt;<br>  &lt;v:f eqn=”if lineDrawn pixelLineWidth 0”&gt;<br>  &lt;v:f eqn=”sum @0 1 0”&gt;<br>  &lt;v:f eqn=”sum 0 0 @1”&gt;<br>  &lt;v:f eqn=”prod @2 1 2”&gt;<br>  &lt;v:f eqn=”prod @3 21600 pixelWidth”&gt;<br>  &lt;v:f eqn=”prod @3 21600 pixelHeight”&gt;<br>  &lt;v:f eqn=”sum @0 0 1”&gt;<br>  &lt;v:f eqn=”prod @6 1 2”&gt;<br>  &lt;v:f eqn=”prod @7 21600 pixelWidth”&gt;<br>  &lt;v:f eqn=”sum @8 21600 0”&gt;<br>  &lt;v:f eqn=”prod @7 21600 pixelHeight”&gt;<br>  &lt;v:f eqn=”sum @10 21600 0”&gt;<br> </v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:f></v:formulas><br> &lt;v:path o:extrusionok=”f” gradientshapeok=”t” o:connecttype=”rect”&gt;<br> &lt;o:lock v:ext=”edit” aspectratio=”t”&gt;<br></o:lock></v:path></v:stroke></v:shapetype>&lt;v:shape id=”图片_x0020_163” o:spid=”_x0000_i1028” type=”#_x0000_t75” style=”width:391.9pt;height:194.65pt;visibility:visible;mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI<del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image001.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 在没有上行<span lang="EN-US">TBF</span>存活的情况下，基站通过立即分配的的方式通知模块建立下行<span lang="EN-US">TBF</span>。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 在正常情况下，我们的模块能收到立即分配的指令，并正常建立下行<span lang="EN-US">TBF. </span>如下图所示。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" align="left"><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
mso-font-kerning:0pt;mso-no-proof:yes">&lt;v:shape id=”图片_x0020_195” o:spid=”_x0000_i1027” type=”#_x0000_t75” style=”width:415.5pt;height:96pt;visibility:visible;<br> mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI</del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image002.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;mso-font-kerning:0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span><span style="font-size: 12pt; letter-spacing: 2pt;">&nbsp;</span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><img src="http://oldask.openluat.com/image/show/attachments-2019-08-jtihFFeM5d4b825a6a979.png" class="img-responsive" style="width: 100%;"></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt">b. </span><span style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">在上行<span lang="EN-US">TBF</span>上进行下行<span lang="EN-US">TBF</span>的分配<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;
letter-spacing:2.0pt;mso-no-proof:yes">&lt;v:shape id=”图片_x0020_193” o:spid=”_x0000_i1026” type=”#_x0000_t75” style=”width:390.4pt;height:202.9pt;visibility:visible;<br> mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI<del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image003.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;mso-bidi-font-size:
11.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal" style="margin-left:42.0pt;line-height:150%"><span lang="EN-US" style="font-size:12.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span><img src="http://oldask.openluat.com/image/show/attachments-2019-08-Xnwro9XT5d4b8284908ea.png" class="img-responsive" style="width: 100%;"></p><p class="MsoNormal">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;在正常情况下，我们的模块能收到<span lang="EN-US">Downlink</span>分配的指令，并正常建立下行<span lang="EN-US">TBF. </span>如下图所示。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" align="left"><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;mso-bidi-font-family:宋体;
mso-font-kerning:0pt;mso-no-proof:yes">&lt;v:shape id=”图片_x0020_196” o:spid=”_x0000_i1025” type=”#_x0000_t75” style=”width:415.5pt;height:169.5pt;visibility:visible;<br> mso-wrap-style:square”&gt;<br> &lt;v:imagedata src=”file:///C:/Users/ADMINI</del>1/AppData/Local/Temp/msohtmlclip1/01/clip_image004.png” o:title=””&gt;<br></v:imagedata></v:shape></span><span lang="EN-US" style="font-size:12.0pt;font-family:宋体;
mso-bidi-font-family:宋体;mso-font-kerning:0pt">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal" style="line-height:150%"><span lang="EN-US" style="font-size:
12.0pt;mso-bidi-font-size:11.0pt;line-height:150%;letter-spacing:2.0pt">&lt;o:p&gt;&nbsp;</o:p></span><img src="http://oldask.openluat.com/image/show/attachments-2019-08-ukHQtF0j5d4b828ad9ca9.png" class="img-responsive" style="width: 100%;"></p><p class="MsoNormal" style="line-height:150%"><br></p><p class="MsoNoSpacing">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp;而在<span lang="EN-US">TCP</span>服务器连接失败的情况下，我们并没有在<span lang="EN-US">LOG</span>中看到上述任意一种下行<span lang="EN-US">TBF</span>的分配。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNoSpacing">&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:<br>“ microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;三、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;综合分析<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;由此，我们可以确认，<span lang="EN-US">TCP</span>服务器连接失败的原因是没有收到任何下行<span lang="EN-US">TBF</span>的分配。可能性有以下几种：<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l5 level1 lfo5"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;TCP</span>&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;服务器没有响应。</span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l5 level1 lfo5"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;网关侧没有把<span lang="EN-US">TCP</span>服务器的下行数据发过来。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l5 level1 lfo5"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;3.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp; </span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;基站侧没有足够的下行<span lang="EN-US">TBF</span>可以分配。<span lang="EN-US"><br><br></span><span style="color:red">结合发送<span lang="EN-US">CIPSHUT</span>（去激活<span lang="EN-US">PDP</span>命令）后恢复正常的情况来看，第<span lang="EN-US">2</span>点的可能性最大</span>。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoNormal" style="margin-left:21.0pt"><span lang="EN-US">&nbsp;</span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]-->&lt;span lang=”EN-US” style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif;=”” mso-bidi-font-family:”microsoft=”” light””=””&gt;四、&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;结论<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0">&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;西安某地区连接服务器失败问题，我们分析结论如下：<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l2 level1 lfo6"><!--[if !supportLists]--><span lang="EN-US">1.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;模块侧与基站的通信一切正常。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:39.0pt;text-indent:-18.0pt;
mso-char-indent-count:0;mso-list:l2 level1 lfo6"><!--[if !supportLists]--><span lang="EN-US">2.&lt;span style=”font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; font-size: 7pt; line-height: normal; font-family: “ times=”” new=”” roman”;”=””&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br></span></span><!--[endif]-->&lt;span style=”font-size:12.0pt;font-family:” microsoft=”” yahei=”” ui=”” light”,sans-serif”=””&gt;问题可能是因为网关侧的临时性故障。<span lang="EN-US">&lt;o:p&gt;</o:p></span></span></p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:-21.0pt;
mso-char-indent-count:0;mso-list:l0 level1 lfo1"><!--[if !supportLists]--><span lang="EN-US" style=""><font face="Microsoft YaHei UI Light, sans-serif"><span style="font-size: 12pt;">五、</span></font>&lt;span style=”font-family: “ times=”” new=”” roman”;=”” font-size:=”” 7pt;=”” font-variant-numeric:=”” normal;=”” font-variant-east-asian:=”” font-stretch:=”” line-height:=”” normal;”=””&gt;&nbsp; &nbsp; &nbsp; &nbsp; </span><span style="font-variant-numeric: normal; font-variant-east-asian: normal; font-stretch: normal; line-height: normal; font-size: 16px;"><font face="Microsoft YaHei UI Light, sans-serif">解决办法</font></span></span></p><p></p>
</p><p class="MsoListParagraph" style="margin-left:21.0pt;text-indent:0cm;mso-char-indent-count:
0"><span style="font-size:12.0pt;font-family:" microsoft="" yahei="" ui="" light",sans-serif"="">在<span lang="EN-US">TCP</span>服务器连接失败后，发送<span lang="EN-US">AT+CIPSHUT</span>指令再重试。<span lang="EN-US"><o:p></o:p></span></span></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://doc.luatos.wiki/2019/08/08/601/" data-id="ckkfmdgei00dcvkcg9pxufd0c" data-title="Air208在西安某地区连接服务器失败问题分析过程" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/08/08/602/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">前一篇</strong>
      <div class="article-nav-title">
        
          4G模块Lua版本如何使用合宙服务器远程升级
        
      </div>
    </a>
  
  
    <a href="/2019/08/06/600/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">后一篇</strong>
      <div class="article-nav-title">Air系列模块同步时间功能汇总</div>
    </a>
  
</nav>

  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2032/01/">一月 2032</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/12/">十二月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/12/">十二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/11/">十一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/10/">十月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/09/">九月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/08/">八月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/07/">七月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/06/">六月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/05/">五月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/04/">四月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/03/">三月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/02/">二月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2020/01/">一月 2020</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">十二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/11/">十一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2032/01/01/608/">【置顶】合宙模块资料汇总</a>
          </li>
        
          <li>
            <a href="/2022/12/31/638/">Air系列模块常见问题列表</a>
          </li>
        
          <li>
            <a href="/2021/01/27/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2021/01/27/2420/">ECMAScript(ES6)基本语法介绍（一）</a>
          </li>
        
          <li>
            <a href="/2021/01/26/2417/">Air720S系列_luat二次开发固件（ 底层软件+上层脚本）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 chenxuuu<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>