<!DOCTYPE html>

<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">

  <title>Luat Air720S系列模块_CMUX_使用说明 [ Luat doc 社区文章静态页面 ]</title>

    <!-- stylesheets list from config.yml -->

      <link rel="stylesheet" href="/css/iLiKE.css">




<meta name="generator" content="Hexo 5.3.0"></head>
<body>
    <div class="header">
        <div class="container">
    <div class="menu">
      <div class="menu-left">
        <a href="/">
          <img src="https://iot.openluat.com/assets/img/logo.jpg"></img>
        </a>
      </div>
      <div class="menu-right">







          <a href="/">首页</a>







          <a href="/archives">归档</a>







          <a href="https://luatdoc.papapoi.com/wiki/">关于</a>

      </div>
    </div>
</div>
    </div>
    <div class="container">
        <h1 class="post-title">Luat Air720S系列模块_CMUX_使用说明</h1>
<article class="post markdown-style">
  <pre><code>                        &lt;pre&gt;&lt;span style=&quot;font-weight: 700;&quot;&gt;&lt;span style=&quot;font-family: 宋体; font-size: 22pt;&quot;&gt;1.&lt;/span&gt;&lt;/span&gt;&lt;b style=&quot;color: inherit; font-family: inherit;&quot;&gt;&lt;span style=&quot;font-family: 宋体; font-size: 22pt;&quot;&gt;&lt;font face=&quot;宋体&quot;&gt;启动&lt;/font&gt;CMUX&lt;font face=&quot;宋体&quot;&gt;模式&lt;/font&gt;&lt;/span&gt;&lt;/b&gt;&lt;/pre&gt;&lt;p class=&quot;MsoNormal&quot;&gt;&lt;span style=&quot;font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;&quot;&gt;&lt;font face=&quot;宋体&quot;&gt;通常模块发送&lt;/font&gt;AT＋CMUX命令来激活多路复用，该命令格式为：&lt;/span&gt;&lt;span style=&quot;font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;&quot;&gt;&lt;o:p&gt;&lt;/o:p&gt;&lt;/span&gt;&lt;/p&gt;&lt;table class=&quot;MsoNormalTable&quot; border=&quot;1&quot; cellspacing=&quot;0&quot; style=&quot;width: 489.05pt; margin-left: 5.4pt; border: none;&quot;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td width=&quot;94&quot; valign=&quot;top&quot; style=&quot;width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(178,161,199);
</code></pre>
<p>mso-border-left-alt:0.5000pt solid rgb(178,161,199);border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);<br>border-top:1.0000pt solid rgb(178,161,199);mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);<br>mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);background:rgb(192,192,192);”&gt;<p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;">命令类型</span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;</o:p></span></p></td><td width="283" valign="top" style="width:170.1000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:1.0000pt solid rgb(178,161,199);mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);background:rgb(192,192,192);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;">语法</span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;</o:p></span></p></td><td width="437" valign="top" style="width:262.2500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:1.0000pt solid rgb(178,161,199);mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);background:rgb(192,192,192);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;">返回</span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(178,161,199);
mso-border-left-alt:0.5000pt solid rgb(178,161,199);border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">设置命令</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="283" valign="center" style="width:170.1000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:宋体;font-size:9.0000pt;">AT+CMUX= </span><span style="font-family: Verdana; font-size: 9pt;">[<mode>[,<subset>[,<port_speed>[,<n1>[,<t1>[,<n2>[,<t2>[,<t3>[,<k>]]]]]]]]]</k></t3></t2></n2></t1></n1></port_speed></subset></mode></span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:宋体;
font-size:9.0000pt;">&lt;o:p&gt;&nbsp;</o:p></span></p></td><td width="437" valign="center" style="width:262.2500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal" style="margin-right:47.2500pt;mso-layout-grid-align:none;text-autospace:none;"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:宋体;font-size:9.0000pt;">OK</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:宋体;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(178,161,199);
mso-border-left-alt:0.5000pt solid rgb(178,161,199);border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:宋体;font-size:9.0000pt;">查询命令</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:宋体;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="283" valign="center" style="width:170.1000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:宋体;font-size:9.0000pt;">AT+CMUX?</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:宋体;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="437" valign="center" style="width:262.2500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">+CMUX:[<mode>[,<subset>[,<port_speed>[,<n1>[,<t1>[,<n2>[,<t2>[,<t3>[,<k>]]]]]]]]]</k></t3></t2></n2></t1></n1></port_speed></subset></mode></span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:Arial;font-size:9.0000pt;">OK</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(178,161,199);
mso-border-left-alt:0.5000pt solid rgb(178,161,199);border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:宋体;font-size:9.0000pt;">测试命令</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:宋体;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="283" valign="center" style="width:170.1000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:宋体;font-size:9.0000pt;">AT+CMUX=?</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:宋体;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="437" valign="center" style="width:262.2500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(178,161,199);mso-border-right-alt:0.5000pt solid rgb(178,161,199);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(178,161,199);border-bottom:1.0000pt solid rgb(178,161,199);
mso-border-bottom-alt:0.5000pt solid rgb(178,161,199);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">+CMUX:(<mode>),(<subset>s),( <port_speed>s),(<n1>s),(<t1>s),</t1></n1></port_speed></subset></mode></span><span style="font-family: Verdana; font-size: 9pt;">(<n2>s),(<t2>s),(<t3>s),(<k>s)&nbsp; </k></t3></t2></n2></span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal" style="margin-right:47.2500pt;mso-layout-grid-align:none;text-autospace:none;"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">OK</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td></tr></tbody></table><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;">&nbsp;</span></p><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;"><font face="宋体">参数定义：</font></span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;<br></o:p></span></p><table class="MsoNormalTable" border="1" cellspacing="0" style="width: 489.05pt; margin-left: 5.4pt; border: none;"><tbody><tr><td width="127" valign="top" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(217,149,148);
mso-border-left-alt:0.5000pt solid rgb(217,149,148);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:1.0000pt solid rgb(217,149,148);mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(229,184,183);
mso-border-bottom-alt:0.5000pt solid rgb(229,184,183);background:rgb(192,192,192);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;">参数</span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="top" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:1.0000pt solid rgb(217,149,148);mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);background:rgb(192,192,192);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;">定义</span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="top" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:1.0000pt solid rgb(217,149,148);mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);background:rgb(192,192,192);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9.5pt;">取值</span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="top" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:1.0000pt solid rgb(217,149,148);mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);background:rgb(192,192,192);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">对取值的说明</span><span style="font-family: Verdana; font-size: 9.5pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:11.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><mode></mode></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: 宋体; font-size: 9pt;">复用透传机制</span><span style="font-family:Calibri;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:宋体;mso-ascii-font-family:Verdana;mso-hansi-font-family:Verdana;
mso-bidi-font-family:Arial;font-size:9.0000pt;">0</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: 宋体; font-size: 9pt;">基本选择</span><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Verdana;
mso-hansi-font-family:Verdana;mso-bidi-font-family:'Times New RomanPSMT';color:rgb(112,48,160);
font-size:9.0000pt;">{gw<font face="宋体">：这里改成基本模式更合适些吧</font><font face="Verdana">}</font></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:11.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><subset></subset></span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: 宋体; font-size: 9pt;">控制通道的复用器建立的方式</span><span style="font-family:Calibri;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:宋体;mso-ascii-font-family:Verdana;mso-hansi-font-family:Verdana;
mso-bidi-font-family:Arial;font-size:9.0000pt;">0</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: 宋体; font-size: 9pt;">仅使用</span><span style="font-family: Verdana; font-size: 9pt;">UIH </span><span style="font-family: Verdana; font-size: 9pt;">包</span><span style="font-family: 宋体; font-size: 9pt;">文</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:2.1000pt;"><td width="127" valign="center" rowspan="7" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><port_speed></port_speed></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" rowspan="7" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:none;border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">传输速率，单位为</span><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:Arial;font-size:9.0000pt;">bits/s</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">1</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:Arial;font-size:9.0000pt;">9600 </span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:1.9500pt;"><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">2</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">19200</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:1.9500pt;"><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">3</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">38400</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:1.9500pt;"><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">4</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">57600</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:1.9500pt;"><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><u><span style="font-family: Verdana; font-size: 9pt;">5</span></u><u><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></u></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">115200</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:1.9500pt;"><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">6</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">230400</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:1.9500pt;"><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">7</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:Arial;
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">460800</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:11.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><n1></n1></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">最大报文大小</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">1<del></span><span style="font-family: 宋体; font-size: 9pt;">255</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">默认：</span><span style="font-family: 宋体; font-size: 9pt;">127</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:11.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><t1></t1></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">接收</span><span style="font-family: Verdana; font-size: 9pt;">timer</span><span style="font-family: Verdana; font-size: 9pt;">，</span><span style="font-family: Verdana; font-size: 9pt;">以</span><span style="font-family: Verdana; font-size: 9pt;">10ms</span><span style="font-family: Verdana; font-size: 9pt;">为单位</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">1-255</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">默认：</span><span style="font-family: 宋体; font-size: 9pt;">1</span><span style="font-family: Verdana; font-size: 9pt;">0(</span><span style="font-family: 宋体; font-size: 9pt;">1</span><span style="font-family: Verdana; font-size: 9pt;">00 </span><span style="font-family: Verdana; font-size: 9pt;">ms)</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:11.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><n2></n2></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">重传的最大数量</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">0-100</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">默认：<font face="Verdana">3</font></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:11.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><t2></t2></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">复用器控制通道的响应定时器，以</span><span style="font-family: Verdana; font-size: 9pt;">10ms </span><span style="font-family: Verdana; font-size: 9pt;">为单位</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">2-255</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">默认：</span><span style="font-family: 宋体; font-size: 9pt;">3</span><span style="font-family: Verdana; font-size: 9pt;">0</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:29.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><t3></t3></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">唤醒响应定时器，以秒为单位</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">1-255</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">默认：</span><span style="font-family: Verdana; font-size: 9pt;">10</span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:11.6500pt;"><td width="127" valign="center" style="width:76.4000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(229,184,183);
mso-border-left-alt:0.5000pt solid rgb(229,184,183);border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;"><k></k></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="215" valign="center" style="width:129.1500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">窗口大小，适用于有错误恢复选项的高级操作</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="94" valign="center" style="width:56.7000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">1-7</span><span style="font-family:Verdana;mso-fareast-font-family:宋体;mso-bidi-font-family:'Times New Roman';
font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="378" valign="center" style="width:226.8000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(217,149,148);mso-border-right-alt:0.5000pt solid rgb(217,149,148);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(217,149,148);border-bottom:1.0000pt solid rgb(217,149,148);
mso-border-bottom-alt:0.5000pt solid rgb(217,149,148);"><p class="MsoNormal"><span style="font-family: Verdana; font-size: 9pt;">默认：<font face="Verdana">2</font></span><span style="font-family: Verdana; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr></tbody></table><p class="MsoNormal"><b style="color: inherit; font-family: inherit; font-size: 36px;"><span style="font-family: 宋体; font-size: 22pt;"><br></span></b></p><p class="MsoNormal"><b style="color: inherit; font-family: inherit; font-size: 36px;"><span style="font-family: 宋体; font-size: 22pt;">2.CMUX <font face="宋体">帧结构</font></span></b><span style="color: inherit; font-family: inherit; font-size: 36px;">&nbsp;</span></p><p class="MsoNormal" style="text-indent:21.0000pt;"><span style="font-family: 宋体; color: rgb(77, 77, 77); font-size: 12pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="宋体">多路复用有三种操作模式：基本模式、带错误恢复功能的高级模式、不带错误恢复功能的高级模式（具体可以参见</font>GSM 07.10协议）。不同的GPRS模块也支持不同的模式。</span><span style="mso-spacerun:'yes';font-family:宋体;font-size:12.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;&nbsp;</o:p></span><img src="https://oldask.openluat.com/image/show/attachments-2020-05-jqOnbE7k5eb52b1ae9e4e.png" class="img-responsive" style="width: 100%;"></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体">其中，帧类型可分控制帧和信息帧。</font> </span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">CMUX<font face="宋体">双方通过控制帧协商用以构建、拆除虚拟链路，控制帧又为以下几种： </font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">SABM<font face="宋体">：建立</font><font face="Calibri">DLC </font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">UA<font face="宋体">：响应</font><font face="Calibri">SABM</font><font face="宋体">帧或</font><font face="Calibri">DISC</font><font face="宋体">帧 </font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">DM<font face="宋体">：链路未成功建立时，对收到的</font><font face="Calibri">DISC</font><font face="宋体">命令的响应 </font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">DISC<font face="宋体">：通知对端拆除链接，在</font><font face="Calibri">DLC0</font><font face="宋体">发送</font><font face="Calibri">DISC</font><font face="宋体">帧，等于退出</font><font face="Calibri">MUX</font><font face="宋体">功能</font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体">信息帧：</font> </span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">UIH\UI\I<font face="宋体">：这三种是信息帧，也就是携带要传输数据的帧。</font></span></p><h1><b><span style="font-family: 宋体; font-size: 22pt;">3.LINUX<font face="宋体">下的</font><font face="Calibri">CMUX</font><font face="宋体">使用</font></span></b></h1><h2><b><span style="font-family: 宋体; font-size: 12pt;">3.1</span></b><b><span style="font-family: 宋体; font-size: 12pt;">&nbsp;</span></b><b><span style="font-family: 宋体; font-size: 12pt;"><font face="宋体">挂载</font>USB设备</span></b><b><span style="font-family: 宋体; font-size: 12pt;">&lt;o:p&gt;</o:p></span></b></h2><h1><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体">在可移动设备，勾选</font>QinHeng USB2.0-Serial</span></p><p class="MsoNormal"><img src="https://oldask.openluat.com/image/show/attachments-2020-05-5VIS8lfP5eb52ba496cd8.png" class="img-responsive" style="width: 100%;"><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体">然后打开终端控制台，</font>ls /dev/ttyUSB*<font face="宋体">查看</font><font face="Calibri">USB</font><font face="宋体">设备，如下表示挂载成功。</font></span></p><p class="MsoNormal"><img src="https://oldask.openluat.com/image/show/attachments-2020-05-pwEwBNlC5eb52bc0eda9b.png" class="img-responsive" style="width: 100%;"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体"><br></font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><b><span style="font-family: Calibri; font-size: 22pt;">&lt;o:p&gt;</o:p></span></b></h1><h2><a name="_Toc15470"></a><b><span style="font-family: 宋体; font-size: 12pt;">3.2 CMUX虚拟串口生成</span></b><b><span style="font-family: 宋体; font-size: 12pt;">&lt;o:p&gt;</o:p></span></b></h2><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体">参考用例：</font></span><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/latest/driver-api/serial/n_gsm.html">https://www.kernel.org/doc/html/latest/driver-api/serial/n_gsm.html</a><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/latest/driver-api/serial/n_gsm.html"><u><span class="16" style="font-family: 宋体; color: rgb(0, 0, 255);"></span></u></a></p><p class="MsoNormal"><a target="_blank" rel="noopener" href="https://www.kernel.org/doc/html/latest/driver-api/serial/n_gsm.html"><u><span class="16" style="font-family: 宋体; color: rgb(0, 0, 255);"><br></span></u></a></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;">3.2.1</span><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;">&nbsp;</span><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;"><font face="宋体">测试实例</font>gsmmux.h源代码</span></p><pre><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">#ifndef _LINUX_GSMMUX_H</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">#define _LINUX_GSMMUX_H</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">struct gsm_config</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">{</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int adaption;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int encapsulation;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int initiator;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int t1;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int t2;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int t3;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int n2;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int mru;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int mtu;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int k;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int i;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int unused[8];</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/* Padding for expansion without</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">&nbsp;&nbsp;&nbsp;breaking stuff <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">};</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">#define GSMIOC_GETCONF</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">_IOR('G', 0, struct gsm_config)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">#define GSMIOC_SETCONF</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">_IOW('G', 1, struct gsm_config)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">struct gsm_netconfig {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned int adaption; &nbsp;/</em> Adaption to use in network mode <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned short protocol;/</em> Protocol to use - only ETH_P_IP supported <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">unsigned short unused2;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char if_name[IFNAMSIZ];</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">/</em> interface name format string <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">__u8 unused[28]; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/</em> For future use <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">};</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">#define GSMIOC_ENABLE_NET &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;_IOW('G', 2, struct gsm_netconfig)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">#define GSMIOC_DISABLE_NET &nbsp;&nbsp;&nbsp;&nbsp;_IO('G', 3)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal" style="color: rgb(0, 0, 0); font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; font-size: 14px; white-space: normal;"><span style="font-family: 宋体; font-size: 11pt;">#endif</span></p></pre><h3><b><span style="font-family: 宋体; font-size: 11pt;">3.2.2</span></b><b><span style="font-family: Calibri; font-size: 11pt;">&nbsp;</span></b><b><span style="font-family: 宋体; font-size: 11pt;"><font face="宋体">测试实例</font>cmux</span></b><b><span style="font-family: 宋体; font-size: 11pt;">.</span></b><b><span style="font-family: 宋体; font-size: 11pt;">c</span></b><b><span style="font-family: 宋体; font-size: 11pt;">&nbsp;</span></b><b><span style="font-family: 宋体; font-size: 11pt;"><font face="宋体">源代码</font></span></b></h3><pre><h3 style="font-family: &quot;Helvetica Neue&quot;, Helvetica, Arial, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;WenQuanYi Micro Hei&quot;, &quot;Microsoft Yahei&quot;, sans-serif; color: rgb(0, 0, 0); white-space: normal;"><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#</span><span style="font-family: 宋体; font-size: 11pt;">include</span><span style="font-family: 宋体; font-size: 11pt;">&nbsp;&lt;</span><span style="font-family: 宋体; font-size: 11pt;">stdlib</span><span style="font-family: 宋体; font-size: 11pt;">.</span><span style="font-family: 宋体; font-size: 11pt;">h</span><span style="font-family: 宋体; font-size: 11pt;">&gt;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#</span><span style="font-family: 宋体; font-size: 11pt;">include</span><span style="font-family: 宋体; font-size: 11pt;">&nbsp;&lt;</span><span style="font-family: 宋体; font-size: 11pt;">stdio</span><span style="font-family: 宋体; font-size: 11pt;">.</span><span style="font-family: 宋体; font-size: 11pt;">h</span><span style="font-family: 宋体; font-size: 11pt;">&gt;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#</span><span style="font-family: 宋体; font-size: 11pt;">include</span><span style="font-family: 宋体; font-size: 11pt;">&nbsp;&lt;</span><span style="font-family: 宋体; font-size: 11pt;">stdarg</span><span style="font-family: 宋体; font-size: 11pt;">.</span><span style="font-family: 宋体; font-size: 11pt;">h</span><span style="font-family: 宋体; font-size: 11pt;">&gt;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#</span><span style="font-family: 宋体; font-size: 11pt;">include</span><span style="font-family: 宋体; font-size: 11pt;">&nbsp;&lt;</span><span style="font-family: 宋体; font-size: 11pt;">string</span><span style="font-family: 宋体; font-size: 11pt;">.</span><span style="font-family: 宋体; font-size: 11pt;">h</span><span style="font-family: 宋体; font-size: 11pt;">&gt;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#</span><span style="font-family: 宋体; font-size: 11pt;">include</span><span style="font-family: 宋体; font-size: 11pt;">&nbsp;&lt;</span><span style="font-family: 宋体; font-size: 11pt;">sys</span><span style="font-family: 宋体; font-size: 11pt;">/</span><span style="font-family: 宋体; font-size: 11pt;">ioctl</span><span style="font-family: 宋体; font-size: 11pt;">.</span><span style="font-family: 宋体; font-size: 11pt;">h</span><span style="font-family: 宋体; font-size: 11pt;">&gt;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<fcntl.h></fcntl.h></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<termios.h></termios.h></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<net if.h=""></net></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<linux types.h=""></linux></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<sys types.h=""></sys></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<sys stat.h=""></sys></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<fcntl.h></fcntl.h></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<unistd.h></unistd.h></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<err.h></err.h></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<signal.h></signal.h></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include<errno.h></errno.h></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/**</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">gsmmux.h provides n_gsm line dicipline structures and functions.</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">It should be kept in sync with your kernel release.</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#include "gsmmux.h"</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/* n_gsm ioctl <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#ifndef N_GSM0710</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"># define N_GSM0710</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">21</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#endif</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em> attach a line discipline ioctl <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#ifndef TIOCSETD</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"># define TIOCSETD</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">0x5423</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#endif</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em> serial port of the modem <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">//#define SERIAL_PORT</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">"/dev/ttyUSB0"</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em> line speed <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define LINE_SPEED</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">B115200</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em> maximum transfert unit (MTU), value in bytes <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define MTU</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">512</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/**</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em> whether or not to create virtual TTYs for the multiplex</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">0 : do not create</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">1 : create</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define CREATE_NODES</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">1</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em> number of virtual TTYs to create (most modems can handle up to 4) <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define NUM_NODES</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">4</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em> name of the virtual TTYs to create <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define BASENAME_NODES</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">"/dev/ttyGSM"</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em> name of the driver, used to get the major number <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define DRIVER_NAME</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">"gsmtty"</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/**</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em> whether or not to print debug messages to stderr</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">0 : debug off</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">1 : debug on</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define DEBUG</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">1</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/**</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em> whether or not to detach the program from the terminal</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">0 : do not daemonize</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">1 : daemonize</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define DAEMONIZE</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">1</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&nbsp;/</em> size of the reception buffer which gets data from the serial line <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">#define SIZE_BUF</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">256</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/**</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Prints debug messages to stderr if debug is wanted</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">static void dbg(char <em>fmt, ...) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">va_list args;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (DEBUG) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">fflush(NULL);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">va_start(args, fmt);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">vfprintf(stderr, fmt, args);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">va_end(args);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">fprintf(stderr, "\n");</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">fflush(NULL);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em></em></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Sends an AT command to the specified line and gets its result</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Returns &nbsp;0 on success</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">-1 on failure</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">int send_at_command(int serial_fd, char <em>command, int max_retry) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char buf[SIZE_BUF];</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int r;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int retry = 0;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">do{</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> write the AT command to the serial line <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (write(serial_fd, command, strlen(command)) &lt;= 0)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, "Cannot write to ttyUSB");</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> wait a bit to allow the modem to rest <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">sleep(1);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> read the result of the command from the modem <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">memset(buf, 0, sizeof(buf));</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">r = read(serial_fd, buf, sizeof(buf));</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (r == -1)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">{</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("read errno %d", errno);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">retry++;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("retry write time: %d", retry);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> if there is no result from the modem, return failure <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (r == 0) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("%s\t: No response", command);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">retry++;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">//return -1;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if(retry!= 0 &amp;&amp; retry &gt;= max_retry)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">{</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, "Cannot read ttyUSB");</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">else</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">{</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">break;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}while(1);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> if we have a result and want debug info, strip CR &amp; LF out from the output <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (DEBUG) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int i;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char bufp[SIZE_BUF];</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">memcpy(bufp, buf, sizeof(buf));</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">for(i=0; i<strlen(bufp); i++)="" {<="" span=""><span style="font-size: 11pt;"><o:p></o:p></span></strlen(bufp);></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (bufp[i] == '\r' || bufp[i] == '\n')</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">bufp[i] = ' ';</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("%s\t: %s", command, bufp);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> if the output shows "OK" return success <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (strstr(buf, "OK\r") != NULL) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return 0;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return -1;</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/**</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Gets the major number of the driver device</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Returns &nbsp;the major number on success</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">-1 on failure</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">int get_major(char <em>driver) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">FILE *fp;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char *line = NULL;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">size_t len = 0;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">ssize_t read;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char device[20];</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int major = -1;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> open /proc/devices file <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if ((fp = fopen("/proc/devices", "r")) == NULL)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, "Cannot open /proc/devices");</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> read the file line by line <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">while ((major == -1) &amp;&amp; (read = getline(&amp;line, &amp;len, fp)) != -1) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> if the driver name string is found in the line, try to get the major <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (strstr(line, driver) != NULL) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (sscanf(line,"%d %s\n", &amp;major, device) != 2)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">major = -1;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> free the line before getting a new one <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (line) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">free(line);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">line = NULL;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> close /proc/devices file <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">fclose(fp);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return major;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em></em></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Creates nodes for the virtual TTYs</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Returns the number of nodes created</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">int make_nodes(int major, char <em>basename, int number_nodes) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int minor, created = 0;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dev_t device;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char node_name[15];</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">mode_t oldmask;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> set a new mask to get 666 mode and stores the old one <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">oldmask = umask(0);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">for (minor=1; minor<number_nodes+1; minor++)="" {<="" span=""><span style="font-size: 11pt;"><o:p></o:p></span></number_nodes+1;></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> append the minor number to the base name <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">sprintf(node_name, "%s%d", basename, minor);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> store a device info with major and minor <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">device = makedev(major, minor);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> create the actual character node <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (mknod(node_name, S_IFCHR | 0666, device) != 0) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">warn("Cannot create %s", node_name);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">} else {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">created++;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("Created %s", node_name);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> revert the mask to the old one <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">umask(oldmask);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return created;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em></em></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Removes previously created TTY nodes</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Returns nothing, it doesn't really matter if it fails</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">void remove_nodes(char <em>basename, int number_nodes) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int node;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char node_name[15];</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">for (node=1; node<number_nodes+1; node++)="" {<="" span=""><span style="font-size: 11pt;"><o:p></o:p></span></number_nodes+1;></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> append the minor number to the base name <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">sprintf(node_name, "%s%d", basename, node);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> unlink the actual character node <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("Removing %s", node_name);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (unlink(node_name) == -1)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">warn("Cannot remove %s", node_name);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">/</em></em></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Function raised by signal catching</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">void signal_callback_handler(int signum) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">remove_nodes(BASENAME_NODES, NUM_NODES);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">int main(int argc, char** argv) {</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int serial_fd, major;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">struct termios tio;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int ldisc = N_GSM0710;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">struct gsm_config gsm;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char atcommand[40];</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">char* port;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if(argc != 2)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">{</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">printf("usage\n ./cmux /dev/ttyUSBx\n");</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">exit(-1);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">port = argv[1];</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/* print global parameters <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("SERIAL_PORT = %s", port);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"><o:p>&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> open the serial port <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">serial_fd = open(port, O_RDWR | O_NOCTTY | O_NDELAY);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (serial_fd == -1)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">{</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg("openport ret = %d\n", errno);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, "Cannot open %s", port);</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> get the current attributes of the serial port <em>/</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (tcgetattr(serial_fd, &amp;tio) == -1)</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, "Cannot get line attributes");</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> set the new attrbiutes */</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">tio.c_iflag = 0;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">tio.c_oflag = 0;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">tio.c_cflag = CS8 | CREAD | CLOCAL;</span><span style="font-family: 宋体; font-size: 11pt;"><o:p></o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">tio.c_cflag &amp;= (</del>CRTSCTS);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">tio.c_lflag = 0;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">tio.c_cc[VMIN] = 1;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">tio.c_cc[VTIME] = 0;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/* write the speed of the serial line <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (cfsetospeed(&amp;tio, LINE_SPEED) &lt; 0 || cfsetispeed(&amp;tio, LINE_SPEED) &lt; 0)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, “Cannot set line speed”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> write the attributes <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (tcsetattr(serial_fd, TCSANOW, &amp;tio) == -1)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, “Cannot set line attributes”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/**</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">Send AT commands to put the modem in CMUX mode.</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">This is vendor specific and should be changed</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">to fit your modem needs.</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"><em></span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">The following matches Quectel M95.</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">//if (send_at_command(serial_fd, “AT+IFC=2,2\r”) == -1)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">//</span><span style="font-family: 宋体; font-size: 11pt;">    </span><span style="font-family: 宋体; font-size: 11pt;">errx(EXIT_FAILURE, “AT+IFC=2,2: bad response”);</span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (send_at_command(serial_fd, “AT+CGMM\r”, 3) == -1)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">warnx(“AT+GMM: bad response”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (send_at_command(serial_fd, “AT\r”, 0) == -1)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">warnx(“AT: bad response”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">sprintf(atcommand, “AT+CMUX=0,0,5\r”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (send_at_command(serial_fd, atcommand, 0) == -1)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">errx(EXIT_FAILURE, “Cannot enable modem CMUX”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/* use n_gsm line discipline <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">sleep(2);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (ioctl(serial_fd, TIOCSETD, &amp;ldisc) &lt; 0)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, “Cannot set line dicipline. Is ‘n_gsm’ module registred?”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> get n_gsm configuration <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (ioctl(serial_fd, GSMIOC_GETCONF, &amp;gsm) &lt; 0)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, “Cannot get GSM multiplex parameters”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> set and write new attributes <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.initiator = 1;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.encapsulation = 0;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.mru = MTU;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.mtu = MTU;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.t1 = 10;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.n2 = 3;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.t2 = 30;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">gsm.t3 = 10;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (ioctl(serial_fd, GSMIOC_SETCONF, &amp;gsm) &lt; 0)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, “Cannot set GSM multiplex parameters”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg(“Line dicipline set”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> create the virtual TTYs <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (CREATE_NODES) {</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">int created;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if ((major = get_major(DRIVER_NAME)) &lt; 0)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">errx(EXIT_FAILURE, “Cannot get major number”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if ((created = make_nodes(major, BASENAME_NODES, NUM_NODES)) &lt; NUM_NODES)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">warnx(“Cannot create all nodes, only %d/%d have been created.”, created, NUM_NODES);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> wait to keep the line discipline enabled, wake it up with a signal <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">signal(SIGINT, signal_callback_handler);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">signal(SIGTERM, signal_callback_handler);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> detach from the terminal if needed <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (DAEMONIZE) {</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg(“Going to background”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (daemon(0,0) != 0)</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">err(EXIT_FAILURE, “Cannot daemonize”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">dbg(“catching sig”);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">pause();</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> remove the created virtual TTYs <em>/</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">if (CREATE_NODES) {</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">remove_nodes(BASENAME_NODES, NUM_NODES);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">}</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">/</em> close the serial line */</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">close(serial_fd);</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;&nbsp;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;"></span><span style="font-family: 宋体; font-size: 11pt;">return EXIT_SUCCESS;</span><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; font-size: 11pt;">}</span></p></h3></pre><h3><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><b><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></b></h3><h3><b style="color: inherit; font-family: inherit;"><span style="font-family: 宋体; font-size: 11pt;">3.2.3</span></b><b style="color: inherit; font-family: inherit;"><span style="font-family: 宋体; font-size: 11pt;">&nbsp;</span></b><b style="color: inherit; font-family: inherit;"><span style="font-family: 宋体; font-size: 11pt;"><font face="宋体">生成</font>cmux可执行文件</span></b><br></h3><h3><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;"><font face="宋体">通执行</font></span><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;">gcc&nbsp;cmux.c&nbsp;-o&nbsp;cmux</span><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;">&nbsp;</span><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;"><font face="宋体">把</font>cmux.c编译成可执行文件</span></p><b><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></b></h3><h3><b><span style="font-family: 宋体; font-size: 11pt;">3.2.4 </span></b><b><span style="font-family: 宋体; font-size: 11pt;"><font face="宋体">虚拟串口</font></span></b><b><span style="font-family: 宋体; font-size: 11pt;"><font face="宋体">生成</font></span></b></h3><h3><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;"><font face="宋体">通执行</font></span><span style="mso-spacerun:'yes';font-family:宋体;font-size:11.0000pt;">&nbsp;</span><span style="mso-spacerun:'yes';font-family:宋体;font-size:12.0000pt;">./cmux&nbsp;/dev/ttyUSB</span><span style="mso-spacerun:'yes';font-family:宋体;font-size:12.0000pt;">0 </span><span style="mso-spacerun:'yes';font-family:宋体;font-size:12.0000pt;"><font face="宋体">就会创建几个虚拟串口</font></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:12.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:12.0000pt;"><font face="宋体">下图中的</font>ttyGSM1,ttyGSM2,ttyGSM3,ttyGSM4及为虚拟出的串口</span></p><p class="MsoNormal"><img src="https://oldask.openluat.com/image/show/attachments-2020-05-KglYTU7V5eb52caedb992.png" class="img-responsive" style="width: 100%;"></p><b><span style="font-family: 宋体; font-size: 11pt;">&lt;o:p&gt;</o:p></span></b></h3>&lt;h1 style=”font-family: “ helvetica=”” neue”,=”” helvetica,=”” arial,=”” “pingfang=”” sc”,=”” “hiragino=”” sans=”” gb”,=”” “wenquanyi=”” micro=”” hei”,=”” “microsoft=”” yahei”,=”” sans-serif;=”” color:=”” rgb(0,=”” 0,=”” 0);”=””&gt;<span style="font-weight: 700;"><span style="font-family: 宋体; font-size: 22pt;">4.</span></span>常见问题处理</h1>&lt;h3 style=”font-family: “ helvetica=”” neue”,=”” helvetica,=”” arial,=”” “pingfang=”” sc”,=”” “hiragino=”” sans=”” gb”,=”” “wenquanyi=”” micro=”” hei”,=”” “microsoft=”” yahei”,=”” sans-serif;=”” color:=”” rgb(0,=”” 0,=”” 0);”=””&gt;<span style="font-weight: 700;"><span style="font-family: 宋体; font-size: 11pt;">4.1&nbsp;</span></span><span style="font-weight: 700;"><span style="font-family: 宋体; font-size: 11pt;"><font face="宋体">常见AT 错误处理</font></span></span></h3>&lt;h3 style=”font-family: “ helvetica=”” neue”,=”” helvetica,=”” arial,=”” “pingfang=”” sc”,=”” “hiragino=”” sans=”” gb”,=”” “wenquanyi=”” micro=”” hei”,=”” “microsoft=”” yahei”,=”” sans-serif;=”” color:=”” rgb(0,=”” 0,=”” 0);”=””&gt;<table class="MsoNormalTable" border="1" cellspacing="0" style="width: 492.85pt; margin-left: 5.4pt; border: none;"><tbody><tr style="height:14.2500pt;"><td width="120" valign="top" style="width:72.3000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(233,127,210);
mso-border-left-alt:0.5000pt solid rgb(233,127,210);border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:1.0000pt solid rgb(233,127,210);mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal"><span style="font-family: 宋体; font-size: 9pt;">命令</span><span style="font-family: 宋体; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="179" valign="top" style="width:107.5500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:1.0000pt solid rgb(233,127,210);mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:9.0000pt;">错误情况</span><span style="font-family: 宋体; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="203" valign="top" style="width:122.2500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:1.0000pt solid rgb(233,127,210);mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:9.0000pt;">错误原因</span><span style="font-family: 宋体; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="317" valign="top" style="width:190.7500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:1.0000pt solid rgb(233,127,210);mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:9.0000pt;">处理</span><span style="font-family: 宋体; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr><tr style="height:14.2500pt;"><td width="120" valign="top" style="width:72.3000pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:1.0000pt solid rgb(233,127,210);
mso-border-left-alt:0.5000pt solid rgb(233,127,210);border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:Verdana;mso-fareast-font-family:宋体;
mso-bidi-font-family:宋体;font-size:9.0000pt;">AT+CMUX</span><span style="font-family:宋体;font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="179" valign="top" style="width:107.5500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal"><span style="font-family: 宋体; font-size: 9pt;">+CME ERROR: </span><span style="font-family: 宋体; font-size: 9pt;">980</span><span style="font-family: 宋体; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td><td width="203" valign="top" style="width:122.2500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal" align="justify" style="text-align:justify;text-justify:inter-ideograph;"><span style="mso-spacerun:'yes';font-family:宋体;font-size:9.0000pt;">参数输入错误</span><span style="font-family:宋体;font-size:9.0000pt;">&lt;o:p&gt;</o:p></span></p></td><td width="317" valign="top" style="width:190.7500pt;padding:0.0000pt 5.4000pt 0.0000pt 5.4000pt ;border-left:none;
mso-border-left-alt:none;border-right:1.0000pt solid rgb(233,127,210);mso-border-right-alt:0.5000pt solid rgb(233,127,210);
border-top:none;mso-border-top-alt:0.5000pt solid rgb(233,127,210);border-bottom:1.0000pt solid rgb(233,127,210);
mso-border-bottom-alt:0.5000pt solid rgb(233,127,210);"><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;font-size:9.0000pt;">检查一下输入参数是否正确</span><span style="font-family: 宋体; font-size: 9pt;">&lt;o:p&gt;</o:p></span></p></td></tr></tbody></table></h3><h2><b><span style="font-family: 宋体; font-size: 12pt;">4.2 </span></b><b><span style="font-family: 宋体; font-size: 12pt;">VMware无法识别USB设备的解决方法</span></b></h2><h2><p class="p" style="margin-bottom: 9.6pt; text-indent: 21pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="宋体">我的虚拟机上认不到</font>USB设备，发现是VMware USB Arbitration Service服务没有启动，手动启动VMware USB Arbitration Service服务，再重启VMware，虚拟机就能识别出USB设备了。</span><span style="mso-spacerun:'yes';font-family:宋体;color:rgb(77,77,77);
font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="p" style="margin-bottom: 9.6pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><font face="宋体">具体步骤：</font></span><span style="font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><br></span><span style="font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">1.点击开始-&gt;运行，在对话框中输入”services.msc”，确定，打开windows服务管理器。</span><span style="mso-spacerun:'yes';font-family:宋体;color:rgb(77,77,77);
font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="p" style="margin-bottom: 9.6pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;"><span style="font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">2.在服务列表中选中”VMware USB Arbitration Service”，双击打开属性对话框，再选择”启动”，就能启动VMware USB Arbitration Service服务了。</span><span style="mso-spacerun:'yes';font-family:宋体;color:rgb(77,77,77);
font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="font-family: 宋体; color: rgb(77, 77, 77); font-size: 11pt; background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial;">3.关闭VMware软件，并重新打开，启动一下虚拟机。</span></p></h2><h2><b><span style="font-family: 宋体; font-size: 12pt;">4.3 </span></b><b><span style="font-family: 宋体; font-size: 12pt;"><font face="宋体">虚拟串口生成失败</font></span></b></h2><h2><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体">如下图所示</font></span></p><p class="MsoNormal"><img src="https://oldask.openluat.com/image/show/attachments-2020-05-VaYfpRms5eb52e43e5580.png" class="img-responsive" style="width: 100%;"><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><p class="MsoNormal"><span style="mso-spacerun:'yes';font-family:宋体;mso-ascii-font-family:Calibri;
mso-hansi-font-family:Calibri;mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;"><font face="宋体">出现原因是没有选择正确的</font>USB<font face="宋体">口，我们</font><font face="Calibri">720SL</font><font face="宋体">开发板上的开关要拨到</font><font face="Calibri">UART2</font><font face="宋体">一端，出现上面的错误的原因是因为开关要拨到</font><font face="Calibri">UART1</font><font face="宋体">一端了，把开关拨到</font><font face="Calibri">UART2</font><font face="宋体">一端，重启一下模块，然后在做上述操作。</font></span><span style="mso-spacerun:'yes';font-family:Calibri;mso-fareast-font-family:宋体;
mso-bidi-font-family:'Times New Roman';font-size:11.0000pt;">&lt;o:p&gt;</o:p></span></p><b><span style="font-family: 宋体; font-size: 12pt;">&lt;o:p&gt;</o:p></span></b></h2><h2><b><span style="font-family: 宋体; font-size: 12pt;"><br></span></b><b><span style="font-family: 宋体; font-size: 12pt;">&lt;o:p&gt;</o:p></span></b></h2>
                        </p>

</article>

    <div class="pagenator post-pagenator">


        <a class="extend prev post-prev" href="/284/">上一篇</a>



    <p>上次更新 2021-01-28</p>


        <a class="extend next post-next" href="/277/">下一篇</a>

    </div>

    </div>
    <div class="footer">
        <div class="container">
    <div class="social">
	<ul class="social-list">





				<li>
					<a href="https://luatdoc.papapoi.com/wiki/" title="stack-overflow" target="_self">
					<i class="fa fa-stack-overflow"></i>
					</a>
				</li>












				<li>
					<a href="https://github.com/openluat" title="github" target="_self">
					<i class="fa fa-github"></i>
					</a>
				</li>
















	</ul>
</div>
    <div class="copyright">
        <span>



                © 仅供搜索引擎收录使用 2017 - 2021

        </span>
    </div>
    <div class="power">
        <span>
            Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/CaiChenghan/iLiKE">iLiKE Theme</a>
        </span>
    </div>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
    <!--page counter part-->
<script>
function addCount (Counter) {
    url=$('.article-date').attr('href').trim();
    title = $('.article-title').text().trim();
    var query = new AV.Query(Counter);
    //use url as unique idnetfication
    query.equalTo("url",url);
    query.find({
        success: function(results) {
            if (results.length>0) {
                var counter=results[0];
                counter.fetchWhenSave(true); //get recent result
                counter.increment("time");
                counter.save();
            } else {
                var newcounter=new Counter();
                newcounter.set("title",title);
                newcounter.set("url",url);
                newcounter.set("time",1);
                newcounter.save(null,{
                    success: function(newcounter) {
                        //alert('New object created');
                    }, error: function(newcounter,error) {
                        alert('Failed to create');
                    }
                })
            }
        },
        error: function(error) {
            //find null is not a error
            alert('Error:'+error.code+" "+error.message);
        }
    });
}
$(function() {
    var Counter=AV.Object.extend("Counter");
    //only increse visit counting when intering a page
    if ($('.article-title').length == 1) {
       addCount(Counter);
    }
    var query=new AV.Query(Counter);
    query.descending("time");
    // the sum of popular posts
    query.limit(10);
    query.find({
        success: function(results) {
                for(var i=0;i<results.length;i++) {
                    var counter=results[i];
                    title=counter.get("title");
                    url=counter.get("url");
                    time=counter.get("time");
                    // add to the popularlist widget
                    showcontent=title+" ("+time+")";
                    //notice the "" in href
                    $('.popularlist').append('<li><a href="'+url+'">'+showcontent+'</a></li>');
                }
            },
        error: function(error) {
            alert("Error:"+error.code+" "+error.message);
        }
    });
});
</script>
</div>
    </div>
</body>
</html>
