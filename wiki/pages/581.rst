专网卡配置教程
==============

作者：闫俊杰

专网卡设置APN、用户名、密码和鉴权方式:AT+CPNETAPN
-------------------------------------------------

语法规则：

+-----------------------+-----------------------+-----------------------+
| 命令类型              | 语法                  | 返回                  |
+=======================+=======================+=======================+
| 设置命令              | AT+CPN                | OK                    |
|                       | ETAPN=<mode>,<apn>,<u |                       |
|                       | ser>,<pwd>,<authmode> |                       |
+-----------------------+-----------------------+-----------------------+
| 查询命令              | AT+CPNETAPN?          | MODE:<mode>APN:<apn>U |
|                       |                       | SR:<user>PWD:<passwd> |
|                       |                       | AUTHMODE:<authmode>OK |
+-----------------------+-----------------------+-----------------------+
| 测试命令              | AT+CPNETAPN=?         | +                     |
|                       |                       | CPNETAPN:(0-3),<apn>, |
|                       |                       | <user>,<pwd>,authmode |
|                       |                       | OK                    |
+-----------------------+-----------------------+-----------------------+

参数定义：

+------------+-----------------+------+-----------------------+
| 参数       | 定义            | 取值 | 对取值的说明          |
+============+=================+======+=======================+
| <mode>     | 参数的保存模式  | 0    | 保存并重启生效        |
+------------+-----------------+------+-----------------------+
|            |                 | 1    | 不保存立即生效        |
|            |                 |      | 注：                  |
|            |                 |      | 如果专网卡和普通卡都  |
|            |                 |      | 会使用，mode请设置为1 |
+------------+-----------------+------+-----------------------+
|            |                 | 2    | 保存并立即生效        |
|            |                 |      | 注：如果一直使用      |
|            |                 |      | 专网卡，mode请设置为2 |
+------------+-----------------+------+-----------------------+
|            |                 | 3    | 删除保存的参数        |
+------------+-----------------+------+-----------------------+
| <apn>      | GPRS 接入点名称 |      | 字符串                |
|            |                 |      | 参数(双引号可加可不加 |
|            |                 |      | )，不超过128个字符。  |
|            |                 |      | 注：此参数不可以为空  |
+------------+-----------------+------+-----------------------+
| <user>     | GPRS 用户名     |      | 字符                  |
|            |                 |      | 串参数(双引号可加可不 |
|            |                 |      | 加)，不超过32个字符。 |
|            |                 |      | 如果为空，则表示为""  |
+------------+-----------------+------+-----------------------+
| <pwd>      | GPRS 密码       |      | 字符                  |
|            |                 |      | 串参数(双引号可加可不 |
|            |                 |      | 加)，不超过32个字符。 |
|            |                 |      | 如果为空，则表示为""  |
+------------+-----------------+------+-----------------------+
| <authmode> |  鉴权方式       | 0    | 无鉴权                |
+------------+-----------------+------+-----------------------+
|            |                 | 1    | PAP                   |
+------------+-----------------+------+-----------------------+
|            |                 | 2    | CHAP                  |
+------------+-----------------+------+-----------------------+

举例：

+-----------------+------------------------+------------------------+
| 命令(→)/返回(←) | 实例                   | 解释和说明             |
+=================+========================+========================+
| →               | AT+CPNETAPN=2,js       | 设置专网               |
|                 | cmiot,u9682,iot98765,2 | 卡的APN。各个参数请根  |
|                 |                        | 据专网卡实际信息填写。 |
+-----------------+------------------------+------------------------+
| ←               | OK                     | 设置成功。设置         |
|                 |                        | 成功后参数会保存到NV， |
|                 |                        | 模块会自动重新激活承载 |
+-----------------+------------------------+------------------------+

注意事项：
重新激活承载后缺省的PDP承载(<cid>=5)已经为所设置的APN，并已经处于激活可用状态。这个缺省的PDP承载，用于模块RNDIS网卡功能以及TCPIP/HTTP/MQTT/FTP等数据业务。
AT+CGDCONT? +CGDCONT: 5,“IP”,"
jscmiot.MNC011.MCC460.GPRS“,”10.134.28.241“,0,0,,,, OK
后面数据应用中CSTT或SAPBR设置APN的时候，只需要APN为空或设置<专网apn>即可，不需要再设置<user>和<pwd>例如：
AT+CSTT=jscmiot AT+CSTT AT+SAPBR=3,1,”APN“,”jscmiot"
AT+SAPBR=3,1,“APN”,""

专网卡在Linux下使用RNDIS
------------------------

1. 通过上面的配置，模块已经使用专网卡信息激活了第五路承载，
   可以通过AT+CGDCONT?查询承载状态，第五路承载已激活。 |承载状态|
2. 模块在Linux下面使用RNDIS网卡功能默认使用第五路承载。 |RNDIS|
3. 所以只要第五路承载可以访问专网卡服务器，RNDIS功能就同样可以使Linux系统访问专网卡服务器。
   |RNDISPING|

专网卡在Linux下使用PPP
----------------------

1. PPP拨号教程详见7.Linux/Android 应用教程中PPP章节内容
2. 专网卡在Linux下使用PPP可以选择第五路或其他路承载
3. 选择第一路承载拨号为*99#
4. 选择第五路承载拨号为*99***5#
5. 注意：一般专网卡最多只能激活一路承载，模块默认激活第五路承载，如果要使用第一路承载PPP拨号前，请先将第五路承载去激活（AT+CGACT=0,5）
6. 拨号成功之后ifconfig可以查看到名为ppp0的网卡 |PPPPING|

.. |承载状态| image:: http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200820163008615_CGDCONT.png
.. |RNDIS| image:: http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200820163048991_rndis.png
.. |RNDISPING| image:: http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200820164447373_rndisping.png
.. |PPPPING| image:: http://openluat-luatcommunity.oss-cn-hangzhou.aliyuncs.com/images/20200820175345462_PPPPING.png
